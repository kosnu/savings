import{r as Lh,j as _y}from"./iframe-dHABiMeZ.js";const Nk=Object.freeze({status:"aborted"});function I(t,e,n){function r(c,l){if(c._zod||Object.defineProperty(c,"_zod",{value:{def:l,constr:o,traits:new Set},enumerable:!1}),c._zod.traits.has(t))return;c._zod.traits.add(t),e(c,l);const h=o.prototype,f=Object.keys(h);for(let m=0;m<f.length;m++){const _=f[m];_ in c||(c[_]=h[_].bind(c))}}const s=n?.Parent??Object;class i extends s{}Object.defineProperty(i,"name",{value:t});function o(c){var l;const h=n?.Parent?new i:this;r(h,c),(l=h._zod).deferred??(l.deferred=[]);for(const f of h._zod.deferred)f();return h}return Object.defineProperty(o,"init",{value:r}),Object.defineProperty(o,Symbol.hasInstance,{value:c=>n?.Parent&&c instanceof n.Parent?!0:c?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}const Ok=Symbol("zod_brand");class Sn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class da extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const Mo={};function Qe(t){return t&&Object.assign(Mo,t),Mo}function yy(t){return t}function vy(t){return t}function Ey(t){}function wy(t){throw new Error("Unexpected value in exhaustive check")}function Ty(t){}function fa(t){const e=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,s])=>e.indexOf(+r)===-1).map(([r,s])=>s)}function Iy(t,e="|"){return t.map(n=>Bh(n)).join(e)}function Us(t,e){return typeof e=="bigint"?e.toString():e}function Zr(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function pn(t){return t==null}function _i(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function Fh(t,e){const n=(t.toString().split(".")[1]||"").length,r=e.toString();let s=(r.split(".")[1]||"").length;if(s===0&&/\d?e-\d?/.test(r)){const l=r.match(/\d?e-(\d?)/);l?.[1]&&(s=Number.parseInt(l[1]))}const i=n>s?n:s,o=Number.parseInt(t.toFixed(i).replace(".","")),c=Number.parseInt(e.toFixed(i).replace(".",""));return o%c/10**i}const Wu=Symbol("evaluating");function q(t,e,n){let r;Object.defineProperty(t,e,{get(){if(r!==Wu)return r===void 0&&(r=Wu,r=n()),r},set(s){Object.defineProperty(t,e,{value:s})},configurable:!0})}function Ay(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function Ht(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function ut(...t){const e={};for(const n of t){const r=Object.getOwnPropertyDescriptors(n);Object.assign(e,r)}return Object.defineProperties({},e)}function by(t){return ut(t._zod.def)}function Sy(t,e){return e?e.reduce((n,r)=>n?.[r],t):t}function Ry(t){const e=Object.keys(t),n=e.map(r=>t[r]);return Promise.all(n).then(r=>{const s={};for(let i=0;i<e.length;i++)s[e[i]]=r[i];return s})}function Py(t=10){const e="abcdefghijklmnopqrstuvwxyz";let n="";for(let r=0;r<t;r++)n+=e[Math.floor(Math.random()*e.length)];return n}function xo(t){return JSON.stringify(t)}function $h(t){return t.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const pa="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Vn(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const Uh=Zr(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function an(t){if(Vn(t)===!1)return!1;const e=t.constructor;if(e===void 0||typeof e!="function")return!0;const n=e.prototype;return!(Vn(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function yi(t){return an(t)?{...t}:Array.isArray(t)?[...t]:t}function ky(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}const Cy=t=>{const e=typeof t;switch(e){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(t)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(t)?"array":t===null?"null":t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?"promise":typeof Map<"u"&&t instanceof Map?"map":typeof Set<"u"&&t instanceof Set?"set":typeof Date<"u"&&t instanceof Date?"date":typeof File<"u"&&t instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${e}`)}},js=new Set(["string","number","symbol"]),jh=new Set(["string","number","bigint","boolean","symbol","undefined"]);function gt(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function lt(t,e,n){const r=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(r._zod.parent=t),r}function C(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function Ny(t){let e;return new Proxy({},{get(n,r,s){return e??(e=t()),Reflect.get(e,r,s)},set(n,r,s,i){return e??(e=t()),Reflect.set(e,r,s,i)},has(n,r){return e??(e=t()),Reflect.has(e,r)},deleteProperty(n,r){return e??(e=t()),Reflect.deleteProperty(e,r)},ownKeys(n){return e??(e=t()),Reflect.ownKeys(e)},getOwnPropertyDescriptor(n,r){return e??(e=t()),Reflect.getOwnPropertyDescriptor(e,r)},defineProperty(n,r,s){return e??(e=t()),Reflect.defineProperty(e,r,s)}})}function Bh(t){return typeof t=="bigint"?t.toString()+"n":typeof t=="string"?`"${t}"`:`${t}`}function Zh(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const qh={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},Gh={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function Wh(t,e){const n=t._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const i=ut(t._zod.def,{get shape(){const o={};for(const c in e){if(!(c in n.shape))throw new Error(`Unrecognized key: "${c}"`);e[c]&&(o[c]=n.shape[c])}return Ht(this,"shape",o),o},checks:[]});return lt(t,i)}function Hh(t,e){const n=t._zod.def,r=n.checks;if(r&&r.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const i=ut(t._zod.def,{get shape(){const o={...t._zod.def.shape};for(const c in e){if(!(c in n.shape))throw new Error(`Unrecognized key: "${c}"`);e[c]&&delete o[c]}return Ht(this,"shape",o),o},checks:[]});return lt(t,i)}function Kh(t,e){if(!an(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0){const i=t._zod.def.shape;for(const o in e)if(Object.getOwnPropertyDescriptor(i,o)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const s=ut(t._zod.def,{get shape(){const i={...t._zod.def.shape,...e};return Ht(this,"shape",i),i}});return lt(t,s)}function Jh(t,e){if(!an(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n=ut(t._zod.def,{get shape(){const r={...t._zod.def.shape,...e};return Ht(this,"shape",r),r}});return lt(t,n)}function Qh(t,e){const n=ut(t._zod.def,{get shape(){const r={...t._zod.def.shape,...e._zod.def.shape};return Ht(this,"shape",r),r},get catchall(){return e._zod.def.catchall},checks:[]});return lt(t,n)}function Yh(t,e,n){const s=e._zod.def.checks;if(s&&s.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const o=ut(e._zod.def,{get shape(){const c=e._zod.def.shape,l={...c};if(n)for(const h in n){if(!(h in c))throw new Error(`Unrecognized key: "${h}"`);n[h]&&(l[h]=t?new t({type:"optional",innerType:c[h]}):c[h])}else for(const h in c)l[h]=t?new t({type:"optional",innerType:c[h]}):c[h];return Ht(this,"shape",l),l},checks:[]});return lt(e,o)}function Xh(t,e,n){const r=ut(e._zod.def,{get shape(){const s=e._zod.def.shape,i={...s};if(n)for(const o in n){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(i[o]=new t({type:"nonoptional",innerType:s[o]}))}else for(const o in s)i[o]=new t({type:"nonoptional",innerType:s[o]});return Ht(this,"shape",i),i}});return lt(e,r)}function nn(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function qe(t,e){return e.map(n=>{var r;return(r=n).path??(r.path=[]),n.path.unshift(t),n})}function Er(t){return typeof t=="string"?t:t?.message}function $e(t,e,n){const r={...t,path:t.path??[]};if(!t.message){const s=Er(t.inst?._zod.def?.error?.(t))??Er(e?.error?.(t))??Er(n.customError?.(t))??Er(n.localeError?.(t))??"Invalid input";r.message=s}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function vi(t){return t instanceof Set?"set":t instanceof Map?"map":t instanceof File?"file":"unknown"}function Ei(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Oy(t){const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"nan":"number";case"object":{if(t===null)return"null";if(Array.isArray(t))return"array";const n=t;if(n&&Object.getPrototypeOf(n)!==Object.prototype&&"constructor"in n&&n.constructor)return n.constructor.name}}return e}function Mn(...t){const[e,n,r]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:r}:{...e}}function Dy(t){return Object.entries(t).filter(([e,n])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function ed(t){const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}function td(t){let e="";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function Vy(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-e.length%4)%4);return ed(e+n)}function My(t){return td(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function xy(t){const e=t.replace(/^0x/,"");if(e.length%2!==0)throw new Error("Invalid hex string length");const n=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2)n[r/2]=Number.parseInt(e.slice(r,r+2),16);return n}function zy(t){return Array.from(t).map(e=>e.toString(16).padStart(2,"0")).join("")}class Ly{constructor(...e){}}const Dk=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:Gh,Class:Ly,NUMBER_FORMAT_RANGES:qh,aborted:nn,allowsEval:Uh,assert:Ty,assertEqual:yy,assertIs:Ey,assertNever:wy,assertNotEqual:vy,assignProp:Ht,base64ToUint8Array:ed,base64urlToUint8Array:Vy,cached:Zr,captureStackTrace:pa,cleanEnum:Dy,cleanRegex:_i,clone:lt,cloneDef:by,createTransparentProxy:Ny,defineLazy:q,esc:xo,escapeRegex:gt,extend:Kh,finalizeIssue:$e,floatSafeRemainder:Fh,getElementAtPath:Sy,getEnumValues:fa,getLengthableOrigin:Ei,getParsedType:Cy,getSizableOrigin:vi,hexToUint8Array:xy,isObject:Vn,isPlainObject:an,issue:Mn,joinValues:Iy,jsonStringifyReplacer:Us,merge:Qh,mergeDefs:ut,normalizeParams:C,nullish:pn,numKeys:ky,objectClone:Ay,omit:Hh,optionalKeys:Zh,parsedType:Oy,partial:Yh,pick:Wh,prefixIssues:qe,primitiveTypes:jh,promiseAllObject:Ry,propertyKeyTypes:js,randomString:Py,required:Xh,safeExtend:Jh,shallowClone:yi,slugify:$h,stringifyPrimitive:Bh,uint8ArrayToBase64:td,uint8ArrayToBase64url:My,uint8ArrayToHex:zy,unwrapMessage:Er},Symbol.toStringTag,{value:"Module"})),nd=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,Us,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},rd=I("$ZodError",nd),Ue=I("$ZodError",nd,{Parent:Error});function Fy(t,e=n=>n.message){const n={},r=[];for(const s of t.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}function $y(t,e=n=>n.message){const n={_errors:[]},r=s=>{for(const i of s.issues)if(i.code==="invalid_union"&&i.errors.length)i.errors.map(o=>r({issues:o}));else if(i.code==="invalid_key")r({issues:i.issues});else if(i.code==="invalid_element")r({issues:i.issues});else if(i.path.length===0)n._errors.push(e(i));else{let o=n,c=0;for(;c<i.path.length;){const l=i.path[c];c===i.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(e(i))):o[l]=o[l]||{_errors:[]},o=o[l],c++}}};return r(t),n}function Vk(t,e=n=>n.message){const n={errors:[]},r=(s,i=[])=>{var o,c;for(const l of s.issues)if(l.code==="invalid_union"&&l.errors.length)l.errors.map(h=>r({issues:h},l.path));else if(l.code==="invalid_key")r({issues:l.issues},l.path);else if(l.code==="invalid_element")r({issues:l.issues},l.path);else{const h=[...i,...l.path];if(h.length===0){n.errors.push(e(l));continue}let f=n,m=0;for(;m<h.length;){const _=h[m],b=m===h.length-1;typeof _=="string"?(f.properties??(f.properties={}),(o=f.properties)[_]??(o[_]={errors:[]}),f=f.properties[_]):(f.items??(f.items=[]),(c=f.items)[_]??(c[_]={errors:[]}),f=f.items[_]),b&&f.errors.push(e(l)),m++}}};return r(t),n}function Uy(t){const e=[],n=t.map(r=>typeof r=="object"?r.key:r);for(const r of n)typeof r=="number"?e.push(`[${r}]`):typeof r=="symbol"?e.push(`[${JSON.stringify(String(r))}]`):/[^\w$]/.test(r)?e.push(`[${JSON.stringify(r)}]`):(e.length&&e.push("."),e.push(r));return e.join("")}function Mk(t){const e=[],n=[...t.issues].sort((r,s)=>(r.path??[]).length-(s.path??[]).length);for(const r of n)e.push(`✖ ${r.message}`),r.path?.length&&e.push(`  → at ${Uy(r.path)}`);return e.join(`
`)}const wi=t=>(e,n,r,s)=>{const i=r?Object.assign(r,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},i);if(o instanceof Promise)throw new Sn;if(o.issues.length){const c=new(s?.Err??t)(o.issues.map(l=>$e(l,i,Qe())));throw pa(c,s?.callee),c}return o.value},Hu=wi(Ue),Ti=t=>async(e,n,r,s)=>{const i=r?Object.assign(r,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},i);if(o instanceof Promise&&(o=await o),o.issues.length){const c=new(s?.Err??t)(o.issues.map(l=>$e(l,i,Qe())));throw pa(c,s?.callee),c}return o.value},Ku=Ti(Ue),Ii=t=>(e,n,r)=>{const s=r?{...r,async:!1}:{async:!1},i=e._zod.run({value:n,issues:[]},s);if(i instanceof Promise)throw new Sn;return i.issues.length?{success:!1,error:new(t??rd)(i.issues.map(o=>$e(o,s,Qe())))}:{success:!0,data:i.value}},jy=Ii(Ue),Ai=t=>async(e,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let i=e._zod.run({value:n,issues:[]},s);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new t(i.issues.map(o=>$e(o,s,Qe())))}:{success:!0,data:i.value}},By=Ai(Ue),sd=t=>(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return wi(t)(e,n,s)},xk=sd(Ue),id=t=>(e,n,r)=>wi(t)(e,n,r),zk=id(Ue),od=t=>async(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ti(t)(e,n,s)},Lk=od(Ue),ad=t=>async(e,n,r)=>Ti(t)(e,n,r),Fk=ad(Ue),cd=t=>(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ii(t)(e,n,s)},$k=cd(Ue),ud=t=>(e,n,r)=>Ii(t)(e,n,r),Uk=ud(Ue),ld=t=>async(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ai(t)(e,n,s)},jk=ld(Ue),hd=t=>async(e,n,r)=>Ai(t)(e,n,r),Bk=hd(Ue),dd=/^[cC][^\s-]{8,}$/,fd=/^[0-9a-z]+$/,pd=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,md=/^[0-9a-vA-V]{20}$/,gd=/^[A-Za-z0-9]{27}$/,_d=/^[a-zA-Z0-9_-]{21}$/,yd=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Zy=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,vd=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,xn=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,qy=xn(4),Gy=xn(6),Wy=xn(7),Ed=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Hy=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ky=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,wd=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,Jy=wd,Qy=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Yy="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Td(){return new RegExp(Yy,"u")}const Id=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Ad=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,bd=t=>{const e=gt(t??":");return new RegExp(`^(?:[0-9A-F]{2}${e}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${e}){5}[0-9a-f]{2}$`)},Sd=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,Rd=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Pd=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,ma=/^[A-Za-z0-9_-]*$/,kd=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Cd=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,Nd=/^\+[1-9]\d{6,14}$/,Od="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Dd=new RegExp(`^${Od}$`);function Vd(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Md(t){return new RegExp(`^${Vd(t)}$`)}function xd(t){const e=Vd({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${Od}T(?:${r})$`)}const zd=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},Ld=/^-?\d+n?$/,Fd=/^-?\d+$/,ga=/^-?\d+(?:\.\d+)?$/,$d=/^(?:true|false)$/i,Ud=/^null$/i,jd=/^undefined$/i,Bd=/^[^A-Z]*$/,Zd=/^[^a-z]*$/,qd=/^[0-9a-fA-F]*$/;function qr(t,e){return new RegExp(`^[A-Za-z0-9+/]{${t}}${e}$`)}function Gr(t){return new RegExp(`^[A-Za-z0-9_-]{${t}}$`)}const Xy=/^[0-9a-fA-F]{32}$/,ev=qr(22,"=="),tv=Gr(22),nv=/^[0-9a-fA-F]{40}$/,rv=qr(27,"="),sv=Gr(27),iv=/^[0-9a-fA-F]{64}$/,ov=qr(43,"="),av=Gr(43),cv=/^[0-9a-fA-F]{96}$/,uv=qr(64,""),lv=Gr(64),hv=/^[0-9a-fA-F]{128}$/,dv=qr(86,"=="),fv=Gr(86),pv=Object.freeze(Object.defineProperty({__proto__:null,base64:Pd,base64url:ma,bigint:Ld,boolean:$d,browserEmail:Qy,cidrv4:Sd,cidrv6:Rd,cuid:dd,cuid2:fd,date:Dd,datetime:xd,domain:Cd,duration:yd,e164:Nd,email:Ed,emoji:Td,extendedDuration:Zy,guid:vd,hex:qd,hostname:kd,html5Email:Hy,idnEmail:Jy,integer:Fd,ipv4:Id,ipv6:Ad,ksuid:gd,lowercase:Bd,mac:bd,md5_base64:ev,md5_base64url:tv,md5_hex:Xy,nanoid:_d,null:Ud,number:ga,rfc5322Email:Ky,sha1_base64:rv,sha1_base64url:sv,sha1_hex:nv,sha256_base64:ov,sha256_base64url:av,sha256_hex:iv,sha384_base64:uv,sha384_base64url:lv,sha384_hex:cv,sha512_base64:dv,sha512_base64url:fv,sha512_hex:hv,string:zd,time:Md,ulid:pd,undefined:jd,unicodeEmail:wd,uppercase:Zd,uuid:xn,uuid4:qy,uuid6:Gy,uuid7:Wy,xid:md},Symbol.toStringTag,{value:"Module"})),le=I("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),Gd={number:"number",bigint:"bigint",object:"date"},Wd=I("$ZodCheckLessThan",(t,e)=>{le.init(t,e);const n=Gd[typeof e.value];t._zod.onattach.push(r=>{const s=r._zod.bag,i=(e.inclusive?s.maximum:s.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<i&&(e.inclusive?s.maximum=e.value:s.exclusiveMaximum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value<=e.value:r.value<e.value)||r.issues.push({origin:n,code:"too_big",maximum:typeof e.value=="object"?e.value.getTime():e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Hd=I("$ZodCheckGreaterThan",(t,e)=>{le.init(t,e);const n=Gd[typeof e.value];t._zod.onattach.push(r=>{const s=r._zod.bag,i=(e.inclusive?s.minimum:s.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>i&&(e.inclusive?s.minimum=e.value:s.exclusiveMinimum=e.value)}),t._zod.check=r=>{(e.inclusive?r.value>=e.value:r.value>e.value)||r.issues.push({origin:n,code:"too_small",minimum:typeof e.value=="object"?e.value.getTime():e.value,input:r.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),mv=I("$ZodCheckMultipleOf",(t,e)=>{le.init(t,e),t._zod.onattach.push(n=>{var r;(r=n._zod.bag).multipleOf??(r.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):Fh(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),gv=I("$ZodCheckNumberFormat",(t,e)=>{le.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),r=n?"int":"number",[s,i]=qh[e.format];t._zod.onattach.push(o=>{const c=o._zod.bag;c.format=e.format,c.minimum=s,c.maximum=i,n&&(c.pattern=Fd)}),t._zod.check=o=>{const c=o.value;if(n){if(!Number.isInteger(c)){o.issues.push({expected:r,format:e.format,code:"invalid_type",continue:!1,input:c,inst:t});return}if(!Number.isSafeInteger(c)){c>0?o.issues.push({input:c,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,inclusive:!0,continue:!e.abort}):o.issues.push({input:c,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,inclusive:!0,continue:!e.abort});return}}c<s&&o.issues.push({origin:"number",input:c,code:"too_small",minimum:s,inclusive:!0,inst:t,continue:!e.abort}),c>i&&o.issues.push({origin:"number",input:c,code:"too_big",maximum:i,inclusive:!0,inst:t,continue:!e.abort})}}),_v=I("$ZodCheckBigIntFormat",(t,e)=>{le.init(t,e);const[n,r]=Gh[e.format];t._zod.onattach.push(s=>{const i=s._zod.bag;i.format=e.format,i.minimum=n,i.maximum=r}),t._zod.check=s=>{const i=s.value;i<n&&s.issues.push({origin:"bigint",input:i,code:"too_small",minimum:n,inclusive:!0,inst:t,continue:!e.abort}),i>r&&s.issues.push({origin:"bigint",input:i,code:"too_big",maximum:r,inclusive:!0,inst:t,continue:!e.abort})}}),yv=I("$ZodCheckMaxSize",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.size!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<s&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const s=r.value;s.size<=e.maximum||r.issues.push({origin:vi(s),code:"too_big",maximum:e.maximum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),vv=I("$ZodCheckMinSize",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.size!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>s&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const s=r.value;s.size>=e.minimum||r.issues.push({origin:vi(s),code:"too_small",minimum:e.minimum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Ev=I("$ZodCheckSizeEquals",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.size!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=e.size,s.maximum=e.size,s.size=e.size}),t._zod.check=r=>{const s=r.value,i=s.size;if(i===e.size)return;const o=i>e.size;r.issues.push({origin:vi(s),...o?{code:"too_big",maximum:e.size}:{code:"too_small",minimum:e.size},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),wv=I("$ZodCheckMaxLength",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.length!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<s&&(r._zod.bag.maximum=e.maximum)}),t._zod.check=r=>{const s=r.value;if(s.length<=e.maximum)return;const o=Ei(s);r.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Tv=I("$ZodCheckMinLength",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.length!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>s&&(r._zod.bag.minimum=e.minimum)}),t._zod.check=r=>{const s=r.value;if(s.length>=e.minimum)return;const o=Ei(s);r.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:s,inst:t,continue:!e.abort})}}),Iv=I("$ZodCheckLengthEquals",(t,e)=>{var n;le.init(t,e),(n=t._zod.def).when??(n.when=r=>{const s=r.value;return!pn(s)&&s.length!==void 0}),t._zod.onattach.push(r=>{const s=r._zod.bag;s.minimum=e.length,s.maximum=e.length,s.length=e.length}),t._zod.check=r=>{const s=r.value,i=s.length;if(i===e.length)return;const o=Ei(s),c=i>e.length;r.issues.push({origin:o,...c?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!e.abort})}}),bi=I("$ZodCheckStringFormat",(t,e)=>{var n,r;le.init(t,e),t._zod.onattach.push(s=>{const i=s._zod.bag;i.format=e.format,e.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=s=>{e.pattern.lastIndex=0,!e.pattern.test(s.value)&&s.issues.push({origin:"string",code:"invalid_format",format:e.format,input:s.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),Av=I("$ZodCheckRegex",(t,e)=>{bi.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),bv=I("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Bd),bi.init(t,e)}),Sv=I("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Zd),bi.init(t,e)}),Rv=I("$ZodCheckIncludes",(t,e)=>{le.init(t,e);const n=gt(e.includes),r=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(s=>{const i=s._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(r)}),t._zod.check=s=>{s.value.includes(e.includes,e.position)||s.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:s.value,inst:t,continue:!e.abort})}}),Pv=I("$ZodCheckStartsWith",(t,e)=>{le.init(t,e);const n=new RegExp(`^${gt(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=r=>{r.value.startsWith(e.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:r.value,inst:t,continue:!e.abort})}}),kv=I("$ZodCheckEndsWith",(t,e)=>{le.init(t,e);const n=new RegExp(`.*${gt(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(r=>{const s=r._zod.bag;s.patterns??(s.patterns=new Set),s.patterns.add(n)}),t._zod.check=r=>{r.value.endsWith(e.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:r.value,inst:t,continue:!e.abort})}});function Ju(t,e,n){t.issues.length&&e.issues.push(...qe(n,t.issues))}const Cv=I("$ZodCheckProperty",(t,e)=>{le.init(t,e),t._zod.check=n=>{const r=e.schema._zod.run({value:n.value[e.property],issues:[]},{});if(r instanceof Promise)return r.then(s=>Ju(s,n,e.property));Ju(r,n,e.property)}}),Nv=I("$ZodCheckMimeType",(t,e)=>{le.init(t,e);const n=new Set(e.mime);t._zod.onattach.push(r=>{r._zod.bag.mime=e.mime}),t._zod.check=r=>{n.has(r.value.type)||r.issues.push({code:"invalid_value",values:e.mime,input:r.value.type,inst:t,continue:!e.abort})}}),Ov=I("$ZodCheckOverwrite",(t,e)=>{le.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class Dv{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const r=e.split(`
`).filter(o=>o),s=Math.min(...r.map(o=>o.length-o.trimStart().length)),i=r.map(o=>o.slice(s)).map(o=>" ".repeat(this.indent*2)+o);for(const o of i)this.content.push(o)}compile(){const e=Function,n=this?.args,s=[...(this?.content??[""]).map(i=>`  ${i}`)];return new e(...n,s.join(`
`))}}const Vv={major:4,minor:3,patch:6},j=I("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=Vv;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const s of r)for(const i of s._zod.onattach)i(t);if(r.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const s=(o,c,l)=>{let h=nn(o),f;for(const m of c){if(m._zod.def.when){if(!m._zod.def.when(o))continue}else if(h)continue;const _=o.issues.length,b=m._zod.check(o);if(b instanceof Promise&&l?.async===!1)throw new Sn;if(f||b instanceof Promise)f=(f??Promise.resolve()).then(async()=>{await b,o.issues.length!==_&&(h||(h=nn(o,_)))});else{if(o.issues.length===_)continue;h||(h=nn(o,_))}}return f?f.then(()=>o):o},i=(o,c,l)=>{if(nn(o))return o.aborted=!0,o;const h=s(c,r,l);if(h instanceof Promise){if(l.async===!1)throw new Sn;return h.then(f=>t._zod.parse(f,l))}return t._zod.parse(h,l)};t._zod.run=(o,c)=>{if(c.skipChecks)return t._zod.parse(o,c);if(c.direction==="backward"){const h=t._zod.parse({value:o.value,issues:[]},{...c,skipChecks:!0});return h instanceof Promise?h.then(f=>i(f,o,c)):i(h,o,c)}const l=t._zod.parse(o,c);if(l instanceof Promise){if(c.async===!1)throw new Sn;return l.then(h=>s(h,r,c))}return s(l,r,c)}}q(t,"~standard",()=>({validate:s=>{try{const i=jy(t,s);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return By(t,s).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}))}),Si=I("$ZodString",(t,e)=>{j.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??zd(t._zod.bag),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),ie=I("$ZodStringFormat",(t,e)=>{bi.init(t,e),Si.init(t,e)}),Mv=I("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=vd),ie.init(t,e)}),xv=I("$ZodUUID",(t,e)=>{if(e.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(r===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=xn(r))}else e.pattern??(e.pattern=xn());ie.init(t,e)}),zv=I("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Ed),ie.init(t,e)}),Lv=I("$ZodURL",(t,e)=>{ie.init(t,e),t._zod.check=n=>{try{const r=n.value.trim(),s=new URL(r);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:e.hostname.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=s.href:n.value=r;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),Fv=I("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Td()),ie.init(t,e)}),$v=I("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=_d),ie.init(t,e)}),Uv=I("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=dd),ie.init(t,e)}),jv=I("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=fd),ie.init(t,e)}),Bv=I("$ZodULID",(t,e)=>{e.pattern??(e.pattern=pd),ie.init(t,e)}),Zv=I("$ZodXID",(t,e)=>{e.pattern??(e.pattern=md),ie.init(t,e)}),qv=I("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=gd),ie.init(t,e)}),Gv=I("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=xd(e)),ie.init(t,e)}),Wv=I("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Dd),ie.init(t,e)}),Hv=I("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Md(e)),ie.init(t,e)}),Kv=I("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=yd),ie.init(t,e)}),Jv=I("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Id),ie.init(t,e),t._zod.bag.format="ipv4"}),Qv=I("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Ad),ie.init(t,e),t._zod.bag.format="ipv6",t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),Yv=I("$ZodMAC",(t,e)=>{e.pattern??(e.pattern=bd(e.delimiter)),ie.init(t,e),t._zod.bag.format="mac"}),Xv=I("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Sd),ie.init(t,e)}),eE=I("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=Rd),ie.init(t,e),t._zod.check=n=>{const r=n.value.split("/");try{if(r.length!==2)throw new Error;const[s,i]=r;if(!i)throw new Error;const o=Number(i);if(`${o}`!==i)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${s}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function Kd(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const tE=I("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Pd),ie.init(t,e),t._zod.bag.contentEncoding="base64",t._zod.check=n=>{Kd(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function nE(t){if(!ma.test(t))return!1;const e=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return Kd(n)}const rE=I("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=ma),ie.init(t,e),t._zod.bag.contentEncoding="base64url",t._zod.check=n=>{nE(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),sE=I("$ZodE164",(t,e)=>{e.pattern??(e.pattern=Nd),ie.init(t,e)});function iE(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[r]=n;if(!r)return!1;const s=JSON.parse(atob(r));return!("typ"in s&&s?.typ!=="JWT"||!s.alg||e&&(!("alg"in s)||s.alg!==e))}catch{return!1}}const oE=I("$ZodJWT",(t,e)=>{ie.init(t,e),t._zod.check=n=>{iE(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),aE=I("$ZodCustomStringFormat",(t,e)=>{ie.init(t,e),t._zod.check=n=>{e.fn(n.value)||n.issues.push({code:"invalid_format",format:e.format,input:n.value,inst:t,continue:!e.abort})}}),Jd=I("$ZodNumber",(t,e)=>{j.init(t,e),t._zod.pattern=t._zod.bag.pattern??ga,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const s=n.value;if(typeof s=="number"&&!Number.isNaN(s)&&Number.isFinite(s))return n;const i=typeof s=="number"?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:s,inst:t,...i?{received:i}:{}}),n}}),cE=I("$ZodNumberFormat",(t,e)=>{gv.init(t,e),Jd.init(t,e)}),Qd=I("$ZodBoolean",(t,e)=>{j.init(t,e),t._zod.pattern=$d,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=!!n.value}catch{}const s=n.value;return typeof s=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),n}}),Yd=I("$ZodBigInt",(t,e)=>{j.init(t,e),t._zod.pattern=Ld,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=BigInt(n.value)}catch{}return typeof n.value=="bigint"||n.issues.push({expected:"bigint",code:"invalid_type",input:n.value,inst:t}),n}}),uE=I("$ZodBigIntFormat",(t,e)=>{_v.init(t,e),Yd.init(t,e)}),lE=I("$ZodSymbol",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;return typeof s=="symbol"||n.issues.push({expected:"symbol",code:"invalid_type",input:s,inst:t}),n}}),hE=I("$ZodUndefined",(t,e)=>{j.init(t,e),t._zod.pattern=jd,t._zod.values=new Set([void 0]),t._zod.optin="optional",t._zod.optout="optional",t._zod.parse=(n,r)=>{const s=n.value;return typeof s>"u"||n.issues.push({expected:"undefined",code:"invalid_type",input:s,inst:t}),n}}),dE=I("$ZodNull",(t,e)=>{j.init(t,e),t._zod.pattern=Ud,t._zod.values=new Set([null]),t._zod.parse=(n,r)=>{const s=n.value;return s===null||n.issues.push({expected:"null",code:"invalid_type",input:s,inst:t}),n}}),fE=I("$ZodAny",(t,e)=>{j.init(t,e),t._zod.parse=n=>n}),pE=I("$ZodUnknown",(t,e)=>{j.init(t,e),t._zod.parse=n=>n}),mE=I("$ZodNever",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)}),gE=I("$ZodVoid",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;return typeof s>"u"||n.issues.push({expected:"void",code:"invalid_type",input:s,inst:t}),n}}),_E=I("$ZodDate",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=new Date(n.value)}catch{}const s=n.value,i=s instanceof Date;return i&&!Number.isNaN(s.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:s,...i?{received:"Invalid Date"}:{},inst:t}),n}});function Qu(t,e,n){t.issues.length&&e.issues.push(...qe(n,t.issues)),e.value[n]=t.value}const yE=I("$ZodArray",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),n;n.value=Array(s.length);const i=[];for(let o=0;o<s.length;o++){const c=s[o],l=e.element._zod.run({value:c,issues:[]},r);l instanceof Promise?i.push(l.then(h=>Qu(h,n,o))):Qu(l,n,o)}return i.length?Promise.all(i).then(()=>n):n}});function Bs(t,e,n,r,s){if(t.issues.length){if(s&&!(n in r))return;e.issues.push(...qe(n,t.issues))}t.value===void 0?n in r&&(e.value[n]=void 0):e.value[n]=t.value}function Xd(t){const e=Object.keys(t.shape);for(const r of e)if(!t.shape?.[r]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${r}": expected a Zod schema`);const n=Zh(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function ef(t,e,n,r,s,i){const o=[],c=s.keySet,l=s.catchall._zod,h=l.def.type,f=l.optout==="optional";for(const m in e){if(c.has(m))continue;if(h==="never"){o.push(m);continue}const _=l.run({value:e[m],issues:[]},r);_ instanceof Promise?t.push(_.then(b=>Bs(b,n,m,e,f))):Bs(_,n,m,e,f)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:i}),t.length?Promise.all(t).then(()=>n):n}const vE=I("$ZodObject",(t,e)=>{if(j.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const c=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...c};return Object.defineProperty(e,"shape",{value:l}),l}})}const r=Zr(()=>Xd(e));q(t._zod,"propValues",()=>{const c=e.shape,l={};for(const h in c){const f=c[h]._zod;if(f.values){l[h]??(l[h]=new Set);for(const m of f.values)l[h].add(m)}}return l});const s=Vn,i=e.catchall;let o;t._zod.parse=(c,l)=>{o??(o=r.value);const h=c.value;if(!s(h))return c.issues.push({expected:"object",code:"invalid_type",input:h,inst:t}),c;c.value={};const f=[],m=o.shape;for(const _ of o.keys){const b=m[_],N=b._zod.optout==="optional",O=b._zod.run({value:h[_],issues:[]},l);O instanceof Promise?f.push(O.then(M=>Bs(M,c,_,h,N))):Bs(O,c,_,h,N)}return i?ef(f,h,c,l,r.value,t):f.length?Promise.all(f).then(()=>c):c}}),EE=I("$ZodObjectJIT",(t,e)=>{vE.init(t,e);const n=t._zod.parse,r=Zr(()=>Xd(e)),s=_=>{const b=new Dv(["shape","payload","ctx"]),N=r.value,O=G=>{const X=xo(G);return`shape[${X}]._zod.run({ value: input[${X}], issues: [] }, ctx)`};b.write("const input = payload.value;");const M=Object.create(null);let W=0;for(const G of N.keys)M[G]=`key_${W++}`;b.write("const newResult = {};");for(const G of N.keys){const X=M[G],ce=xo(G),w=_[G]?._zod?.optout==="optional";b.write(`const ${X} = ${O(G)};`),w?b.write(`
        if (${X}.issues.length) {
          if (${ce} in input) {
            payload.issues = payload.issues.concat(${X}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${ce}, ...iss.path] : [${ce}]
            })));
          }
        }
        
        if (${X}.value === undefined) {
          if (${ce} in input) {
            newResult[${ce}] = undefined;
          }
        } else {
          newResult[${ce}] = ${X}.value;
        }
        
      `):b.write(`
        if (${X}.issues.length) {
          payload.issues = payload.issues.concat(${X}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${ce}, ...iss.path] : [${ce}]
          })));
        }
        
        if (${X}.value === undefined) {
          if (${ce} in input) {
            newResult[${ce}] = undefined;
          }
        } else {
          newResult[${ce}] = ${X}.value;
        }
        
      `)}b.write("payload.value = newResult;"),b.write("return payload;");const Q=b.compile();return(G,X)=>Q(_,G,X)};let i;const o=Vn,c=!Mo.jitless,h=c&&Uh.value,f=e.catchall;let m;t._zod.parse=(_,b)=>{m??(m=r.value);const N=_.value;return o(N)?c&&h&&b?.async===!1&&b.jitless!==!0?(i||(i=s(e.shape)),_=i(_,b),f?ef([],N,_,b,m,t):_):n(_,b):(_.issues.push({expected:"object",code:"invalid_type",input:N,inst:t}),_)}});function Yu(t,e,n,r){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;const s=t.filter(i=>!nn(i));return s.length===1?(e.value=s[0].value,s[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(i=>i.issues.map(o=>$e(o,r,Qe())))}),e)}const _a=I("$ZodUnion",(t,e)=>{j.init(t,e),q(t._zod,"optin",()=>e.options.some(s=>s._zod.optin==="optional")?"optional":void 0),q(t._zod,"optout",()=>e.options.some(s=>s._zod.optout==="optional")?"optional":void 0),q(t._zod,"values",()=>{if(e.options.every(s=>s._zod.values))return new Set(e.options.flatMap(s=>Array.from(s._zod.values)))}),q(t._zod,"pattern",()=>{if(e.options.every(s=>s._zod.pattern)){const s=e.options.map(i=>i._zod.pattern);return new RegExp(`^(${s.map(i=>_i(i.source)).join("|")})$`)}});const n=e.options.length===1,r=e.options[0]._zod.run;t._zod.parse=(s,i)=>{if(n)return r(s,i);let o=!1;const c=[];for(const l of e.options){const h=l._zod.run({value:s.value,issues:[]},i);if(h instanceof Promise)c.push(h),o=!0;else{if(h.issues.length===0)return h;c.push(h)}}return o?Promise.all(c).then(l=>Yu(l,s,t,i)):Yu(c,s,t,i)}});function Xu(t,e,n,r){const s=t.filter(i=>i.issues.length===0);return s.length===1?(e.value=s[0].value,e):(s.length===0?e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(i=>i.issues.map(o=>$e(o,r,Qe())))}):e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:[],inclusive:!1}),e)}const wE=I("$ZodXor",(t,e)=>{_a.init(t,e),e.inclusive=!1;const n=e.options.length===1,r=e.options[0]._zod.run;t._zod.parse=(s,i)=>{if(n)return r(s,i);let o=!1;const c=[];for(const l of e.options){const h=l._zod.run({value:s.value,issues:[]},i);h instanceof Promise?(c.push(h),o=!0):c.push(h)}return o?Promise.all(c).then(l=>Xu(l,s,t,i)):Xu(c,s,t,i)}}),TE=I("$ZodDiscriminatedUnion",(t,e)=>{e.inclusive=!1,_a.init(t,e);const n=t._zod.parse;q(t._zod,"propValues",()=>{const s={};for(const i of e.options){const o=i._zod.propValues;if(!o||Object.keys(o).length===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(i)}"`);for(const[c,l]of Object.entries(o)){s[c]||(s[c]=new Set);for(const h of l)s[c].add(h)}}return s});const r=Zr(()=>{const s=e.options,i=new Map;for(const o of s){const c=o._zod.propValues?.[e.discriminator];if(!c||c.size===0)throw new Error(`Invalid discriminated union option at index "${e.options.indexOf(o)}"`);for(const l of c){if(i.has(l))throw new Error(`Duplicate discriminator value "${String(l)}"`);i.set(l,o)}}return i});t._zod.parse=(s,i)=>{const o=s.value;if(!Vn(o))return s.issues.push({code:"invalid_type",expected:"object",input:o,inst:t}),s;const c=r.value.get(o?.[e.discriminator]);return c?c._zod.run(s,i):e.unionFallback?n(s,i):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:e.discriminator,input:o,path:[e.discriminator],inst:t}),s)}}),IE=I("$ZodIntersection",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value,i=e.left._zod.run({value:s,issues:[]},r),o=e.right._zod.run({value:s,issues:[]},r);return i instanceof Promise||o instanceof Promise?Promise.all([i,o]).then(([l,h])=>el(n,l,h)):el(n,i,o)}});function zo(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(an(t)&&an(e)){const n=Object.keys(e),r=Object.keys(t).filter(i=>n.indexOf(i)!==-1),s={...t,...e};for(const i of r){const o=zo(t[i],e[i]);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};s[i]=o.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const s=t[r],i=e[r],o=zo(s,i);if(!o.valid)return{valid:!1,mergeErrorPath:[r,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function el(t,e,n){const r=new Map;let s;for(const c of e.issues)if(c.code==="unrecognized_keys"){s??(s=c);for(const l of c.keys)r.has(l)||r.set(l,{}),r.get(l).l=!0}else t.issues.push(c);for(const c of n.issues)if(c.code==="unrecognized_keys")for(const l of c.keys)r.has(l)||r.set(l,{}),r.get(l).r=!0;else t.issues.push(c);const i=[...r].filter(([,c])=>c.l&&c.r).map(([c])=>c);if(i.length&&s&&t.issues.push({...s,keys:i}),nn(t))return t;const o=zo(e.value,n.value);if(!o.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(o.mergeErrorPath)}`);return t.value=o.data,t}const tf=I("$ZodTuple",(t,e)=>{j.init(t,e);const n=e.items;t._zod.parse=(r,s)=>{const i=r.value;if(!Array.isArray(i))return r.issues.push({input:i,inst:t,expected:"tuple",code:"invalid_type"}),r;r.value=[];const o=[],c=[...n].reverse().findIndex(f=>f._zod.optin!=="optional"),l=c===-1?0:n.length-c;if(!e.rest){const f=i.length>n.length,m=i.length<l-1;if(f||m)return r.issues.push({...f?{code:"too_big",maximum:n.length,inclusive:!0}:{code:"too_small",minimum:n.length},input:i,inst:t,origin:"array"}),r}let h=-1;for(const f of n){if(h++,h>=i.length&&h>=l)continue;const m=f._zod.run({value:i[h],issues:[]},s);m instanceof Promise?o.push(m.then(_=>Es(_,r,h))):Es(m,r,h)}if(e.rest){const f=i.slice(n.length);for(const m of f){h++;const _=e.rest._zod.run({value:m,issues:[]},s);_ instanceof Promise?o.push(_.then(b=>Es(b,r,h))):Es(_,r,h)}}return o.length?Promise.all(o).then(()=>r):r}});function Es(t,e,n){t.issues.length&&e.issues.push(...qe(n,t.issues)),e.value[n]=t.value}const AE=I("$ZodRecord",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!an(s))return n.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),n;const i=[],o=e.keyType._zod.values;if(o){n.value={};const c=new Set;for(const h of o)if(typeof h=="string"||typeof h=="number"||typeof h=="symbol"){c.add(typeof h=="number"?h.toString():h);const f=e.valueType._zod.run({value:s[h],issues:[]},r);f instanceof Promise?i.push(f.then(m=>{m.issues.length&&n.issues.push(...qe(h,m.issues)),n.value[h]=m.value})):(f.issues.length&&n.issues.push(...qe(h,f.issues)),n.value[h]=f.value)}let l;for(const h in s)c.has(h)||(l=l??[],l.push(h));l&&l.length>0&&n.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:l})}else{n.value={};for(const c of Reflect.ownKeys(s)){if(c==="__proto__")continue;let l=e.keyType._zod.run({value:c,issues:[]},r);if(l instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(typeof c=="string"&&ga.test(c)&&l.issues.length){const m=e.keyType._zod.run({value:Number(c),issues:[]},r);if(m instanceof Promise)throw new Error("Async schemas not supported in object keys currently");m.issues.length===0&&(l=m)}if(l.issues.length){e.mode==="loose"?n.value[c]=s[c]:n.issues.push({code:"invalid_key",origin:"record",issues:l.issues.map(m=>$e(m,r,Qe())),input:c,path:[c],inst:t});continue}const f=e.valueType._zod.run({value:s[c],issues:[]},r);f instanceof Promise?i.push(f.then(m=>{m.issues.length&&n.issues.push(...qe(c,m.issues)),n.value[l.value]=m.value})):(f.issues.length&&n.issues.push(...qe(c,f.issues)),n.value[l.value]=f.value)}}return i.length?Promise.all(i).then(()=>n):n}}),bE=I("$ZodMap",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!(s instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:s,inst:t}),n;const i=[];n.value=new Map;for(const[o,c]of s){const l=e.keyType._zod.run({value:o,issues:[]},r),h=e.valueType._zod.run({value:c,issues:[]},r);l instanceof Promise||h instanceof Promise?i.push(Promise.all([l,h]).then(([f,m])=>{tl(f,m,n,o,s,t,r)})):tl(l,h,n,o,s,t,r)}return i.length?Promise.all(i).then(()=>n):n}});function tl(t,e,n,r,s,i,o){t.issues.length&&(js.has(typeof r)?n.issues.push(...qe(r,t.issues)):n.issues.push({code:"invalid_key",origin:"map",input:s,inst:i,issues:t.issues.map(c=>$e(c,o,Qe()))})),e.issues.length&&(js.has(typeof r)?n.issues.push(...qe(r,e.issues)):n.issues.push({origin:"map",code:"invalid_element",input:s,inst:i,key:r,issues:e.issues.map(c=>$e(c,o,Qe()))})),n.value.set(t.value,e.value)}const SE=I("$ZodSet",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!(s instanceof Set))return n.issues.push({input:s,inst:t,expected:"set",code:"invalid_type"}),n;const i=[];n.value=new Set;for(const o of s){const c=e.valueType._zod.run({value:o,issues:[]},r);c instanceof Promise?i.push(c.then(l=>nl(l,n))):nl(c,n)}return i.length?Promise.all(i).then(()=>n):n}});function nl(t,e){t.issues.length&&e.issues.push(...t.issues),e.value.add(t.value)}const RE=I("$ZodEnum",(t,e)=>{j.init(t,e);const n=fa(e.entries),r=new Set(n);t._zod.values=r,t._zod.pattern=new RegExp(`^(${n.filter(s=>js.has(typeof s)).map(s=>typeof s=="string"?gt(s):s.toString()).join("|")})$`),t._zod.parse=(s,i)=>{const o=s.value;return r.has(o)||s.issues.push({code:"invalid_value",values:n,input:o,inst:t}),s}}),PE=I("$ZodLiteral",(t,e)=>{if(j.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(e.values);t._zod.values=n,t._zod.pattern=new RegExp(`^(${e.values.map(r=>typeof r=="string"?gt(r):r?gt(r.toString()):String(r)).join("|")})$`),t._zod.parse=(r,s)=>{const i=r.value;return n.has(i)||r.issues.push({code:"invalid_value",values:e.values,input:i,inst:t}),r}}),kE=I("$ZodFile",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;return s instanceof File||n.issues.push({expected:"file",code:"invalid_type",input:s,inst:t}),n}}),CE=I("$ZodTransform",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new da(t.constructor.name);const s=e.transform(n.value,n);if(r.async)return(s instanceof Promise?s:Promise.resolve(s)).then(o=>(n.value=o,n));if(s instanceof Promise)throw new Sn;return n.value=s,n}});function rl(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const nf=I("$ZodOptional",(t,e)=>{j.init(t,e),t._zod.optin="optional",t._zod.optout="optional",q(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),q(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${_i(n.source)})?$`):void 0}),t._zod.parse=(n,r)=>{if(e.innerType._zod.optin==="optional"){const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>rl(i,n.value)):rl(s,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,r)}}),NE=I("$ZodExactOptional",(t,e)=>{nf.init(t,e),q(t._zod,"values",()=>e.innerType._zod.values),q(t._zod,"pattern",()=>e.innerType._zod.pattern),t._zod.parse=(n,r)=>e.innerType._zod.run(n,r)}),OE=I("$ZodNullable",(t,e)=>{j.init(t,e),q(t._zod,"optin",()=>e.innerType._zod.optin),q(t._zod,"optout",()=>e.innerType._zod.optout),q(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${_i(n.source)}|null)$`):void 0}),q(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,r)=>n.value===null?n:e.innerType._zod.run(n,r)}),DE=I("$ZodDefault",(t,e)=>{j.init(t,e),t._zod.optin="optional",q(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);if(n.value===void 0)return n.value=e.defaultValue,n;const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>sl(i,e)):sl(s,e)}});function sl(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const VE=I("$ZodPrefault",(t,e)=>{j.init(t,e),t._zod.optin="optional",q(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>(r.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,r))}),ME=I("$ZodNonOptional",(t,e)=>{j.init(t,e),q(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(r=>r!==void 0)):void 0}),t._zod.parse=(n,r)=>{const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>il(i,t)):il(s,t)}});function il(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const xE=I("$ZodSuccess",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new da("ZodSuccess");const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>(n.value=i.issues.length===0,n)):(n.value=s.issues.length===0,n)}}),zE=I("$ZodCatch",(t,e)=>{j.init(t,e),q(t._zod,"optin",()=>e.innerType._zod.optin),q(t._zod,"optout",()=>e.innerType._zod.optout),q(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(i=>(n.value=i.value,i.issues.length&&(n.value=e.catchValue({...n,error:{issues:i.issues.map(o=>$e(o,r,Qe()))},input:n.value}),n.issues=[]),n)):(n.value=s.value,s.issues.length&&(n.value=e.catchValue({...n,error:{issues:s.issues.map(i=>$e(i,r,Qe()))},input:n.value}),n.issues=[]),n)}}),LE=I("$ZodNaN",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>((typeof n.value!="number"||!Number.isNaN(n.value))&&n.issues.push({input:n.value,inst:t,expected:"nan",code:"invalid_type"}),n)}),FE=I("$ZodPipe",(t,e)=>{j.init(t,e),q(t._zod,"values",()=>e.in._zod.values),q(t._zod,"optin",()=>e.in._zod.optin),q(t._zod,"optout",()=>e.out._zod.optout),q(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,r)=>{if(r.direction==="backward"){const i=e.out._zod.run(n,r);return i instanceof Promise?i.then(o=>ws(o,e.in,r)):ws(i,e.in,r)}const s=e.in._zod.run(n,r);return s instanceof Promise?s.then(i=>ws(i,e.out,r)):ws(s,e.out,r)}});function ws(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const rf=I("$ZodCodec",(t,e)=>{j.init(t,e),q(t._zod,"values",()=>e.in._zod.values),q(t._zod,"optin",()=>e.in._zod.optin),q(t._zod,"optout",()=>e.out._zod.optout),q(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,r)=>{if((r.direction||"forward")==="forward"){const i=e.in._zod.run(n,r);return i instanceof Promise?i.then(o=>Ts(o,e,r)):Ts(i,e,r)}else{const i=e.out._zod.run(n,r);return i instanceof Promise?i.then(o=>Ts(o,e,r)):Ts(i,e,r)}}});function Ts(t,e,n){if(t.issues.length)return t.aborted=!0,t;if((n.direction||"forward")==="forward"){const s=e.transform(t.value,t);return s instanceof Promise?s.then(i=>Is(t,i,e.out,n)):Is(t,s,e.out,n)}else{const s=e.reverseTransform(t.value,t);return s instanceof Promise?s.then(i=>Is(t,i,e.in,n)):Is(t,s,e.in,n)}}function Is(t,e,n,r){return t.issues.length?(t.aborted=!0,t):n._zod.run({value:e,issues:t.issues},r)}const $E=I("$ZodReadonly",(t,e)=>{j.init(t,e),q(t._zod,"propValues",()=>e.innerType._zod.propValues),q(t._zod,"values",()=>e.innerType._zod.values),q(t._zod,"optin",()=>e.innerType?._zod?.optin),q(t._zod,"optout",()=>e.innerType?._zod?.optout),t._zod.parse=(n,r)=>{if(r.direction==="backward")return e.innerType._zod.run(n,r);const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(ol):ol(s)}});function ol(t){return t.value=Object.freeze(t.value),t}const UE=I("$ZodTemplateLiteral",(t,e)=>{j.init(t,e);const n=[];for(const r of e.parts)if(typeof r=="object"&&r!==null){if(!r._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...r._zod.traits].shift()}`);const s=r._zod.pattern instanceof RegExp?r._zod.pattern.source:r._zod.pattern;if(!s)throw new Error(`Invalid template literal part: ${r._zod.traits}`);const i=s.startsWith("^")?1:0,o=s.endsWith("$")?s.length-1:s.length;n.push(s.slice(i,o))}else if(r===null||jh.has(typeof r))n.push(gt(`${r}`));else throw new Error(`Invalid template literal part: ${r}`);t._zod.pattern=new RegExp(`^${n.join("")}$`),t._zod.parse=(r,s)=>typeof r.value!="string"?(r.issues.push({input:r.value,inst:t,expected:"string",code:"invalid_type"}),r):(t._zod.pattern.lastIndex=0,t._zod.pattern.test(r.value)||r.issues.push({input:r.value,inst:t,code:"invalid_format",format:e.format??"template_literal",pattern:t._zod.pattern.source}),r)}),jE=I("$ZodFunction",(t,e)=>(j.init(t,e),t._def=e,t._zod.def=e,t.implement=n=>{if(typeof n!="function")throw new Error("implement() must be called with a function");return function(...r){const s=t._def.input?Hu(t._def.input,r):r,i=Reflect.apply(n,this,s);return t._def.output?Hu(t._def.output,i):i}},t.implementAsync=n=>{if(typeof n!="function")throw new Error("implementAsync() must be called with a function");return async function(...r){const s=t._def.input?await Ku(t._def.input,r):r,i=await Reflect.apply(n,this,s);return t._def.output?await Ku(t._def.output,i):i}},t._zod.parse=(n,r)=>typeof n.value!="function"?(n.issues.push({code:"invalid_type",expected:"function",input:n.value,inst:t}),n):(t._def.output&&t._def.output._zod.def.type==="promise"?n.value=t.implementAsync(n.value):n.value=t.implement(n.value),n),t.input=(...n)=>{const r=t.constructor;return Array.isArray(n[0])?new r({type:"function",input:new tf({type:"tuple",items:n[0],rest:n[1]}),output:t._def.output}):new r({type:"function",input:n[0],output:t._def.output})},t.output=n=>{const r=t.constructor;return new r({type:"function",input:t._def.input,output:n})},t)),BE=I("$ZodPromise",(t,e)=>{j.init(t,e),t._zod.parse=(n,r)=>Promise.resolve(n.value).then(s=>e.innerType._zod.run({value:s,issues:[]},r))}),ZE=I("$ZodLazy",(t,e)=>{j.init(t,e),q(t._zod,"innerType",()=>e.getter()),q(t._zod,"pattern",()=>t._zod.innerType?._zod?.pattern),q(t._zod,"propValues",()=>t._zod.innerType?._zod?.propValues),q(t._zod,"optin",()=>t._zod.innerType?._zod?.optin??void 0),q(t._zod,"optout",()=>t._zod.innerType?._zod?.optout??void 0),t._zod.parse=(n,r)=>t._zod.innerType._zod.run(n,r)}),qE=I("$ZodCustom",(t,e)=>{le.init(t,e),j.init(t,e),t._zod.parse=(n,r)=>n,t._zod.check=n=>{const r=n.value,s=e.fn(r);if(s instanceof Promise)return s.then(i=>al(i,n,r,t));al(s,n,r,t)}});function al(t,e,n,r){if(!t){const s={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(s.params=r._zod.def.params),e.issues.push(Mn(s))}}var cl;const Zk=Symbol("ZodOutput"),qk=Symbol("ZodInput");class GE{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const r=n[0];return this._map.set(e,r),r&&typeof r=="object"&&"id"in r&&this._idmap.set(r.id,e),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const r={...this.get(n)??{}};delete r.id;const s={...r,...this._map.get(e)};return Object.keys(s).length?s:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function WE(){return new GE}(cl=globalThis).__zod_globalRegistry??(cl.__zod_globalRegistry=WE());const ht=globalThis.__zod_globalRegistry;function HE(t,e){return new t({type:"string",...C(e)})}function Gk(t,e){return new t({type:"string",coerce:!0,...C(e)})}function sf(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...C(e)})}function Lo(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...C(e)})}function of(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...C(e)})}function af(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...C(e)})}function cf(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...C(e)})}function uf(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...C(e)})}function ya(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...C(e)})}function lf(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...C(e)})}function hf(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...C(e)})}function df(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...C(e)})}function ff(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...C(e)})}function pf(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...C(e)})}function mf(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...C(e)})}function gf(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...C(e)})}function _f(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...C(e)})}function yf(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...C(e)})}function KE(t,e){return new t({type:"string",format:"mac",check:"string_format",abort:!1,...C(e)})}function vf(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...C(e)})}function Ef(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...C(e)})}function wf(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...C(e)})}function Tf(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...C(e)})}function If(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...C(e)})}function Af(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...C(e)})}const Wk={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function JE(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...C(e)})}function QE(t,e){return new t({type:"string",format:"date",check:"string_format",...C(e)})}function YE(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...C(e)})}function XE(t,e){return new t({type:"string",format:"duration",check:"string_format",...C(e)})}function ew(t,e){return new t({type:"number",checks:[],...C(e)})}function Hk(t,e){return new t({type:"number",coerce:!0,checks:[],...C(e)})}function tw(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...C(e)})}function nw(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float32",...C(e)})}function rw(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"float64",...C(e)})}function sw(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"int32",...C(e)})}function iw(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"uint32",...C(e)})}function ow(t,e){return new t({type:"boolean",...C(e)})}function Kk(t,e){return new t({type:"boolean",coerce:!0,...C(e)})}function aw(t,e){return new t({type:"bigint",...C(e)})}function Jk(t,e){return new t({type:"bigint",coerce:!0,...C(e)})}function cw(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...C(e)})}function uw(t,e){return new t({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...C(e)})}function lw(t,e){return new t({type:"symbol",...C(e)})}function hw(t,e){return new t({type:"undefined",...C(e)})}function dw(t,e){return new t({type:"null",...C(e)})}function fw(t){return new t({type:"any"})}function pw(t){return new t({type:"unknown"})}function mw(t,e){return new t({type:"never",...C(e)})}function gw(t,e){return new t({type:"void",...C(e)})}function _w(t,e){return new t({type:"date",...C(e)})}function Qk(t,e){return new t({type:"date",coerce:!0,...C(e)})}function yw(t,e){return new t({type:"nan",...C(e)})}function Cr(t,e){return new Wd({check:"less_than",...C(e),value:t,inclusive:!1})}function Mt(t,e){return new Wd({check:"less_than",...C(e),value:t,inclusive:!0})}function Nr(t,e){return new Hd({check:"greater_than",...C(e),value:t,inclusive:!1})}function nt(t,e){return new Hd({check:"greater_than",...C(e),value:t,inclusive:!0})}function Yk(t){return Nr(0,t)}function Xk(t){return Cr(0,t)}function eC(t){return Mt(0,t)}function tC(t){return nt(0,t)}function Fo(t,e){return new mv({check:"multiple_of",...C(e),value:t})}function va(t,e){return new yv({check:"max_size",...C(e),maximum:t})}function Or(t,e){return new vv({check:"min_size",...C(e),minimum:t})}function bf(t,e){return new Ev({check:"size_equals",...C(e),size:t})}function Sf(t,e){return new wv({check:"max_length",...C(e),maximum:t})}function Zs(t,e){return new Tv({check:"min_length",...C(e),minimum:t})}function Rf(t,e){return new Iv({check:"length_equals",...C(e),length:t})}function vw(t,e){return new Av({check:"string_format",format:"regex",...C(e),pattern:t})}function Ew(t){return new bv({check:"string_format",format:"lowercase",...C(t)})}function ww(t){return new Sv({check:"string_format",format:"uppercase",...C(t)})}function Tw(t,e){return new Rv({check:"string_format",format:"includes",...C(e),includes:t})}function Iw(t,e){return new Pv({check:"string_format",format:"starts_with",...C(e),prefix:t})}function Aw(t,e){return new kv({check:"string_format",format:"ends_with",...C(e),suffix:t})}function nC(t,e,n){return new Cv({check:"property",property:t,schema:e,...C(n)})}function bw(t,e){return new Nv({check:"mime_type",mime:t,...C(e)})}function qn(t){return new Ov({check:"overwrite",tx:t})}function Sw(t){return qn(e=>e.normalize(t))}function Rw(){return qn(t=>t.trim())}function Pw(){return qn(t=>t.toLowerCase())}function kw(){return qn(t=>t.toUpperCase())}function Cw(){return qn(t=>$h(t))}function Nw(t,e,n){return new t({type:"array",element:e,...C(n)})}function rC(t,e,n){return new t({type:"union",options:e,...C(n)})}function sC(t,e,n){return new t({type:"union",options:e,inclusive:!1,...C(n)})}function iC(t,e,n,r){return new t({type:"union",options:n,discriminator:e,...C(r)})}function oC(t,e,n){return new t({type:"intersection",left:e,right:n})}function aC(t,e,n,r){const s=n instanceof j,i=s?r:n,o=s?n:null;return new t({type:"tuple",items:e,rest:o,...C(i)})}function cC(t,e,n,r){return new t({type:"record",keyType:e,valueType:n,...C(r)})}function uC(t,e,n,r){return new t({type:"map",keyType:e,valueType:n,...C(r)})}function lC(t,e,n){return new t({type:"set",valueType:e,...C(n)})}function hC(t,e,n){const r=Array.isArray(e)?Object.fromEntries(e.map(s=>[s,s])):e;return new t({type:"enum",entries:r,...C(n)})}function dC(t,e,n){return new t({type:"enum",entries:e,...C(n)})}function fC(t,e,n){return new t({type:"literal",values:Array.isArray(e)?e:[e],...C(n)})}function Ow(t,e){return new t({type:"file",...C(e)})}function pC(t,e){return new t({type:"transform",transform:e})}function mC(t,e){return new t({type:"optional",innerType:e})}function gC(t,e){return new t({type:"nullable",innerType:e})}function _C(t,e,n){return new t({type:"default",innerType:e,get defaultValue(){return typeof n=="function"?n():yi(n)}})}function yC(t,e,n){return new t({type:"nonoptional",innerType:e,...C(n)})}function vC(t,e){return new t({type:"success",innerType:e})}function EC(t,e,n){return new t({type:"catch",innerType:e,catchValue:typeof n=="function"?n:()=>n})}function wC(t,e,n){return new t({type:"pipe",in:e,out:n})}function TC(t,e){return new t({type:"readonly",innerType:e})}function IC(t,e,n){return new t({type:"template_literal",parts:e,...C(n)})}function AC(t,e){return new t({type:"lazy",getter:e})}function bC(t,e){return new t({type:"promise",innerType:e})}function Dw(t,e,n){const r=C(n);return r.abort??(r.abort=!0),new t({type:"custom",check:"custom",fn:e,...r})}function Vw(t,e,n){return new t({type:"custom",check:"custom",fn:e,...C(n)})}function Mw(t){const e=xw(n=>(n.addIssue=r=>{if(typeof r=="string")n.issues.push(Mn(r,n.value,e._zod.def));else{const s=r;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=e),s.continue??(s.continue=!e._zod.def.abort),n.issues.push(Mn(s))}},t(n.value,n)));return e}function xw(t,e){const n=new le({check:"custom",...C(e)});return n._zod.check=t,n}function zw(t){const e=new le({check:"describe"});return e._zod.onattach=[n=>{const r=ht.get(n)??{};ht.add(n,{...r,description:t})}],e._zod.check=()=>{},e}function Lw(t){const e=new le({check:"meta"});return e._zod.onattach=[n=>{const r=ht.get(n)??{};ht.add(n,{...r,...t})}],e._zod.check=()=>{},e}function Fw(t,e){const n=C(e);let r=n.truthy??["true","1","yes","on","y","enabled"],s=n.falsy??["false","0","no","off","n","disabled"];n.case!=="sensitive"&&(r=r.map(b=>typeof b=="string"?b.toLowerCase():b),s=s.map(b=>typeof b=="string"?b.toLowerCase():b));const i=new Set(r),o=new Set(s),c=t.Codec??rf,l=t.Boolean??Qd,h=t.String??Si,f=new h({type:"string",error:n.error}),m=new l({type:"boolean",error:n.error}),_=new c({type:"pipe",in:f,out:m,transform:((b,N)=>{let O=b;return n.case!=="sensitive"&&(O=O.toLowerCase()),i.has(O)?!0:o.has(O)?!1:(N.issues.push({code:"invalid_value",expected:"stringbool",values:[...i,...o],input:N.value,inst:_,continue:!1}),{})}),reverseTransform:((b,N)=>b===!0?r[0]||"true":s[0]||"false"),error:n.error});return _}function Ri(t,e,n,r={}){const s=C(r),i={...C(r),check:"string_format",type:"string",format:e,fn:typeof n=="function"?n:c=>n.test(c),...s};return n instanceof RegExp&&(i.pattern=n),new t(i)}function qs(t){let e=t?.target??"draft-2020-12";return e==="draft-4"&&(e="draft-04"),e==="draft-7"&&(e="draft-07"),{processors:t.processors??{},metadataRegistry:t?.metadata??ht,target:e,unrepresentable:t?.unrepresentable??"throw",override:t?.override??(()=>{}),io:t?.io??"output",counter:0,seen:new Map,cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0}}function se(t,e,n={path:[],schemaPath:[]}){var r;const s=t._zod.def,i=e.seen.get(t);if(i)return i.count++,n.schemaPath.includes(t)&&(i.cycle=n.path),i.schema;const o={schema:{},count:1,cycle:void 0,path:n.path};e.seen.set(t,o);const c=t._zod.toJSONSchema?.();if(c)o.schema=c;else{const f={...n,schemaPath:[...n.schemaPath,t],path:n.path};if(t._zod.processJSONSchema)t._zod.processJSONSchema(e,o.schema,f);else{const _=o.schema,b=e.processors[s.type];if(!b)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${s.type}`);b(t,e,_,f)}const m=t._zod.parent;m&&(o.ref||(o.ref=m),se(m,e,f),e.seen.get(m).isParent=!0)}const l=e.metadataRegistry.get(t);return l&&Object.assign(o.schema,l),e.io==="input"&&Oe(t)&&(delete o.schema.examples,delete o.schema.default),e.io==="input"&&o.schema._prefault&&((r=o.schema).default??(r.default=o.schema._prefault)),delete o.schema._prefault,e.seen.get(t).schema}function Gs(t,e){const n=t.seen.get(e);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=new Map;for(const o of t.seen.entries()){const c=t.metadataRegistry.get(o[0])?.id;if(c){const l=r.get(c);if(l&&l!==o[0])throw new Error(`Duplicate schema id "${c}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);r.set(c,o[0])}}const s=o=>{const c=t.target==="draft-2020-12"?"$defs":"definitions";if(t.external){const m=t.external.registry.get(o[0])?.id,_=t.external.uri??(N=>N);if(m)return{ref:_(m)};const b=o[1].defId??o[1].schema.id??`schema${t.counter++}`;return o[1].defId=b,{defId:b,ref:`${_("__shared")}#/${c}/${b}`}}if(o[1]===n)return{ref:"#"};const h=`#/${c}/`,f=o[1].schema.id??`__schema${t.counter++}`;return{defId:f,ref:h+f}},i=o=>{if(o[1].schema.$ref)return;const c=o[1],{ref:l,defId:h}=s(o);c.def={...c.schema},h&&(c.defId=h);const f=c.schema;for(const m in f)delete f[m];f.$ref=l};if(t.cycles==="throw")for(const o of t.seen.entries()){const c=o[1];if(c.cycle)throw new Error(`Cycle detected: #/${c.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const o of t.seen.entries()){const c=o[1];if(e===o[0]){i(o);continue}if(t.external){const h=t.external.registry.get(o[0])?.id;if(e!==o[0]&&h){i(o);continue}}if(t.metadataRegistry.get(o[0])?.id){i(o);continue}if(c.cycle){i(o);continue}if(c.count>1&&t.reused==="ref"){i(o);continue}}}function Ws(t,e){const n=t.seen.get(e);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const r=o=>{const c=t.seen.get(o);if(c.ref===null)return;const l=c.def??c.schema,h={...l},f=c.ref;if(c.ref=null,f){r(f);const _=t.seen.get(f),b=_.schema;if(b.$ref&&(t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0")?(l.allOf=l.allOf??[],l.allOf.push(b)):Object.assign(l,b),Object.assign(l,h),o._zod.parent===f)for(const O in l)O==="$ref"||O==="allOf"||O in h||delete l[O];if(b.$ref&&_.def)for(const O in l)O==="$ref"||O==="allOf"||O in _.def&&JSON.stringify(l[O])===JSON.stringify(_.def[O])&&delete l[O]}const m=o._zod.parent;if(m&&m!==f){r(m);const _=t.seen.get(m);if(_?.schema.$ref&&(l.$ref=_.schema.$ref,_.def))for(const b in l)b==="$ref"||b==="allOf"||b in _.def&&JSON.stringify(l[b])===JSON.stringify(_.def[b])&&delete l[b]}t.override({zodSchema:o,jsonSchema:l,path:c.path??[]})};for(const o of[...t.seen.entries()].reverse())r(o[0]);const s={};if(t.target==="draft-2020-12"?s.$schema="https://json-schema.org/draft/2020-12/schema":t.target==="draft-07"?s.$schema="http://json-schema.org/draft-07/schema#":t.target==="draft-04"?s.$schema="http://json-schema.org/draft-04/schema#":t.target,t.external?.uri){const o=t.external.registry.get(e)?.id;if(!o)throw new Error("Schema is missing an `id` property");s.$id=t.external.uri(o)}Object.assign(s,n.def??n.schema);const i=t.external?.defs??{};for(const o of t.seen.entries()){const c=o[1];c.def&&c.defId&&(i[c.defId]=c.def)}t.external||Object.keys(i).length>0&&(t.target==="draft-2020-12"?s.$defs=i:s.definitions=i);try{const o=JSON.parse(JSON.stringify(s));return Object.defineProperty(o,"~standard",{value:{...e["~standard"],jsonSchema:{input:Hs(e,"input",t.processors),output:Hs(e,"output",t.processors)}},enumerable:!1,writable:!1}),o}catch{throw new Error("Error converting schema to JSON.")}}function Oe(t,e){const n=e??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);const r=t._zod.def;if(r.type==="transform")return!0;if(r.type==="array")return Oe(r.element,n);if(r.type==="set")return Oe(r.valueType,n);if(r.type==="lazy")return Oe(r.getter(),n);if(r.type==="promise"||r.type==="optional"||r.type==="nonoptional"||r.type==="nullable"||r.type==="readonly"||r.type==="default"||r.type==="prefault")return Oe(r.innerType,n);if(r.type==="intersection")return Oe(r.left,n)||Oe(r.right,n);if(r.type==="record"||r.type==="map")return Oe(r.keyType,n)||Oe(r.valueType,n);if(r.type==="pipe")return Oe(r.in,n)||Oe(r.out,n);if(r.type==="object"){for(const s in r.shape)if(Oe(r.shape[s],n))return!0;return!1}if(r.type==="union"){for(const s of r.options)if(Oe(s,n))return!0;return!1}if(r.type==="tuple"){for(const s of r.items)if(Oe(s,n))return!0;return!!(r.rest&&Oe(r.rest,n))}return!1}const $w=(t,e={})=>n=>{const r=qs({...n,processors:e});return se(t,r),Gs(r,t),Ws(r,t)},Hs=(t,e,n={})=>r=>{const{libraryOptions:s,target:i}=r??{},o=qs({...s??{},target:i,io:e,processors:n});return se(t,o),Gs(o,t),Ws(o,t)},Uw={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},Pf=(t,e,n,r)=>{const s=n;s.type="string";const{minimum:i,maximum:o,format:c,patterns:l,contentEncoding:h}=t._zod.bag;if(typeof i=="number"&&(s.minLength=i),typeof o=="number"&&(s.maxLength=o),c&&(s.format=Uw[c]??c,s.format===""&&delete s.format,c==="time"&&delete s.format),h&&(s.contentEncoding=h),l&&l.size>0){const f=[...l];f.length===1?s.pattern=f[0].source:f.length>1&&(s.allOf=[...f.map(m=>({...e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0"?{type:"string"}:{},pattern:m.source}))])}},kf=(t,e,n,r)=>{const s=n,{minimum:i,maximum:o,format:c,multipleOf:l,exclusiveMaximum:h,exclusiveMinimum:f}=t._zod.bag;typeof c=="string"&&c.includes("int")?s.type="integer":s.type="number",typeof f=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(s.minimum=f,s.exclusiveMinimum=!0):s.exclusiveMinimum=f),typeof i=="number"&&(s.minimum=i,typeof f=="number"&&e.target!=="draft-04"&&(f>=i?delete s.minimum:delete s.exclusiveMinimum)),typeof h=="number"&&(e.target==="draft-04"||e.target==="openapi-3.0"?(s.maximum=h,s.exclusiveMaximum=!0):s.exclusiveMaximum=h),typeof o=="number"&&(s.maximum=o,typeof h=="number"&&e.target!=="draft-04"&&(h<=o?delete s.maximum:delete s.exclusiveMaximum)),typeof l=="number"&&(s.multipleOf=l)},Cf=(t,e,n,r)=>{n.type="boolean"},Nf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema")},Of=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema")},Df=(t,e,n,r)=>{e.target==="openapi-3.0"?(n.type="string",n.nullable=!0,n.enum=[null]):n.type="null"},Vf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema")},Mf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema")},xf=(t,e,n,r)=>{n.not={}},zf=(t,e,n,r)=>{},Lf=(t,e,n,r)=>{},Ff=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema")},$f=(t,e,n,r)=>{const s=t._zod.def,i=fa(s.entries);i.every(o=>typeof o=="number")&&(n.type="number"),i.every(o=>typeof o=="string")&&(n.type="string"),n.enum=i},Uf=(t,e,n,r)=>{const s=t._zod.def,i=[];for(const o of s.values)if(o===void 0){if(e.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof o=="bigint"){if(e.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");i.push(Number(o))}else i.push(o);if(i.length!==0)if(i.length===1){const o=i[0];n.type=o===null?"null":typeof o,e.target==="draft-04"||e.target==="openapi-3.0"?n.enum=[o]:n.const=o}else i.every(o=>typeof o=="number")&&(n.type="number"),i.every(o=>typeof o=="string")&&(n.type="string"),i.every(o=>typeof o=="boolean")&&(n.type="boolean"),i.every(o=>o===null)&&(n.type="null"),n.enum=i},jf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema")},Bf=(t,e,n,r)=>{const s=n,i=t._zod.pattern;if(!i)throw new Error("Pattern not found in template literal");s.type="string",s.pattern=i.source},Zf=(t,e,n,r)=>{const s=n,i={type:"string",format:"binary",contentEncoding:"binary"},{minimum:o,maximum:c,mime:l}=t._zod.bag;o!==void 0&&(i.minLength=o),c!==void 0&&(i.maxLength=c),l?l.length===1?(i.contentMediaType=l[0],Object.assign(s,i)):(Object.assign(s,i),s.anyOf=l.map(h=>({contentMediaType:h}))):Object.assign(s,i)},qf=(t,e,n,r)=>{n.type="boolean"},Gf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},Wf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},Hf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},Kf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},Jf=(t,e,n,r)=>{if(e.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema")},Qf=(t,e,n,r)=>{const s=n,i=t._zod.def,{minimum:o,maximum:c}=t._zod.bag;typeof o=="number"&&(s.minItems=o),typeof c=="number"&&(s.maxItems=c),s.type="array",s.items=se(i.element,e,{...r,path:[...r.path,"items"]})},Yf=(t,e,n,r)=>{const s=n,i=t._zod.def;s.type="object",s.properties={};const o=i.shape;for(const h in o)s.properties[h]=se(o[h],e,{...r,path:[...r.path,"properties",h]});const c=new Set(Object.keys(o)),l=new Set([...c].filter(h=>{const f=i.shape[h]._zod;return e.io==="input"?f.optin===void 0:f.optout===void 0}));l.size>0&&(s.required=Array.from(l)),i.catchall?._zod.def.type==="never"?s.additionalProperties=!1:i.catchall?i.catchall&&(s.additionalProperties=se(i.catchall,e,{...r,path:[...r.path,"additionalProperties"]})):e.io==="output"&&(s.additionalProperties=!1)},Ea=(t,e,n,r)=>{const s=t._zod.def,i=s.inclusive===!1,o=s.options.map((c,l)=>se(c,e,{...r,path:[...r.path,i?"oneOf":"anyOf",l]}));i?n.oneOf=o:n.anyOf=o},Xf=(t,e,n,r)=>{const s=t._zod.def,i=se(s.left,e,{...r,path:[...r.path,"allOf",0]}),o=se(s.right,e,{...r,path:[...r.path,"allOf",1]}),c=h=>"allOf"in h&&Object.keys(h).length===1,l=[...c(i)?i.allOf:[i],...c(o)?o.allOf:[o]];n.allOf=l},ep=(t,e,n,r)=>{const s=n,i=t._zod.def;s.type="array";const o=e.target==="draft-2020-12"?"prefixItems":"items",c=e.target==="draft-2020-12"||e.target==="openapi-3.0"?"items":"additionalItems",l=i.items.map((_,b)=>se(_,e,{...r,path:[...r.path,o,b]})),h=i.rest?se(i.rest,e,{...r,path:[...r.path,c,...e.target==="openapi-3.0"?[i.items.length]:[]]}):null;e.target==="draft-2020-12"?(s.prefixItems=l,h&&(s.items=h)):e.target==="openapi-3.0"?(s.items={anyOf:l},h&&s.items.anyOf.push(h),s.minItems=l.length,h||(s.maxItems=l.length)):(s.items=l,h&&(s.additionalItems=h));const{minimum:f,maximum:m}=t._zod.bag;typeof f=="number"&&(s.minItems=f),typeof m=="number"&&(s.maxItems=m)},tp=(t,e,n,r)=>{const s=n,i=t._zod.def;s.type="object";const o=i.keyType,l=o._zod.bag?.patterns;if(i.mode==="loose"&&l&&l.size>0){const f=se(i.valueType,e,{...r,path:[...r.path,"patternProperties","*"]});s.patternProperties={};for(const m of l)s.patternProperties[m.source]=f}else(e.target==="draft-07"||e.target==="draft-2020-12")&&(s.propertyNames=se(i.keyType,e,{...r,path:[...r.path,"propertyNames"]})),s.additionalProperties=se(i.valueType,e,{...r,path:[...r.path,"additionalProperties"]});const h=o._zod.values;if(h){const f=[...h].filter(m=>typeof m=="string"||typeof m=="number");f.length>0&&(s.required=f)}},np=(t,e,n,r)=>{const s=t._zod.def,i=se(s.innerType,e,r),o=e.seen.get(t);e.target==="openapi-3.0"?(o.ref=s.innerType,n.nullable=!0):n.anyOf=[i,{type:"null"}]},rp=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType},sp=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType,n.default=JSON.parse(JSON.stringify(s.defaultValue))},ip=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType,e.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(s.defaultValue)))},op=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType;let o;try{o=s.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=o},ap=(t,e,n,r)=>{const s=t._zod.def,i=e.io==="input"?s.in._zod.def.type==="transform"?s.out:s.in:s.out;se(i,e,r);const o=e.seen.get(t);o.ref=i},cp=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType,n.readOnly=!0},up=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType},wa=(t,e,n,r)=>{const s=t._zod.def;se(s.innerType,e,r);const i=e.seen.get(t);i.ref=s.innerType},lp=(t,e,n,r)=>{const s=t._zod.innerType;se(s,e,r);const i=e.seen.get(t);i.ref=s},ul={string:Pf,number:kf,boolean:Cf,bigint:Nf,symbol:Of,null:Df,undefined:Vf,void:Mf,never:xf,any:zf,unknown:Lf,date:Ff,enum:$f,literal:Uf,nan:jf,template_literal:Bf,file:Zf,success:qf,custom:Gf,function:Wf,transform:Hf,map:Kf,set:Jf,array:Qf,object:Yf,union:Ea,intersection:Xf,tuple:ep,record:tp,nullable:np,nonoptional:rp,default:sp,prefault:ip,catch:op,pipe:ap,readonly:cp,promise:up,optional:wa,lazy:lp};function SC(t,e){if("_idmap"in t){const r=t,s=qs({...e,processors:ul}),i={};for(const l of r._idmap.entries()){const[h,f]=l;se(f,s)}const o={},c={registry:r,uri:e?.uri,defs:i};s.external=c;for(const l of r._idmap.entries()){const[h,f]=l;Gs(s,f),o[h]=Ws(s,f)}if(Object.keys(i).length>0){const l=s.target==="draft-2020-12"?"$defs":"definitions";o.__shared={[l]:i}}return{schemas:o}}const n=qs({...e,processors:ul});return se(t,n),Gs(n,t),Ws(n,t)}const hp=I("ZodISODateTime",(t,e)=>{Gv.init(t,e),oe.init(t,e)});function dp(t){return JE(hp,t)}const fp=I("ZodISODate",(t,e)=>{Wv.init(t,e),oe.init(t,e)});function pp(t){return QE(fp,t)}const mp=I("ZodISOTime",(t,e)=>{Hv.init(t,e),oe.init(t,e)});function gp(t){return YE(mp,t)}const _p=I("ZodISODuration",(t,e)=>{Kv.init(t,e),oe.init(t,e)});function yp(t){return XE(_p,t)}const RC=Object.freeze(Object.defineProperty({__proto__:null,ZodISODate:fp,ZodISODateTime:hp,ZodISODuration:_p,ZodISOTime:mp,date:pp,datetime:dp,duration:yp,time:gp},Symbol.toStringTag,{value:"Module"})),vp=(t,e)=>{rd.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>$y(t,n)},flatten:{value:n=>Fy(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,Us,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,Us,2)}},isEmpty:{get(){return t.issues.length===0}}})},PC=I("ZodError",vp),je=I("ZodError",vp,{Parent:Error}),jw=wi(je),Bw=Ti(je),Zw=Ii(je),qw=Ai(je),Gw=sd(je),Ww=id(je),Hw=od(je),Kw=ad(je),Jw=cd(je),Qw=ud(je),Yw=ld(je),Xw=hd(je),B=I("ZodType",(t,e)=>(j.init(t,e),Object.assign(t["~standard"],{jsonSchema:{input:Hs(t,"input"),output:Hs(t,"output")}}),t.toJSONSchema=$w(t,{}),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(ut(e,{checks:[...e.checks??[],...n.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),{parent:!0}),t.with=t.check,t.clone=(n,r)=>lt(t,n,r),t.brand=()=>t,t.register=((n,r)=>(n.add(t,r),t)),t.parse=(n,r)=>jw(t,n,r,{callee:t.parse}),t.safeParse=(n,r)=>Zw(t,n,r),t.parseAsync=async(n,r)=>Bw(t,n,r,{callee:t.parseAsync}),t.safeParseAsync=async(n,r)=>qw(t,n,r),t.spa=t.safeParseAsync,t.encode=(n,r)=>Gw(t,n,r),t.decode=(n,r)=>Ww(t,n,r),t.encodeAsync=async(n,r)=>Hw(t,n,r),t.decodeAsync=async(n,r)=>Kw(t,n,r),t.safeEncode=(n,r)=>Jw(t,n,r),t.safeDecode=(n,r)=>Qw(t,n,r),t.safeEncodeAsync=async(n,r)=>Yw(t,n,r),t.safeDecodeAsync=async(n,r)=>Xw(t,n,r),t.refine=(n,r)=>t.check(hm(n,r)),t.superRefine=n=>t.check(dm(n)),t.overwrite=n=>t.check(qn(n)),t.optional=()=>Js(t),t.exactOptional=()=>Wp(t),t.nullable=()=>Qs(t),t.nullish=()=>Js(Qs(t)),t.nonoptional=n=>Xp(t,n),t.array=()=>ki(t),t.or=n=>qa([t,n]),t.and=n=>zp(t,n),t.transform=n=>Ys(t,Ga(n)),t.default=n=>Jp(t,n),t.prefault=n=>Yp(t,n),t.catch=n=>nm(t,n),t.pipe=n=>Ys(t,n),t.readonly=()=>im(t),t.describe=n=>{const r=t.clone();return ht.add(r,{description:n}),r},Object.defineProperty(t,"description",{get(){return ht.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return ht.get(t);const r=t.clone();return ht.add(r,n[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t.apply=n=>n(t),t)),Ta=I("_ZodString",(t,e)=>{Si.init(t,e),B.init(t,e),t._zod.processJSONSchema=(r,s,i)=>Pf(t,r,s);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...r)=>t.check(vw(...r)),t.includes=(...r)=>t.check(Tw(...r)),t.startsWith=(...r)=>t.check(Iw(...r)),t.endsWith=(...r)=>t.check(Aw(...r)),t.min=(...r)=>t.check(Zs(...r)),t.max=(...r)=>t.check(Sf(...r)),t.length=(...r)=>t.check(Rf(...r)),t.nonempty=(...r)=>t.check(Zs(1,...r)),t.lowercase=r=>t.check(Ew(r)),t.uppercase=r=>t.check(ww(r)),t.trim=()=>t.check(Rw()),t.normalize=(...r)=>t.check(Sw(...r)),t.toLowerCase=()=>t.check(Pw()),t.toUpperCase=()=>t.check(kw()),t.slugify=()=>t.check(Cw())}),Ia=I("ZodString",(t,e)=>{Si.init(t,e),Ta.init(t,e),t.email=n=>t.check(sf(Aa,n)),t.url=n=>t.check(ya(Pi,n)),t.jwt=n=>t.check(Af(Fa,n)),t.emoji=n=>t.check(lf(ba,n)),t.guid=n=>t.check(Lo(Ks,n)),t.uuid=n=>t.check(of(dt,n)),t.uuidv4=n=>t.check(af(dt,n)),t.uuidv6=n=>t.check(cf(dt,n)),t.uuidv7=n=>t.check(uf(dt,n)),t.nanoid=n=>t.check(hf(Sa,n)),t.guid=n=>t.check(Lo(Ks,n)),t.cuid=n=>t.check(df(Ra,n)),t.cuid2=n=>t.check(ff(Pa,n)),t.ulid=n=>t.check(pf(ka,n)),t.base64=n=>t.check(wf(xa,n)),t.base64url=n=>t.check(Tf(za,n)),t.xid=n=>t.check(mf(Ca,n)),t.ksuid=n=>t.check(gf(Na,n)),t.ipv4=n=>t.check(_f(Oa,n)),t.ipv6=n=>t.check(yf(Da,n)),t.cidrv4=n=>t.check(vf(Va,n)),t.cidrv6=n=>t.check(Ef(Ma,n)),t.e164=n=>t.check(If(La,n)),t.datetime=n=>t.check(dp(n)),t.date=n=>t.check(pp(n)),t.time=n=>t.check(gp(n)),t.duration=n=>t.check(yp(n))});function Le(t){return HE(Ia,t)}const oe=I("ZodStringFormat",(t,e)=>{ie.init(t,e),Ta.init(t,e)}),Aa=I("ZodEmail",(t,e)=>{zv.init(t,e),oe.init(t,e)});function eT(t){return sf(Aa,t)}const Ks=I("ZodGUID",(t,e)=>{Mv.init(t,e),oe.init(t,e)});function tT(t){return Lo(Ks,t)}const dt=I("ZodUUID",(t,e)=>{xv.init(t,e),oe.init(t,e)});function nT(t){return of(dt,t)}function rT(t){return af(dt,t)}function sT(t){return cf(dt,t)}function iT(t){return uf(dt,t)}const Pi=I("ZodURL",(t,e)=>{Lv.init(t,e),oe.init(t,e)});function oT(t){return ya(Pi,t)}function aT(t){return ya(Pi,{protocol:/^https?$/,hostname:Cd,...C(t)})}const ba=I("ZodEmoji",(t,e)=>{Fv.init(t,e),oe.init(t,e)});function cT(t){return lf(ba,t)}const Sa=I("ZodNanoID",(t,e)=>{$v.init(t,e),oe.init(t,e)});function uT(t){return hf(Sa,t)}const Ra=I("ZodCUID",(t,e)=>{Uv.init(t,e),oe.init(t,e)});function lT(t){return df(Ra,t)}const Pa=I("ZodCUID2",(t,e)=>{jv.init(t,e),oe.init(t,e)});function hT(t){return ff(Pa,t)}const ka=I("ZodULID",(t,e)=>{Bv.init(t,e),oe.init(t,e)});function dT(t){return pf(ka,t)}const Ca=I("ZodXID",(t,e)=>{Zv.init(t,e),oe.init(t,e)});function fT(t){return mf(Ca,t)}const Na=I("ZodKSUID",(t,e)=>{qv.init(t,e),oe.init(t,e)});function pT(t){return gf(Na,t)}const Oa=I("ZodIPv4",(t,e)=>{Jv.init(t,e),oe.init(t,e)});function mT(t){return _f(Oa,t)}const Ep=I("ZodMAC",(t,e)=>{Yv.init(t,e),oe.init(t,e)});function gT(t){return KE(Ep,t)}const Da=I("ZodIPv6",(t,e)=>{Qv.init(t,e),oe.init(t,e)});function _T(t){return yf(Da,t)}const Va=I("ZodCIDRv4",(t,e)=>{Xv.init(t,e),oe.init(t,e)});function yT(t){return vf(Va,t)}const Ma=I("ZodCIDRv6",(t,e)=>{eE.init(t,e),oe.init(t,e)});function vT(t){return Ef(Ma,t)}const xa=I("ZodBase64",(t,e)=>{tE.init(t,e),oe.init(t,e)});function ET(t){return wf(xa,t)}const za=I("ZodBase64URL",(t,e)=>{rE.init(t,e),oe.init(t,e)});function wT(t){return Tf(za,t)}const La=I("ZodE164",(t,e)=>{sE.init(t,e),oe.init(t,e)});function TT(t){return If(La,t)}const Fa=I("ZodJWT",(t,e)=>{oE.init(t,e),oe.init(t,e)});function IT(t){return Af(Fa,t)}const Wr=I("ZodCustomStringFormat",(t,e)=>{aE.init(t,e),oe.init(t,e)});function AT(t,e,n={}){return Ri(Wr,t,e,n)}function bT(t){return Ri(Wr,"hostname",kd,t)}function ST(t){return Ri(Wr,"hex",qd,t)}function RT(t,e){const n=e?.enc??"hex",r=`${t}_${n}`,s=pv[r];if(!s)throw new Error(`Unrecognized hash format: ${r}`);return Ri(Wr,r,s,e)}const $a=I("ZodNumber",(t,e)=>{Jd.init(t,e),B.init(t,e),t._zod.processJSONSchema=(r,s,i)=>kf(t,r,s),t.gt=(r,s)=>t.check(Nr(r,s)),t.gte=(r,s)=>t.check(nt(r,s)),t.min=(r,s)=>t.check(nt(r,s)),t.lt=(r,s)=>t.check(Cr(r,s)),t.lte=(r,s)=>t.check(Mt(r,s)),t.max=(r,s)=>t.check(Mt(r,s)),t.int=r=>t.check($o(r)),t.safe=r=>t.check($o(r)),t.positive=r=>t.check(Nr(0,r)),t.nonnegative=r=>t.check(nt(0,r)),t.negative=r=>t.check(Cr(0,r)),t.nonpositive=r=>t.check(Mt(0,r)),t.multipleOf=(r,s)=>t.check(Fo(r,s)),t.step=(r,s)=>t.check(Fo(r,s)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function wp(t){return ew($a,t)}const Gn=I("ZodNumberFormat",(t,e)=>{cE.init(t,e),$a.init(t,e)});function $o(t){return tw(Gn,t)}function PT(t){return nw(Gn,t)}function kT(t){return rw(Gn,t)}function CT(t){return sw(Gn,t)}function NT(t){return iw(Gn,t)}const Ua=I("ZodBoolean",(t,e)=>{Qd.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Cf(t,n,r)});function Tp(t){return ow(Ua,t)}const ja=I("ZodBigInt",(t,e)=>{Yd.init(t,e),B.init(t,e),t._zod.processJSONSchema=(r,s,i)=>Nf(t,r),t.gte=(r,s)=>t.check(nt(r,s)),t.min=(r,s)=>t.check(nt(r,s)),t.gt=(r,s)=>t.check(Nr(r,s)),t.gte=(r,s)=>t.check(nt(r,s)),t.min=(r,s)=>t.check(nt(r,s)),t.lt=(r,s)=>t.check(Cr(r,s)),t.lte=(r,s)=>t.check(Mt(r,s)),t.max=(r,s)=>t.check(Mt(r,s)),t.positive=r=>t.check(Nr(BigInt(0),r)),t.negative=r=>t.check(Cr(BigInt(0),r)),t.nonpositive=r=>t.check(Mt(BigInt(0),r)),t.nonnegative=r=>t.check(nt(BigInt(0),r)),t.multipleOf=(r,s)=>t.check(Fo(r,s));const n=t._zod.bag;t.minValue=n.minimum??null,t.maxValue=n.maximum??null,t.format=n.format??null});function OT(t){return aw(ja,t)}const Ba=I("ZodBigIntFormat",(t,e)=>{uE.init(t,e),ja.init(t,e)});function DT(t){return cw(Ba,t)}function VT(t){return uw(Ba,t)}const Ip=I("ZodSymbol",(t,e)=>{lE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Of(t,n)});function MT(t){return lw(Ip,t)}const Ap=I("ZodUndefined",(t,e)=>{hE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Vf(t,n)});function xT(t){return hw(Ap,t)}const bp=I("ZodNull",(t,e)=>{dE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Df(t,n,r)});function Sp(t){return dw(bp,t)}const Rp=I("ZodAny",(t,e)=>{fE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>zf()});function zT(){return fw(Rp)}const Pp=I("ZodUnknown",(t,e)=>{pE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Lf()});function zn(){return pw(Pp)}const kp=I("ZodNever",(t,e)=>{mE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>xf(t,n,r)});function Za(t){return mw(kp,t)}const Cp=I("ZodVoid",(t,e)=>{gE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Mf(t,n)});function LT(t){return gw(Cp,t)}const Np=I("ZodDate",(t,e)=>{_E.init(t,e),B.init(t,e),t._zod.processJSONSchema=(r,s,i)=>Ff(t,r),t.min=(r,s)=>t.check(nt(r,s)),t.max=(r,s)=>t.check(Mt(r,s));const n=t._zod.bag;t.minDate=n.minimum?new Date(n.minimum):null,t.maxDate=n.maximum?new Date(n.maximum):null});function FT(t){return _w(Np,t)}const Op=I("ZodArray",(t,e)=>{yE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Qf(t,n,r,s),t.element=e.element,t.min=(n,r)=>t.check(Zs(n,r)),t.nonempty=n=>t.check(Zs(1,n)),t.max=(n,r)=>t.check(Sf(n,r)),t.length=(n,r)=>t.check(Rf(n,r)),t.unwrap=()=>t.element});function ki(t,e){return Nw(Op,t,e)}function $T(t){const e=t._zod.def.shape;return Di(Object.keys(e))}const Ci=I("ZodObject",(t,e)=>{EE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Yf(t,n,r,s),q(t,"shape",()=>e.shape),t.keyof=()=>Di(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:zn()}),t.loose=()=>t.clone({...t._zod.def,catchall:zn()}),t.strict=()=>t.clone({...t._zod.def,catchall:Za()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>Kh(t,n),t.safeExtend=n=>Jh(t,n),t.merge=n=>Qh(t,n),t.pick=n=>Wh(t,n),t.omit=n=>Hh(t,n),t.partial=(...n)=>Yh(Wa,t,n[0]),t.required=(...n)=>Xh(Ha,t,n[0])});function Dp(t,e){const n={type:"object",shape:t??{},...C(e)};return new Ci(n)}function UT(t,e){return new Ci({type:"object",shape:t,catchall:Za(),...C(e)})}function jT(t,e){return new Ci({type:"object",shape:t,catchall:zn(),...C(e)})}const Ni=I("ZodUnion",(t,e)=>{_a.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Ea(t,n,r,s),t.options=e.options});function qa(t,e){return new Ni({type:"union",options:t,...C(e)})}const Vp=I("ZodXor",(t,e)=>{Ni.init(t,e),wE.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Ea(t,n,r,s),t.options=e.options});function BT(t,e){return new Vp({type:"union",options:t,inclusive:!1,...C(e)})}const Mp=I("ZodDiscriminatedUnion",(t,e)=>{Ni.init(t,e),TE.init(t,e)});function ZT(t,e,n){return new Mp({type:"union",options:e,discriminator:t,...C(n)})}const xp=I("ZodIntersection",(t,e)=>{IE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Xf(t,n,r,s)});function zp(t,e){return new xp({type:"intersection",left:t,right:e})}const Lp=I("ZodTuple",(t,e)=>{tf.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>ep(t,n,r,s),t.rest=n=>t.clone({...t._zod.def,rest:n})});function Fp(t,e,n){const r=e instanceof j,s=r?n:e,i=r?e:null;return new Lp({type:"tuple",items:t,rest:i,...C(s)})}const Oi=I("ZodRecord",(t,e)=>{AE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>tp(t,n,r,s),t.keyType=e.keyType,t.valueType=e.valueType});function $p(t,e,n){return new Oi({type:"record",keyType:t,valueType:e,...C(n)})}function qT(t,e,n){const r=lt(t);return r._zod.values=void 0,new Oi({type:"record",keyType:r,valueType:e,...C(n)})}function GT(t,e,n){return new Oi({type:"record",keyType:t,valueType:e,mode:"loose",...C(n)})}const Up=I("ZodMap",(t,e)=>{bE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Kf(t,n),t.keyType=e.keyType,t.valueType=e.valueType,t.min=(...n)=>t.check(Or(...n)),t.nonempty=n=>t.check(Or(1,n)),t.max=(...n)=>t.check(va(...n)),t.size=(...n)=>t.check(bf(...n))});function WT(t,e,n){return new Up({type:"map",keyType:t,valueType:e,...C(n)})}const jp=I("ZodSet",(t,e)=>{SE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Jf(t,n),t.min=(...n)=>t.check(Or(...n)),t.nonempty=n=>t.check(Or(1,n)),t.max=(...n)=>t.check(va(...n)),t.size=(...n)=>t.check(bf(...n))});function HT(t,e){return new jp({type:"set",valueType:t,...C(e)})}const Dr=I("ZodEnum",(t,e)=>{RE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(r,s,i)=>$f(t,r,s),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(r,s)=>{const i={};for(const o of r)if(n.has(o))i[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new Dr({...e,checks:[],...C(s),entries:i})},t.exclude=(r,s)=>{const i={...e.entries};for(const o of r)if(n.has(o))delete i[o];else throw new Error(`Key ${o} not found in enum`);return new Dr({...e,checks:[],...C(s),entries:i})}});function Di(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new Dr({type:"enum",entries:n,...C(e)})}function KT(t,e){return new Dr({type:"enum",entries:t,...C(e)})}const Bp=I("ZodLiteral",(t,e)=>{PE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Uf(t,n,r),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function JT(t,e){return new Bp({type:"literal",values:Array.isArray(t)?t:[t],...C(e)})}const Zp=I("ZodFile",(t,e)=>{kE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Zf(t,n,r),t.min=(n,r)=>t.check(Or(n,r)),t.max=(n,r)=>t.check(va(n,r)),t.mime=(n,r)=>t.check(bw(Array.isArray(n)?n:[n],r))});function QT(t){return Ow(Zp,t)}const qp=I("ZodTransform",(t,e)=>{CE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Hf(t,n),t._zod.parse=(n,r)=>{if(r.direction==="backward")throw new da(t.constructor.name);n.addIssue=i=>{if(typeof i=="string")n.issues.push(Mn(i,n.value,e));else{const o=i;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(Mn(o))}};const s=e.transform(n.value,n);return s instanceof Promise?s.then(i=>(n.value=i,n)):(n.value=s,n)}});function Ga(t){return new qp({type:"transform",transform:t})}const Wa=I("ZodOptional",(t,e)=>{nf.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>wa(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function Js(t){return new Wa({type:"optional",innerType:t})}const Gp=I("ZodExactOptional",(t,e)=>{NE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>wa(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function Wp(t){return new Gp({type:"optional",innerType:t})}const Hp=I("ZodNullable",(t,e)=>{OE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>np(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function Qs(t){return new Hp({type:"nullable",innerType:t})}function YT(t){return Js(Qs(t))}const Kp=I("ZodDefault",(t,e)=>{DE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>sp(t,n,r,s),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function Jp(t,e){return new Kp({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():yi(e)}})}const Qp=I("ZodPrefault",(t,e)=>{VE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>ip(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function Yp(t,e){return new Qp({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():yi(e)}})}const Ha=I("ZodNonOptional",(t,e)=>{ME.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>rp(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function Xp(t,e){return new Ha({type:"nonoptional",innerType:t,...C(e)})}const em=I("ZodSuccess",(t,e)=>{xE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>qf(t,n,r),t.unwrap=()=>t._zod.def.innerType});function XT(t){return new em({type:"success",innerType:t})}const tm=I("ZodCatch",(t,e)=>{zE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>op(t,n,r,s),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function nm(t,e){return new tm({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const rm=I("ZodNaN",(t,e)=>{LE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>jf(t,n)});function eI(t){return yw(rm,t)}const Ka=I("ZodPipe",(t,e)=>{FE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>ap(t,n,r,s),t.in=e.in,t.out=e.out});function Ys(t,e){return new Ka({type:"pipe",in:t,out:e})}const Ja=I("ZodCodec",(t,e)=>{Ka.init(t,e),rf.init(t,e)});function tI(t,e,n){return new Ja({type:"pipe",in:t,out:e,transform:n.decode,reverseTransform:n.encode})}const sm=I("ZodReadonly",(t,e)=>{$E.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>cp(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function im(t){return new sm({type:"readonly",innerType:t})}const om=I("ZodTemplateLiteral",(t,e)=>{UE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Bf(t,n,r)});function nI(t,e){return new om({type:"template_literal",parts:t,...C(e)})}const am=I("ZodLazy",(t,e)=>{ZE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>lp(t,n,r,s),t.unwrap=()=>t._zod.def.getter()});function cm(t){return new am({type:"lazy",getter:t})}const um=I("ZodPromise",(t,e)=>{BE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>up(t,n,r,s),t.unwrap=()=>t._zod.def.innerType});function rI(t){return new um({type:"promise",innerType:t})}const lm=I("ZodFunction",(t,e)=>{jE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Wf(t,n)});function ll(t){return new lm({type:"function",input:Array.isArray(t?.input)?Fp(t?.input):t?.input??ki(zn()),output:t?.output??zn()})}const Vi=I("ZodCustom",(t,e)=>{qE.init(t,e),B.init(t,e),t._zod.processJSONSchema=(n,r,s)=>Gf(t,n)});function sI(t){const e=new le({check:"custom"});return e._zod.check=t,e}function iI(t,e){return Dw(Vi,t??(()=>!0),e)}function hm(t,e={}){return Vw(Vi,t,e)}function dm(t){return Mw(t)}const oI=zw,aI=Lw;function cI(t,e={}){const n=new Vi({type:"custom",check:"custom",fn:r=>r instanceof t,abort:!0,...C(e)});return n._zod.bag.Class=t,n._zod.check=r=>{r.value instanceof t||r.issues.push({code:"invalid_type",expected:t.name,input:r.value,inst:n,path:[...n._zod.def.path??[]]})},n}const uI=(...t)=>Fw({Codec:Ja,Boolean:Ua,String:Ia},...t);function lI(t){const e=cm(()=>qa([Le(t),wp(),Tp(),Sp(),ki(e),$p(Le(),e)]));return e}function hI(t,e){return Ys(Ga(t),e)}const kC=Object.freeze(Object.defineProperty({__proto__:null,ZodAny:Rp,ZodArray:Op,ZodBase64:xa,ZodBase64URL:za,ZodBigInt:ja,ZodBigIntFormat:Ba,ZodBoolean:Ua,ZodCIDRv4:Va,ZodCIDRv6:Ma,ZodCUID:Ra,ZodCUID2:Pa,ZodCatch:tm,ZodCodec:Ja,ZodCustom:Vi,ZodCustomStringFormat:Wr,ZodDate:Np,ZodDefault:Kp,ZodDiscriminatedUnion:Mp,ZodE164:La,ZodEmail:Aa,ZodEmoji:ba,ZodEnum:Dr,ZodExactOptional:Gp,ZodFile:Zp,ZodFunction:lm,ZodGUID:Ks,ZodIPv4:Oa,ZodIPv6:Da,ZodIntersection:xp,ZodJWT:Fa,ZodKSUID:Na,ZodLazy:am,ZodLiteral:Bp,ZodMAC:Ep,ZodMap:Up,ZodNaN:rm,ZodNanoID:Sa,ZodNever:kp,ZodNonOptional:Ha,ZodNull:bp,ZodNullable:Hp,ZodNumber:$a,ZodNumberFormat:Gn,ZodObject:Ci,ZodOptional:Wa,ZodPipe:Ka,ZodPrefault:Qp,ZodPromise:um,ZodReadonly:sm,ZodRecord:Oi,ZodSet:jp,ZodString:Ia,ZodStringFormat:oe,ZodSuccess:em,ZodSymbol:Ip,ZodTemplateLiteral:om,ZodTransform:qp,ZodTuple:Lp,ZodType:B,ZodULID:ka,ZodURL:Pi,ZodUUID:dt,ZodUndefined:Ap,ZodUnion:Ni,ZodUnknown:Pp,ZodVoid:Cp,ZodXID:Ca,ZodXor:Vp,_ZodString:Ta,_default:Jp,_function:ll,any:zT,array:ki,base64:ET,base64url:wT,bigint:OT,boolean:Tp,catch:nm,check:sI,cidrv4:yT,cidrv6:vT,codec:tI,cuid:lT,cuid2:hT,custom:iI,date:FT,describe:oI,discriminatedUnion:ZT,e164:TT,email:eT,emoji:cT,enum:Di,exactOptional:Wp,file:QT,float32:PT,float64:kT,function:ll,guid:tT,hash:RT,hex:ST,hostname:bT,httpUrl:aT,instanceof:cI,int:$o,int32:CT,int64:DT,intersection:zp,ipv4:mT,ipv6:_T,json:lI,jwt:IT,keyof:$T,ksuid:pT,lazy:cm,literal:JT,looseObject:jT,looseRecord:GT,mac:gT,map:WT,meta:aI,nan:eI,nanoid:uT,nativeEnum:KT,never:Za,nonoptional:Xp,null:Sp,nullable:Qs,nullish:YT,number:wp,object:Dp,optional:Js,partialRecord:qT,pipe:Ys,prefault:Yp,preprocess:hI,promise:rI,readonly:im,record:$p,refine:hm,set:HT,strictObject:UT,string:Le,stringFormat:AT,stringbool:uI,success:XT,superRefine:dm,symbol:MT,templateLiteral:nI,transform:Ga,tuple:Fp,uint32:NT,uint64:VT,ulid:dT,undefined:xT,union:qa,unknown:zn,url:oT,uuid:nT,uuidv4:rT,uuidv6:sT,uuidv7:iT,void:LT,xid:fT,xor:BT},Symbol.toStringTag,{value:"Module"})),dI={BASE_URL:"./",DEV:!1,MODE:"production",PROD:!0,SSR:!1,STORYBOOK:"true",VITE_FIREBASE_API_KEY:"xxx",VITE_FIREBASE_AUTH_DOMAIN:"http://localhost:9099",VITE_FIREBASE_PROJECT_ID:"savings-test",VITE_FIRESTORE_DATABASE_ID:"savings-test",VITE_FIRESTORE_EMULATOR_HOST:"localhost:8080"};function fI(){const t="production",e=Dp({MODE:Di(["development","production","test"]),FIREBASE_API_KEY:Le().default("xxx"),FIREBASE_AUTH_DOMAIN:Le().default("http://localhost:9099"),FIREBASE_PROJECT_ID:Le(),FIREBASE_STORAGE_BUCKET:Le().optional(),FIREBASE_MESSAGING_SENDER_ID:Le().optional(),FIREBASE_APP_ID:Le().optional(),FIREBASE_MEASUREMENT_ID:Le().optional(),FIRESTORE_DATABASE_ID:Le().default("(default)"),FIRESTORE_EMULATOR_HOST:Le().default("localhost:8080")}),n=Object.entries(dI).reduce((s,i)=>{const[o,c]=i;return o.startsWith("VITE_")&&(s[o.replace("VITE_","")]=c),s},{}),r=e.safeParse({...n,MODE:t});if(!r.success)throw new Error(`Invalid env provided.
The following variables are missing or invalid:
${Object.entries(r.error.flatten().fieldErrors).map(([s,i])=>`- ${s}: ${i}`).join(`
`)}
`);return r.data}const Be=fI(),pI={apiKey:Be.FIREBASE_API_KEY,authDomain:Be.FIREBASE_AUTH_DOMAIN,projectId:Be.FIREBASE_PROJECT_ID,storageBucket:Be.FIREBASE_STORAGE_BUCKET,messagingSenderId:Be.FIREBASE_MESSAGING_SENDER_ID,appId:Be.FIREBASE_APP_ID,measurementId:Be.FIREBASE_MEASUREMENT_ID},fm=Lh.createContext(null),mI=()=>{};var hl={};const pm=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gI=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],c=t[n++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},mm={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,l=s+2<t.length,h=l?t[s+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let _=(c&15)<<2|h>>6,b=h&63;l||(b=64,o||(_=64)),r.push(n[f],n[m],n[_],n[b])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(pm(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gI(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],c=s<t.length?n[t.charAt(s)]:0;++s;const h=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||c==null||h==null||m==null)throw new _I;const _=i<<2|c>>4;if(r.push(_),h!==64){const b=c<<4&240|h>>2;if(r.push(b),m!==64){const N=h<<6&192|m;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class _I extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yI=function(t){const e=pm(t);return mm.encodeByteArray(e,!0)},Xs=function(t){return yI(t).replace(/\./g,"")},gm=function(t){try{return mm.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const EI=()=>vI().__FIREBASE_DEFAULTS__,wI=()=>{if(typeof process>"u"||typeof hl>"u")return;const t=hl.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},TI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&gm(t[1]);return e&&JSON.parse(e)},Mi=()=>{try{return mI()||EI()||wI()||TI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},_m=t=>Mi()?.emulatorHosts?.[t],II=t=>{const e=_m(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},ym=()=>Mi()?.config,vm=t=>Mi()?.[`_${t}`];class AI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function Wn(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Em(t){return(await fetch(t,{credentials:"include"})).ok}function bI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Xs(JSON.stringify(n)),Xs(JSON.stringify(o)),""].join(".")}const Ar={};function SI(){const t={prod:[],emulator:[]};for(const e of Object.keys(Ar))Ar[e]?t.emulator.push(e):t.prod.push(e);return t}function RI(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dl=!1;function wm(t,e){if(typeof window>"u"||typeof document>"u"||!Wn(window.location.host)||Ar[t]===e||Ar[t]||dl)return;Ar[t]=e;function n(_){return`__firebase__banner__${_}`}const r="__firebase__banner",i=SI().prod.length>0;function o(){const _=document.getElementById(r);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function l(_,b){_.setAttribute("width","24"),_.setAttribute("id",b),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{dl=!0,o()},_}function f(_,b){_.setAttribute("id",b),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){const _=RI(r),b=n("text"),N=document.getElementById(b)||document.createElement("span"),O=n("learnmore"),M=document.getElementById(O)||document.createElement("a"),W=n("preprendIcon"),Q=document.getElementById(W)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const G=_.element;c(G),f(M,O);const X=h();l(Q,W),G.append(Q,N,M,X),document.body.appendChild(G)}i?(N.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function ke(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ke())}function kI(){const t=Mi()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function CI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function NI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function DI(){const t=ke();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VI(){return!kI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function MI(){try{return typeof indexedDB=="object"}catch{return!1}}function xI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(n){e(n)}})}const zI="FirebaseError";class wt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=zI,Object.setPrototypeOf(this,wt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Hr.prototype.create)}}class Hr{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?LI(i,r):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new wt(s,c,r)}}function LI(t,e){return t.replace(FI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const FI=/\{\$([^}]+)}/g;function $I(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function cn(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(fl(i)&&fl(o)){if(!cn(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function fl(t){return t!==null&&typeof t=="object"}function Kr(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function UI(t,e){const n=new jI(t,e);return n.subscribe.bind(n)}class jI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");BI(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Io),s.error===void 0&&(s.error=Io),s.complete===void 0&&(s.complete=Io);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Io(){}function Me(t){return t&&t._delegate?t._delegate:t}class un{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const tn="[DEFAULT]";class ZI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new AI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(GI(e))try{this.getOrInitializeService({instanceIdentifier:tn})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=tn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=tn){return this.instances.has(e)}getOptions(e=tn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);r===c&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:qI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=tn){return this.component?this.component.multipleInstances?e:tn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function qI(t){return t===tn?void 0:t}function GI(t){return t.instantiationMode==="EAGER"}class WI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ZI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var H;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(H||(H={}));const HI={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},KI=H.INFO,JI={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},QI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=JI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Qa{constructor(e){this.name=e,this._logLevel=KI,this._logHandler=QI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?HI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}}const YI=(t,e)=>e.some(n=>t instanceof n);let pl,ml;function XI(){return pl||(pl=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eA(){return ml||(ml=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tm=new WeakMap,Uo=new WeakMap,Im=new WeakMap,Ao=new WeakMap,Ya=new WeakMap;function tA(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(xt(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Tm.set(n,t)}).catch(()=>{}),Ya.set(e,t),e}function nA(t){if(Uo.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Uo.set(t,e)}let jo={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Uo.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Im.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xt(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function rA(t){jo=t(jo)}function sA(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(bo(this),e,...n);return Im.set(r,e.sort?e.sort():[e]),xt(r)}:eA().includes(t)?function(...e){return t.apply(bo(this),e),xt(Tm.get(this))}:function(...e){return xt(t.apply(bo(this),e))}}function iA(t){return typeof t=="function"?sA(t):(t instanceof IDBTransaction&&nA(t),YI(t,XI())?new Proxy(t,jo):t)}function xt(t){if(t instanceof IDBRequest)return tA(t);if(Ao.has(t))return Ao.get(t);const e=iA(t);return e!==t&&(Ao.set(t,e),Ya.set(e,t)),e}const bo=t=>Ya.get(t);function oA(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=xt(o);return r&&o.addEventListener("upgradeneeded",l=>{r(xt(o.result),l.oldVersion,l.newVersion,xt(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const aA=["get","getKey","getAll","getAllKeys","count"],cA=["put","add","delete","clear"],So=new Map;function gl(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(So.get(e))return So.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=cA.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||aA.includes(n)))return;const i=async function(o,...c){const l=this.transaction(o,s?"readwrite":"readonly");let h=l.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),s&&l.done]))[0]};return So.set(e,i),i}rA(t=>({...t,get:(e,n,r)=>gl(e,n)||t.get(e,n,r),has:(e,n)=>!!gl(e,n)||t.has(e,n)}));class uA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(lA(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function lA(t){return t.getComponent()?.type==="VERSION"}const Bo="@firebase/app",_l="0.14.8";const _t=new Qa("@firebase/app"),hA="@firebase/app-compat",dA="@firebase/analytics-compat",fA="@firebase/analytics",pA="@firebase/app-check-compat",mA="@firebase/app-check",gA="@firebase/auth",_A="@firebase/auth-compat",yA="@firebase/database",vA="@firebase/data-connect",EA="@firebase/database-compat",wA="@firebase/functions",TA="@firebase/functions-compat",IA="@firebase/installations",AA="@firebase/installations-compat",bA="@firebase/messaging",SA="@firebase/messaging-compat",RA="@firebase/performance",PA="@firebase/performance-compat",kA="@firebase/remote-config",CA="@firebase/remote-config-compat",NA="@firebase/storage",OA="@firebase/storage-compat",DA="@firebase/firestore",VA="@firebase/ai",MA="@firebase/firestore-compat",xA="firebase",zA="12.9.0";const Zo="[DEFAULT]",LA={[Bo]:"fire-core",[hA]:"fire-core-compat",[fA]:"fire-analytics",[dA]:"fire-analytics-compat",[mA]:"fire-app-check",[pA]:"fire-app-check-compat",[gA]:"fire-auth",[_A]:"fire-auth-compat",[yA]:"fire-rtdb",[vA]:"fire-data-connect",[EA]:"fire-rtdb-compat",[wA]:"fire-fn",[TA]:"fire-fn-compat",[IA]:"fire-iid",[AA]:"fire-iid-compat",[bA]:"fire-fcm",[SA]:"fire-fcm-compat",[RA]:"fire-perf",[PA]:"fire-perf-compat",[kA]:"fire-rc",[CA]:"fire-rc-compat",[NA]:"fire-gcs",[OA]:"fire-gcs-compat",[DA]:"fire-fst",[MA]:"fire-fst-compat",[VA]:"fire-vertex","fire-js":"fire-js",[xA]:"fire-js-all"};const ei=new Map,FA=new Map,qo=new Map;function yl(t,e){try{t.container.addComponent(e)}catch(n){_t.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ln(t){const e=t.name;if(qo.has(e))return _t.debug(`There were multiple attempts to register component ${e}.`),!1;qo.set(e,t);for(const n of ei.values())yl(n,t);for(const n of FA.values())yl(n,t);return!0}function Xa(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ze(t){return t==null?!1:t.settings!==void 0}const $A={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zt=new Hr("app","Firebase",$A);class UA{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new un("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zt.create("app-deleted",{appName:this._name})}}const Hn=zA;function Am(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Zo,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw zt.create("bad-app-name",{appName:String(s)});if(n||(n=ym()),!n)throw zt.create("no-options");const i=ei.get(s);if(i){if(cn(n,i.options)&&cn(r,i.config))return i;throw zt.create("duplicate-app",{appName:s})}const o=new WI(s);for(const l of qo.values())o.addComponent(l);const c=new UA(n,r,o);return ei.set(s,c),c}function bm(t=Zo){const e=ei.get(t);if(!e&&t===Zo&&ym())return Am();if(!e)throw zt.create("no-app",{appName:t});return e}function Lt(t,e,n){let r=LA[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_t.warn(o.join(" "));return}Ln(new un(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}const jA="firebase-heartbeat-database",BA=1,Vr="firebase-heartbeat-store";let Ro=null;function Sm(){return Ro||(Ro=oA(jA,BA,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Vr)}catch(n){console.warn(n)}}}}).catch(t=>{throw zt.create("idb-open",{originalErrorMessage:t.message})})),Ro}async function ZA(t){try{const n=(await Sm()).transaction(Vr),r=await n.objectStore(Vr).get(Rm(t));return await n.done,r}catch(e){if(e instanceof wt)_t.warn(e.message);else{const n=zt.create("idb-get",{originalErrorMessage:e?.message});_t.warn(n.message)}}}async function vl(t,e){try{const r=(await Sm()).transaction(Vr,"readwrite");await r.objectStore(Vr).put(e,Rm(t)),await r.done}catch(n){if(n instanceof wt)_t.warn(n.message);else{const r=zt.create("idb-set",{originalErrorMessage:n?.message});_t.warn(r.message)}}}function Rm(t){return`${t.name}!${t.options.appId}`}const qA=1024,GA=30;class WA{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new KA(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=El();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats.length>GA){const s=JA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){_t.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=El(),{heartbeatsToSend:n,unsentEntries:r}=HA(this._heartbeatsCache.heartbeats),s=Xs(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return _t.warn(e),""}}}function El(){return new Date().toISOString().substring(0,10)}function HA(t,e=qA){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),wl(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),wl(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class KA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return MI()?xI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await ZA(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return vl(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function wl(t){return Xs(JSON.stringify({version:2,heartbeats:t})).length}function JA(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}function QA(t){Ln(new un("platform-logger",e=>new uA(e),"PRIVATE")),Ln(new un("heartbeat",e=>new WA(e),"PRIVATE")),Lt(Bo,_l,t),Lt(Bo,_l,"esm2020"),Lt("fire-js","")}QA("");var YA="firebase",XA="12.9.0";Lt(YA,XA,"app");function Pm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const eb=Pm,km=new Hr("auth","Firebase",Pm());const ti=new Qa("@firebase/auth");function tb(t,...e){ti.logLevel<=H.WARN&&ti.warn(`Auth (${Hn}): ${t}`,...e)}function Ns(t,...e){ti.logLevel<=H.ERROR&&ti.error(`Auth (${Hn}): ${t}`,...e)}function at(t,...e){throw tc(t,...e)}function He(t,...e){return tc(t,...e)}function ec(t,e,n){const r={...eb(),[e]:n};return new Hr("auth","Firebase",r).create(e,{appName:t.name})}function on(t){return ec(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nb(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&at(t,"argument-error"),ec(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function tc(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return km.create(t,...e)}function F(t,e,...n){if(!t)throw tc(e,...n)}function ft(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ns(e),new Error(e)}function yt(t,e){t||ft(e)}function Go(){return typeof self<"u"&&self.location?.href||""}function rb(){return Tl()==="http:"||Tl()==="https:"}function Tl(){return typeof self<"u"&&self.location?.protocol||null}function sb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rb()||NI()||"connection"in navigator)?navigator.onLine:!0}function ib(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class Jr{constructor(e,n){this.shortDelay=e,this.longDelay=n,yt(n>e,"Short delay should be less than long delay!"),this.isMobile=PI()||OI()}get(){return sb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function nc(t,e){yt(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class Cm{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ft("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ft("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ft("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ob={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const ab=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cb=new Jr(3e4,6e4);function rc(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Kn(t,e,n,r,s={}){return Nm(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const c=Kr({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:l,...i};return CI()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Wn(t.emulatorConfig.host)&&(h.credentials="include"),Cm.fetch()(await Om(t,t.config.apiHost,n,c),h)})}async function Nm(t,e,n){t._canInitEmulator=!1;const r={...ob,...e};try{const s=new lb(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw As(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw As(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw As(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw As(t,"user-disabled",o);const f=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw ec(t,f,h);at(t,f)}}catch(s){if(s instanceof wt)throw s;at(t,"network-request-failed",{message:String(s)})}}async function ub(t,e,n,r,s={}){const i=await Kn(t,e,n,r,s);return"mfaPendingCredential"in i&&at(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Om(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?nc(t.config,s):`${t.config.apiScheme}://${s}`;return ab.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}class lb{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(He(this.auth,"network-request-failed")),cb.get())})}}function As(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=He(t,e,r);return s.customData._tokenResponse=n,s}async function hb(t,e){return Kn(t,"POST","/v1/accounts:delete",e)}async function ni(t,e){return Kn(t,"POST","/v1/accounts:lookup",e)}function br(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function db(t,e=!1){const n=Me(t),r=await n.getIdToken(e),s=sc(r);F(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:br(Po(s.auth_time)),issuedAtTime:br(Po(s.iat)),expirationTime:br(Po(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}function Po(t){return Number(t)*1e3}function sc(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Ns("JWT malformed, contained fewer than 3 sections"),null;try{const s=gm(n);return s?JSON.parse(s):(Ns("Failed to decode base64 JWT payload"),null)}catch(s){return Ns("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Il(t){const e=sc(t);return F(e,"internal-error"),F(typeof e.exp<"u","internal-error"),F(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Mr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof wt&&fb(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function fb({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class pb{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Wo{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=br(this.lastLoginAt),this.creationTime=br(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ri(t){const e=t.auth,n=await t.getIdToken(),r=await Mr(t,ni(e,{idToken:n}));F(r?.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=s.providerUserInfo?.length?Dm(s.providerUserInfo):[],o=gb(t.providerData,i),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!o?.length,h=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Wo(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function mb(t){const e=Me(t);await ri(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gb(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Dm(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function _b(t,e){const n=await Nm(t,{},async()=>{const r=Kr({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Om(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:r};return t.emulatorConfig&&Wn(t.emulatorConfig.host)&&(l.credentials="include"),Cm.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yb(t,e){return Kn(t,"POST","/v2/accounts:revokeToken",rc(t,e))}class Rn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){F(e.idToken,"internal-error"),F(typeof e.idToken<"u","internal-error"),F(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Il(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){F(e.length!==0,"internal-error");const n=Il(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(F(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await _b(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Rn;return r&&(F(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(F(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(F(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Rn,this.toJSON())}_performRefresh(){return ft("not implemented")}}function Pt(t,e){F(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ge{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new pb(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Wo(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Mr(this,this.stsTokenManager.getToken(this.auth,e));return F(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return db(this,e)}reload(){return mb(this)}_assign(e){this!==e&&(F(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ge({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){F(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await ri(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ze(this.auth.app))return Promise.reject(on(this.auth));const e=await this.getIdToken();return await Mr(this,hb(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,l=n._redirectEventId??void 0,h=n.createdAt??void 0,f=n.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:b,providerData:N,stsTokenManager:O}=n;F(m&&O,e,"internal-error");const M=Rn.fromJSON(this.name,O);F(typeof m=="string",e,"internal-error"),Pt(r,e.name),Pt(s,e.name),F(typeof _=="boolean",e,"internal-error"),F(typeof b=="boolean",e,"internal-error"),Pt(i,e.name),Pt(o,e.name),Pt(c,e.name),Pt(l,e.name),Pt(h,e.name),Pt(f,e.name);const W=new Ge({uid:m,auth:e,email:s,emailVerified:_,displayName:r,isAnonymous:b,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:M,createdAt:h,lastLoginAt:f});return N&&Array.isArray(N)&&(W.providerData=N.map(Q=>({...Q}))),l&&(W._redirectEventId=l),W}static async _fromIdTokenResponse(e,n,r=!1){const s=new Rn;s.updateFromServerResponse(n);const i=new Ge({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await ri(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];F(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Dm(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!i?.length,c=new Rn;c.updateFromIdToken(r);const l=new Ge({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Wo(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!i?.length};return Object.assign(l,h),l}}const Al=new Map;function pt(t){yt(t instanceof Function,"Expected a class definition");let e=Al.get(t);return e?(yt(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Al.set(t,e),e)}class Vm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Vm.type="NONE";const bl=Vm;function Os(t,e,n){return`firebase:${t}:${e}:${n}`}class Pn{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Os(this.userKey,s.apiKey,i),this.fullPersistenceKey=Os("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ni(this.auth,{idToken:e}).catch(()=>{});return n?Ge._fromGetAccountInfoResponse(this.auth,n,e):null}return Ge._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Pn(pt(bl),e,r);const s=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=s[0]||pt(bl);const o=Os(r,e.config.apiKey,e.name);let c=null;for(const h of n)try{const f=await h._get(o);if(f){let m;if(typeof f=="string"){const _=await ni(e,{idToken:f}).catch(()=>{});if(!_)break;m=await Ge._fromGetAccountInfoResponse(e,_,f)}else m=Ge._fromJSON(e,f);h!==i&&(c=m),i=h;break}}catch{}const l=s.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Pn(i,e,r):(i=l[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new Pn(i,e,r))}}function Sl(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Lm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if($m(e))return"Blackberry";if(Um(e))return"Webos";if(xm(e))return"Safari";if((e.includes("chrome/")||zm(e))&&!e.includes("edge/"))return"Chrome";if(Fm(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if(r?.length===2)return r[1]}return"Other"}function Mm(t=ke()){return/firefox\//i.test(t)}function xm(t=ke()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function zm(t=ke()){return/crios\//i.test(t)}function Lm(t=ke()){return/iemobile/i.test(t)}function Fm(t=ke()){return/android/i.test(t)}function $m(t=ke()){return/blackberry/i.test(t)}function Um(t=ke()){return/webos/i.test(t)}function ic(t=ke()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vb(t=ke()){return ic(t)&&!!window.navigator?.standalone}function Eb(){return DI()&&document.documentMode===10}function jm(t=ke()){return ic(t)||Fm(t)||Um(t)||$m(t)||/windows phone/i.test(t)||Lm(t)}function Bm(t,e=[]){let n;switch(t){case"Browser":n=Sl(ke());break;case"Worker":n=`${Sl(ke())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Hn}/${r}`}class wb{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,c)=>{try{const l=e(i);o(l)}catch(l){c(l)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function Tb(t,e={}){return Kn(t,"GET","/v2/passwordPolicy",rc(t,e))}const Ib=6;class Ab{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Ib,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class bb{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Rl(this),this.idTokenSubscription=new Rl(this),this.beforeStateQueue=new wb(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=km,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=pt(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Pn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ni(this,{idToken:e}),r=await Ge._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ze(this.app)){const i=this.app.settings.authIdToken;return i?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(i).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const i=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!i||i===o)&&c?.user&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(i){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return F(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await ri(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ib()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ze(this.app))return Promise.reject(on(this));const n=e?Me(e):null;return n&&F(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&F(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ze(this.app)?Promise.reject(on(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ze(this.app)?Promise.reject(on(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Tb(this),n=new Ab(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Hr("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await yb(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&pt(e)||this._popupRedirectResolver;F(n,this,"argument-error"),this.redirectPersistenceManager=await Pn.create(this,[pt(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(F(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return F(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(Ze(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&tb(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Qr(t){return Me(t)}class Rl{constructor(e){this.auth=e,this.observer=null,this.addObserver=UI(n=>this.observer=n)}get next(){return F(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let oc={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Sb(t){oc=t}function Rb(t){return oc.loadJS(t)}function Pb(){return oc.gapiScript}function kb(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function Cb(t,e){const n=Xa(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(cn(i,e??{}))return s;at(s,"already-initialized")}return n.initialize({options:e})}function Nb(t,e){const n=e?.persistence||[],r=(Array.isArray(n)?n:[n]).map(pt);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e?.popupRedirectResolver)}function Zm(t,e,n){const r=Qr(t);F(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!n?.disableWarnings,i=qm(e),{host:o,port:c}=Ob(e),l=c===null?"":`:${c}`,h={url:`${i}//${o}${l}/`},f=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){F(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),F(cn(h,r.config.emulator)&&cn(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Wn(o)?(Em(`${i}//${o}${l}`),wm("Auth",!0)):s||Db()}function qm(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Ob(t){const e=qm(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Pl(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Pl(o)}}}function Pl(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Db(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Gm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ft("not implemented")}_getIdTokenResponse(e){return ft("not implemented")}_linkToIdToken(e,n){return ft("not implemented")}_getReauthenticationResolver(e){return ft("not implemented")}}async function kn(t,e){return ub(t,"POST","/v1/accounts:signInWithIdp",rc(t,e))}const Vb="http://localhost";class ln extends Gm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ln(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):at("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new ln(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return kn(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,kn(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,kn(e,n)}buildRequest(){const e={requestUri:Vb,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Kr(n)}return e}}class ac{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Yr extends ac{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class kt extends Yr{constructor(){super("facebook.com")}static credential(e){return ln._fromParams({providerId:kt.PROVIDER_ID,signInMethod:kt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return kt.credentialFromTaggedObject(e)}static credentialFromError(e){return kt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return kt.credential(e.oauthAccessToken)}catch{return null}}}kt.FACEBOOK_SIGN_IN_METHOD="facebook.com";kt.PROVIDER_ID="facebook.com";class Ct extends Yr{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ln._fromParams({providerId:Ct.PROVIDER_ID,signInMethod:Ct.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ct.credentialFromTaggedObject(e)}static credentialFromError(e){return Ct.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ct.credential(n,r)}catch{return null}}}Ct.GOOGLE_SIGN_IN_METHOD="google.com";Ct.PROVIDER_ID="google.com";class Nt extends Yr{constructor(){super("github.com")}static credential(e){return ln._fromParams({providerId:Nt.PROVIDER_ID,signInMethod:Nt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Nt.credentialFromTaggedObject(e)}static credentialFromError(e){return Nt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Nt.credential(e.oauthAccessToken)}catch{return null}}}Nt.GITHUB_SIGN_IN_METHOD="github.com";Nt.PROVIDER_ID="github.com";class Ot extends Yr{constructor(){super("twitter.com")}static credential(e,n){return ln._fromParams({providerId:Ot.PROVIDER_ID,signInMethod:Ot.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ot.credentialFromTaggedObject(e)}static credentialFromError(e){return Ot.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ot.credential(n,r)}catch{return null}}}Ot.TWITTER_SIGN_IN_METHOD="twitter.com";Ot.PROVIDER_ID="twitter.com";class Fn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ge._fromIdTokenResponse(e,r,s),o=kl(r);return new Fn({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=kl(r);return new Fn({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function kl(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class si extends wt{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,si.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new si(e,n,r,s)}}function Wm(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?si._fromErrorAndOperation(t,i,e,r):i})}async function Mb(t,e,n=!1){const r=await Mr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fn._forOperation(t,"link",r)}async function xb(t,e,n=!1){const{auth:r}=t;if(Ze(r.app))return Promise.reject(on(r));const s="reauthenticate";try{const i=await Mr(t,Wm(r,s,e,t),n);F(i.idToken,r,"internal-error");const o=sc(i.idToken);F(o,r,"internal-error");const{sub:c}=o;return F(t.uid===c,r,"user-mismatch"),Fn._forOperation(t,s,i)}catch(i){throw i?.code==="auth/user-not-found"&&at(r,"user-mismatch"),i}}async function Hm(t,e,n=!1){if(Ze(t.app))return Promise.reject(on(t));const r="signIn",s=await Wm(t,r,e),i=await Fn._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function CC(t,e){return Hm(Qr(t),e)}function NC(t,e){return Me(t).setPersistence(e)}function zb(t,e,n,r){return Me(t).onIdTokenChanged(e,n,r)}function Lb(t,e,n){return Me(t).beforeAuthStateChanged(e,n)}function OC(t,e,n,r){return Me(t).onAuthStateChanged(e,n,r)}const ii="__sak";class Km{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(ii,"1"),this.storage.removeItem(ii),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Fb=1e3,$b=10;class Jm extends Km{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Eb()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$b):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Fb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Jm.type="LOCAL";const Ub=Jm;class Qm extends Km{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Qm.type="SESSION";const Ym=Qm;function jb(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class xi{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new xi(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!o?.size)return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const c=Array.from(o).map(async h=>h(n.origin,i)),l=await jb(c);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}xi.receivers=[];function cc(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}class Bb{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,l)=>{const h=cc("",20);s.port1.start();const f=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(_.data.response);break;default:clearTimeout(f),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function rt(){return window}function Zb(t){rt().location.href=t}function Xm(){return typeof rt().WorkerGlobalScope<"u"&&typeof rt().importScripts=="function"}async function qb(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Gb(){return navigator?.serviceWorker?.controller||null}function Wb(){return Xm()?self:null}const eg="firebaseLocalStorageDb",Hb=1,oi="firebaseLocalStorage",tg="fbase_key";class Xr{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function zi(t,e){return t.transaction([oi],e?"readwrite":"readonly").objectStore(oi)}function Kb(){const t=indexedDB.deleteDatabase(eg);return new Xr(t).toPromise()}function Ho(){const t=indexedDB.open(eg,Hb);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(oi,{keyPath:tg})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(oi)?e(r):(r.close(),await Kb(),e(await Ho()))})})}async function Cl(t,e,n){const r=zi(t,!0).put({[tg]:e,value:n});return new Xr(r).toPromise()}async function Jb(t,e){const n=zi(t,!1).get(e),r=await new Xr(n).toPromise();return r===void 0?null:r.value}function Nl(t,e){const n=zi(t,!0).delete(e);return new Xr(n).toPromise()}const Qb=800,Yb=3;class ng{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Ho(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Yb)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Xm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xi._getInstance(Wb()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qb(),!this.activeServiceWorker)return;this.sender=new Bb(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Gb()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ho();return await Cl(e,ii,"1"),await Nl(e,ii),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Cl(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Jb(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Nl(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=zi(s,!1).getAll();return new Xr(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Qb)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ng.type="LOCAL";const Xb=ng;new Jr(3e4,6e4);function rg(t,e){return e?pt(e):(F(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class uc extends Gm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return kn(e,this._buildIdpRequest())}_linkToIdToken(e,n){return kn(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return kn(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function eS(t){return Hm(t.auth,new uc(t),t.bypassAuthState)}function tS(t){const{auth:e,user:n}=t;return F(n,e,"internal-error"),xb(n,new uc(t),t.bypassAuthState)}async function nS(t){const{auth:e,user:n}=t;return F(n,e,"internal-error"),Mb(n,new uc(t),t.bypassAuthState)}class sg{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eS;case"linkViaPopup":case"linkViaRedirect":return nS;case"reauthViaPopup":case"reauthViaRedirect":return tS;default:at(this.auth,"internal-error")}}resolve(e){yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const rS=new Jr(2e3,1e4);async function DC(t,e,n){if(Ze(t.app))return Promise.reject(He(t,"operation-not-supported-in-this-environment"));const r=Qr(t);nb(t,e,ac);const s=rg(r,n);return new rn(r,"signInViaPopup",e,s).executeNotNull()}class rn extends sg{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,rn.currentPopupAction&&rn.currentPopupAction.cancel(),rn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return F(e,this.auth,"internal-error"),e}async onExecution(){yt(this.filter.length===1,"Popup operations only handle one event");const e=cc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(He(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(He(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,rn.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(He(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,rS.get())};e()}}rn.currentPopupAction=null;const sS="pendingRedirect",Ds=new Map;class iS extends sg{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ds.get(this.auth._key());if(!e){try{const r=await oS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ds.set(this.auth._key(),e)}return this.bypassAuthState||Ds.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oS(t,e){const n=uS(e),r=cS(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function aS(t,e){Ds.set(t._key(),e)}function cS(t){return pt(t._redirectPersistence)}function uS(t){return Os(sS,t.config.apiKey,t.name)}async function lS(t,e,n=!1){if(Ze(t.app))return Promise.reject(on(t));const r=Qr(t),s=rg(r,e),o=await new iS(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}const hS=600*1e3;class dS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fS(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!ig(e)){const r=e.error.code?.split("auth/")[1]||"internal-error";n.onError(He(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=hS&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ol(e))}saveEventToCache(e){this.cachedEventUids.add(Ol(e)),this.lastProcessedEventTime=Date.now()}}function Ol(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ig({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function fS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ig(t);default:return!1}}async function pS(t,e={}){return Kn(t,"GET","/v1/projects",e)}const mS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gS=/^https?/;async function _S(t){if(t.config.emulator)return;const{authorizedDomains:e}=await pS(t);for(const n of e)try{if(yS(n))return}catch{}at(t,"unauthorized-domain")}function yS(t){const e=Go(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!gS.test(n))return!1;if(mS.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const vS=new Jr(3e4,6e4);function Dl(){const t=rt().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function ES(t){return new Promise((e,n)=>{function r(){Dl(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dl(),n(He(t,"network-request-failed"))},timeout:vS.get()})}if(rt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rt().gapi?.load)r();else{const s=kb("iframefcb");return rt()[s]=()=>{gapi.load?r():n(He(t,"network-request-failed"))},Rb(`${Pb()}?onload=${s}`).catch(i=>n(i))}}).catch(e=>{throw Vs=null,e})}let Vs=null;function wS(t){return Vs=Vs||ES(t),Vs}const TS=new Jr(5e3,15e3),IS="__/auth/iframe",AS="emulator/auth/iframe",bS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RS(t){const e=t.config;F(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?nc(e,AS):`https://${t.config.authDomain}/${IS}`,r={apiKey:e.apiKey,appName:t.name,v:Hn},s=SS.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Kr(r).slice(1)}`}async function PS(t){const e=await wS(t),n=rt().gapi;return F(n,t,"internal-error"),e.open({where:document.body,url:RS(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:bS,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=He(t,"network-request-failed"),c=rt().setTimeout(()=>{i(o)},TS.get());function l(){rt().clearTimeout(c),s(r)}r.ping(l).then(l,()=>{i(o)})}))}const kS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CS=500,NS=600,OS="_blank",DS="http://localhost";class Vl{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function VS(t,e,n,r=CS,s=NS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const l={...kS,width:r.toString(),height:s.toString(),top:i,left:o},h=ke().toLowerCase();n&&(c=zm(h)?OS:n),Mm(h)&&(e=e||DS,l.scrollbars="yes");const f=Object.entries(l).reduce((_,[b,N])=>`${_}${b}=${N},`,"");if(vb(h)&&c!=="_self")return MS(e||"",c),new Vl(null);const m=window.open(e||"",c,f);F(m,t,"popup-blocked");try{m.focus()}catch{}return new Vl(m)}function MS(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}const xS="__/auth/handler",zS="emulator/auth/handler",LS=encodeURIComponent("fac");async function Ml(t,e,n,r,s,i){F(t.config.authDomain,t,"auth-domain-config-required"),F(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Hn,eventId:s};if(e instanceof ac){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",$I(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof Yr){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const l=await t._getAppCheckToken(),h=l?`#${LS}=${encodeURIComponent(l)}`:"";return`${FS(t)}?${Kr(c).slice(1)}${h}`}function FS({config:t}){return t.emulator?nc(t,zS):`https://${t.authDomain}/${xS}`}const ko="webStorageSupport";class $S{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ym,this._completeRedirectFn=lS,this._overrideRedirectResult=aS}async _openPopup(e,n,r,s){yt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const i=await Ml(e,n,r,Go(),s);return VS(e,i,cc())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Ml(e,n,r,Go(),s);return Zb(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(yt(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await PS(e),r=new dS(e);return n.register("authEvent",s=>(F(s?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ko,{type:ko},s=>{const i=s?.[0]?.[ko];i!==void 0&&n(!!i),at(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=_S(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jm()||xm()||ic()}}const US=$S;var xl="@firebase/auth",zl="1.12.0";class jS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){F(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function BS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ZS(t){Ln(new un("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;F(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bm(t)},h=new bb(r,s,i,l);return Nb(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Ln(new un("auth-internal",e=>{const n=Qr(e.getProvider("auth").getImmediate());return(r=>new jS(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Lt(xl,zl,BS(t)),Lt(xl,zl,"esm2020")}const qS=300,GS=vm("authIdTokenMaxAge")||qS;let Ll=null;const WS=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>GS)return;const s=n?.token;Ll!==s&&(Ll=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function HS(t=bm()){const e=Xa(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Cb(t,{popupRedirectResolver:US,persistence:[Xb,Ub,Ym]}),r=vm("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=WS(i.toString());Lb(n,o,()=>o(n.currentUser)),zb(n,c=>o(c))}}const s=_m("auth");return s&&Zm(n,`http://${s}`),n}function KS(){return document.getElementsByTagName("head")?.[0]??document}Sb({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=He("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",KS().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ZS("Browser");var Fl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Ft,og;(function(){var t;function e(w,g){function v(){}v.prototype=g.prototype,w.F=g.prototype,w.prototype=new v,w.prototype.constructor=w,w.D=function(T,E,S){for(var y=Array(arguments.length-2),De=2;De<arguments.length;De++)y[De-2]=arguments[De];return g.prototype[E].apply(T,y)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,g,v){v||(v=0);const T=Array(16);if(typeof g=="string")for(var E=0;E<16;++E)T[E]=g.charCodeAt(v++)|g.charCodeAt(v++)<<8|g.charCodeAt(v++)<<16|g.charCodeAt(v++)<<24;else for(E=0;E<16;++E)T[E]=g[v++]|g[v++]<<8|g[v++]<<16|g[v++]<<24;g=w.g[0],v=w.g[1],E=w.g[2];let S=w.g[3],y;y=g+(S^v&(E^S))+T[0]+3614090360&4294967295,g=v+(y<<7&4294967295|y>>>25),y=S+(E^g&(v^E))+T[1]+3905402710&4294967295,S=g+(y<<12&4294967295|y>>>20),y=E+(v^S&(g^v))+T[2]+606105819&4294967295,E=S+(y<<17&4294967295|y>>>15),y=v+(g^E&(S^g))+T[3]+3250441966&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(S^v&(E^S))+T[4]+4118548399&4294967295,g=v+(y<<7&4294967295|y>>>25),y=S+(E^g&(v^E))+T[5]+1200080426&4294967295,S=g+(y<<12&4294967295|y>>>20),y=E+(v^S&(g^v))+T[6]+2821735955&4294967295,E=S+(y<<17&4294967295|y>>>15),y=v+(g^E&(S^g))+T[7]+4249261313&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(S^v&(E^S))+T[8]+1770035416&4294967295,g=v+(y<<7&4294967295|y>>>25),y=S+(E^g&(v^E))+T[9]+2336552879&4294967295,S=g+(y<<12&4294967295|y>>>20),y=E+(v^S&(g^v))+T[10]+4294925233&4294967295,E=S+(y<<17&4294967295|y>>>15),y=v+(g^E&(S^g))+T[11]+2304563134&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(S^v&(E^S))+T[12]+1804603682&4294967295,g=v+(y<<7&4294967295|y>>>25),y=S+(E^g&(v^E))+T[13]+4254626195&4294967295,S=g+(y<<12&4294967295|y>>>20),y=E+(v^S&(g^v))+T[14]+2792965006&4294967295,E=S+(y<<17&4294967295|y>>>15),y=v+(g^E&(S^g))+T[15]+1236535329&4294967295,v=E+(y<<22&4294967295|y>>>10),y=g+(E^S&(v^E))+T[1]+4129170786&4294967295,g=v+(y<<5&4294967295|y>>>27),y=S+(v^E&(g^v))+T[6]+3225465664&4294967295,S=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(S^g))+T[11]+643717713&4294967295,E=S+(y<<14&4294967295|y>>>18),y=v+(S^g&(E^S))+T[0]+3921069994&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^S&(v^E))+T[5]+3593408605&4294967295,g=v+(y<<5&4294967295|y>>>27),y=S+(v^E&(g^v))+T[10]+38016083&4294967295,S=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(S^g))+T[15]+3634488961&4294967295,E=S+(y<<14&4294967295|y>>>18),y=v+(S^g&(E^S))+T[4]+3889429448&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^S&(v^E))+T[9]+568446438&4294967295,g=v+(y<<5&4294967295|y>>>27),y=S+(v^E&(g^v))+T[14]+3275163606&4294967295,S=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(S^g))+T[3]+4107603335&4294967295,E=S+(y<<14&4294967295|y>>>18),y=v+(S^g&(E^S))+T[8]+1163531501&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(E^S&(v^E))+T[13]+2850285829&4294967295,g=v+(y<<5&4294967295|y>>>27),y=S+(v^E&(g^v))+T[2]+4243563512&4294967295,S=g+(y<<9&4294967295|y>>>23),y=E+(g^v&(S^g))+T[7]+1735328473&4294967295,E=S+(y<<14&4294967295|y>>>18),y=v+(S^g&(E^S))+T[12]+2368359562&4294967295,v=E+(y<<20&4294967295|y>>>12),y=g+(v^E^S)+T[5]+4294588738&4294967295,g=v+(y<<4&4294967295|y>>>28),y=S+(g^v^E)+T[8]+2272392833&4294967295,S=g+(y<<11&4294967295|y>>>21),y=E+(S^g^v)+T[11]+1839030562&4294967295,E=S+(y<<16&4294967295|y>>>16),y=v+(E^S^g)+T[14]+4259657740&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^S)+T[1]+2763975236&4294967295,g=v+(y<<4&4294967295|y>>>28),y=S+(g^v^E)+T[4]+1272893353&4294967295,S=g+(y<<11&4294967295|y>>>21),y=E+(S^g^v)+T[7]+4139469664&4294967295,E=S+(y<<16&4294967295|y>>>16),y=v+(E^S^g)+T[10]+3200236656&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^S)+T[13]+681279174&4294967295,g=v+(y<<4&4294967295|y>>>28),y=S+(g^v^E)+T[0]+3936430074&4294967295,S=g+(y<<11&4294967295|y>>>21),y=E+(S^g^v)+T[3]+3572445317&4294967295,E=S+(y<<16&4294967295|y>>>16),y=v+(E^S^g)+T[6]+76029189&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(v^E^S)+T[9]+3654602809&4294967295,g=v+(y<<4&4294967295|y>>>28),y=S+(g^v^E)+T[12]+3873151461&4294967295,S=g+(y<<11&4294967295|y>>>21),y=E+(S^g^v)+T[15]+530742520&4294967295,E=S+(y<<16&4294967295|y>>>16),y=v+(E^S^g)+T[2]+3299628645&4294967295,v=E+(y<<23&4294967295|y>>>9),y=g+(E^(v|~S))+T[0]+4096336452&4294967295,g=v+(y<<6&4294967295|y>>>26),y=S+(v^(g|~E))+T[7]+1126891415&4294967295,S=g+(y<<10&4294967295|y>>>22),y=E+(g^(S|~v))+T[14]+2878612391&4294967295,E=S+(y<<15&4294967295|y>>>17),y=v+(S^(E|~g))+T[5]+4237533241&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~S))+T[12]+1700485571&4294967295,g=v+(y<<6&4294967295|y>>>26),y=S+(v^(g|~E))+T[3]+2399980690&4294967295,S=g+(y<<10&4294967295|y>>>22),y=E+(g^(S|~v))+T[10]+4293915773&4294967295,E=S+(y<<15&4294967295|y>>>17),y=v+(S^(E|~g))+T[1]+2240044497&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~S))+T[8]+1873313359&4294967295,g=v+(y<<6&4294967295|y>>>26),y=S+(v^(g|~E))+T[15]+4264355552&4294967295,S=g+(y<<10&4294967295|y>>>22),y=E+(g^(S|~v))+T[6]+2734768916&4294967295,E=S+(y<<15&4294967295|y>>>17),y=v+(S^(E|~g))+T[13]+1309151649&4294967295,v=E+(y<<21&4294967295|y>>>11),y=g+(E^(v|~S))+T[4]+4149444226&4294967295,g=v+(y<<6&4294967295|y>>>26),y=S+(v^(g|~E))+T[11]+3174756917&4294967295,S=g+(y<<10&4294967295|y>>>22),y=E+(g^(S|~v))+T[2]+718787259&4294967295,E=S+(y<<15&4294967295|y>>>17),y=v+(S^(E|~g))+T[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+S&4294967295}r.prototype.v=function(w,g){g===void 0&&(g=w.length);const v=g-this.blockSize,T=this.C;let E=this.h,S=0;for(;S<g;){if(E==0)for(;S<=v;)s(this,w,S),S+=this.blockSize;if(typeof w=="string"){for(;S<g;)if(T[E++]=w.charCodeAt(S++),E==this.blockSize){s(this,T),E=0;break}}else for(;S<g;)if(T[E++]=w[S++],E==this.blockSize){s(this,T),E=0;break}}this.h=E,this.o+=g},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;g=this.o*8;for(var v=w.length-8;v<w.length;++v)w[v]=g&255,g/=256;for(this.v(w),w=Array(16),g=0,v=0;v<4;++v)for(let T=0;T<32;T+=8)w[g++]=this.g[v]>>>T&255;return w};function i(w,g){var v=c;return Object.prototype.hasOwnProperty.call(v,w)?v[w]:v[w]=g(w)}function o(w,g){this.h=g;const v=[];let T=!0;for(let E=w.length-1;E>=0;E--){const S=w[E]|0;T&&S==g||(v[E]=S,T=!1)}this.g=v}var c={};function l(w){return-128<=w&&w<128?i(w,function(g){return new o([g|0],g<0?-1:0)}):new o([w|0],w<0?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return m;if(w<0)return M(h(-w));const g=[];let v=1;for(let T=0;w>=v;T++)g[T]=w/v|0,v*=4294967296;return new o(g,0)}function f(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return M(f(w.substring(1),g));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const v=h(Math.pow(g,8));let T=m;for(let S=0;S<w.length;S+=8){var E=Math.min(8,w.length-S);const y=parseInt(w.substring(S,S+E),g);E<8?(E=h(Math.pow(g,E)),T=T.j(E).add(h(y))):(T=T.j(v),T=T.add(h(y)))}return T}var m=l(0),_=l(1),b=l(16777216);t=o.prototype,t.m=function(){if(O(this))return-M(this).m();let w=0,g=1;for(let v=0;v<this.g.length;v++){const T=this.i(v);w+=(T>=0?T:4294967296+T)*g,g*=4294967296}return w},t.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(N(this))return"0";if(O(this))return"-"+M(this).toString(w);const g=h(Math.pow(w,6));var v=this;let T="";for(;;){const E=X(v,g).g;v=W(v,E.j(g));let S=((v.g.length>0?v.g[0]:v.h)>>>0).toString(w);if(v=E,N(v))return S+T;for(;S.length<6;)S="0"+S;T=S+T}},t.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function N(w){if(w.h!=0)return!1;for(let g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function O(w){return w.h==-1}t.l=function(w){return w=W(this,w),O(w)?-1:N(w)?0:1};function M(w){const g=w.g.length,v=[];for(let T=0;T<g;T++)v[T]=~w.g[T];return new o(v,~w.h).add(_)}t.abs=function(){return O(this)?M(this):this},t.add=function(w){const g=Math.max(this.g.length,w.g.length),v=[];let T=0;for(let E=0;E<=g;E++){let S=T+(this.i(E)&65535)+(w.i(E)&65535),y=(S>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);T=y>>>16,S&=65535,y&=65535,v[E]=y<<16|S}return new o(v,v[v.length-1]&-2147483648?-1:0)};function W(w,g){return w.add(M(g))}t.j=function(w){if(N(this)||N(w))return m;if(O(this))return O(w)?M(this).j(M(w)):M(M(this).j(w));if(O(w))return M(this.j(M(w)));if(this.l(b)<0&&w.l(b)<0)return h(this.m()*w.m());const g=this.g.length+w.g.length,v=[];for(var T=0;T<2*g;T++)v[T]=0;for(T=0;T<this.g.length;T++)for(let E=0;E<w.g.length;E++){const S=this.i(T)>>>16,y=this.i(T)&65535,De=w.i(E)>>>16,Kt=w.i(E)&65535;v[2*T+2*E]+=y*Kt,Q(v,2*T+2*E),v[2*T+2*E+1]+=S*Kt,Q(v,2*T+2*E+1),v[2*T+2*E+1]+=y*De,Q(v,2*T+2*E+1),v[2*T+2*E+2]+=S*De,Q(v,2*T+2*E+2)}for(w=0;w<g;w++)v[w]=v[2*w+1]<<16|v[2*w];for(w=g;w<2*g;w++)v[w]=0;return new o(v,0)};function Q(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function G(w,g){this.g=w,this.h=g}function X(w,g){if(N(g))throw Error("division by zero");if(N(w))return new G(m,m);if(O(w))return g=X(M(w),g),new G(M(g.g),M(g.h));if(O(g))return g=X(w,M(g)),new G(M(g.g),g.h);if(w.g.length>30){if(O(w)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var v=_,T=g;T.l(w)<=0;)v=ce(v),T=ce(T);var E=ve(v,1),S=ve(T,1);for(T=ve(T,2),v=ve(v,2);!N(T);){var y=S.add(T);y.l(w)<=0&&(E=E.add(v),S=y),T=ve(T,1),v=ve(v,1)}return g=W(w,E.j(g)),new G(E,g)}for(E=m;w.l(g)>=0;){for(v=Math.max(1,Math.floor(w.m()/g.m())),T=Math.ceil(Math.log(v)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),S=h(v),y=S.j(g);O(y)||y.l(w)>0;)v-=T,S=h(v),y=S.j(g);N(S)&&(S=_),E=E.add(S),w=W(w,y)}return new G(E,w)}t.B=function(w){return X(this,w).h},t.and=function(w){const g=Math.max(this.g.length,w.g.length),v=[];for(let T=0;T<g;T++)v[T]=this.i(T)&w.i(T);return new o(v,this.h&w.h)},t.or=function(w){const g=Math.max(this.g.length,w.g.length),v=[];for(let T=0;T<g;T++)v[T]=this.i(T)|w.i(T);return new o(v,this.h|w.h)},t.xor=function(w){const g=Math.max(this.g.length,w.g.length),v=[];for(let T=0;T<g;T++)v[T]=this.i(T)^w.i(T);return new o(v,this.h^w.h)};function ce(w){const g=w.g.length+1,v=[];for(let T=0;T<g;T++)v[T]=w.i(T)<<1|w.i(T-1)>>>31;return new o(v,w.h)}function ve(w,g){const v=g>>5;g%=32;const T=w.g.length-v,E=[];for(let S=0;S<T;S++)E[S]=g>0?w.i(S+v)>>>g|w.i(S+v+1)<<32-g:w.i(S+v);return new o(E,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,og=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,Ft=o}).apply(typeof Fl<"u"?Fl:typeof self<"u"?self:typeof window<"u"?window:{});var bs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var ag,wr,cg,Ms,Ko,ug,lg,hg;(function(){var t,e=Object.defineProperty;function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof bs=="object"&&bs];for(var u=0;u<a.length;++u){var d=a[u];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=n(this);function s(a,u){if(u)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var A=a[p];if(!(A in d))break e;d=d[A]}a=a[a.length-1],p=d[a],u=u(p),u!=p&&u!=null&&e(d,a,{configurable:!0,writable:!0,value:u})}}s("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(a){return a||function(u){var d=[],p;for(p in u)Object.prototype.hasOwnProperty.call(u,p)&&d.push([p,u[p]]);return d}});var i=i||{},o=this||self;function c(a){var u=typeof a;return u=="object"&&a!=null||u=="function"}function l(a,u,d){return a.call.apply(a.bind,arguments)}function h(a,u,d){return h=l,h.apply(null,arguments)}function f(a,u){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function m(a,u){function d(){}d.prototype=u.prototype,a.Z=u.prototype,a.prototype=new d,a.prototype.constructor=a,a.Ob=function(p,A,R){for(var D=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)D[Z-2]=arguments[Z];return u.prototype[A].apply(p,D)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function b(a){const u=a.length;if(u>0){const d=Array(u);for(let p=0;p<u;p++)d[p]=a[p];return d}return[]}function N(a,u){for(let p=1;p<arguments.length;p++){const A=arguments[p];var d=typeof A;if(d=d!="object"?d:A?Array.isArray(A)?"array":d:"null",d=="array"||d=="object"&&typeof A.length=="number"){d=a.length||0;const R=A.length||0;a.length=d+R;for(let D=0;D<R;D++)a[d+D]=A[D]}else a.push(A)}}class O{constructor(u,d){this.i=u,this.j=d,this.h=0,this.g=null}get(){let u;return this.h>0?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function M(a){o.setTimeout(()=>{throw a},0)}function W(){var a=w;let u=null;return a.g&&(u=a.g,a.g=a.g.next,a.g||(a.h=null),u.next=null),u}class Q{constructor(){this.h=this.g=null}add(u,d){const p=G.get();p.set(u,d),this.h?this.h.next=p:this.g=p,this.h=p}}var G=new O(()=>new X,a=>a.reset());class X{constructor(){this.next=this.g=this.h=null}set(u,d){this.h=u,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let ce,ve=!1,w=new Q,g=()=>{const a=Promise.resolve(void 0);ce=()=>{a.then(v)}};function v(){for(var a;a=W();){try{a.h.call(a.g)}catch(d){M(d)}var u=G;u.j(a),u.h<100&&(u.h++,a.next=u.g,u.g=a)}ve=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(a,u){this.type=a,this.g=this.target=u,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var S=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,u=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const d=()=>{};o.addEventListener("test",d,u),o.removeEventListener("test",d,u)}catch{}return a})();function y(a){return/^[\s\xa0]*$/.test(a)}function De(a,u){E.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,u)}m(De,E),De.prototype.init=function(a,u){const d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=u,u=a.relatedTarget,u||(d=="mouseover"?u=a.fromElement:d=="mouseout"&&(u=a.toElement)),this.relatedTarget=u,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&De.Z.h.call(this)},De.prototype.h=function(){De.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Kt="closure_listenable_"+(Math.random()*1e6|0),F_=0;function $_(a,u,d,p,A){this.listener=a,this.proxy=null,this.src=u,this.type=d,this.capture=!!p,this.ha=A,this.key=++F_,this.da=this.fa=!1}function is(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function os(a,u,d){for(const p in a)u.call(d,a[p],p,a)}function U_(a,u){for(const d in a)u.call(void 0,a[d],d,a)}function Gc(a){const u={};for(const d in a)u[d]=a[d];return u}const Wc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Hc(a,u){let d,p;for(let A=1;A<arguments.length;A++){p=arguments[A];for(d in p)a[d]=p[d];for(let R=0;R<Wc.length;R++)d=Wc[R],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function as(a){this.src=a,this.g={},this.h=0}as.prototype.add=function(a,u,d,p,A){const R=a.toString();a=this.g[R],a||(a=this.g[R]=[],this.h++);const D=Xi(a,u,p,A);return D>-1?(u=a[D],d||(u.fa=!1)):(u=new $_(u,this.src,R,!!p,A),u.fa=d,a.push(u)),u};function Yi(a,u){const d=u.type;if(d in a.g){var p=a.g[d],A=Array.prototype.indexOf.call(p,u,void 0),R;(R=A>=0)&&Array.prototype.splice.call(p,A,1),R&&(is(u),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Xi(a,u,d,p){for(let A=0;A<a.length;++A){const R=a[A];if(!R.da&&R.listener==u&&R.capture==!!d&&R.ha==p)return A}return-1}var eo="closure_lm_"+(Math.random()*1e6|0),to={};function Kc(a,u,d,p,A){if(Array.isArray(u)){for(let R=0;R<u.length;R++)Kc(a,u[R],d,p,A);return null}return d=Yc(d),a&&a[Kt]?a.J(u,d,c(p)?!!p.capture:!1,A):j_(a,u,d,!1,p,A)}function j_(a,u,d,p,A,R){if(!u)throw Error("Invalid event type");const D=c(A)?!!A.capture:!!A;let Z=ro(a);if(Z||(a[eo]=Z=new as(a)),d=Z.add(u,d,p,D,R),d.proxy)return d;if(p=B_(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)S||(A=D),A===void 0&&(A=!1),a.addEventListener(u.toString(),p,A);else if(a.attachEvent)a.attachEvent(Qc(u.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function B_(){function a(d){return u.call(a.src,a.listener,d)}const u=Z_;return a}function Jc(a,u,d,p,A){if(Array.isArray(u))for(var R=0;R<u.length;R++)Jc(a,u[R],d,p,A);else p=c(p)?!!p.capture:!!p,d=Yc(d),a&&a[Kt]?(a=a.i,R=String(u).toString(),R in a.g&&(u=a.g[R],d=Xi(u,d,p,A),d>-1&&(is(u[d]),Array.prototype.splice.call(u,d,1),u.length==0&&(delete a.g[R],a.h--)))):a&&(a=ro(a))&&(u=a.g[u.toString()],a=-1,u&&(a=Xi(u,d,p,A)),(d=a>-1?u[a]:null)&&no(d))}function no(a){if(typeof a!="number"&&a&&!a.da){var u=a.src;if(u&&u[Kt])Yi(u.i,a);else{var d=a.type,p=a.proxy;u.removeEventListener?u.removeEventListener(d,p,a.capture):u.detachEvent?u.detachEvent(Qc(d),p):u.addListener&&u.removeListener&&u.removeListener(p),(d=ro(u))?(Yi(d,a),d.h==0&&(d.src=null,u[eo]=null)):is(a)}}}function Qc(a){return a in to?to[a]:to[a]="on"+a}function Z_(a,u){if(a.da)a=!0;else{u=new De(u,this);const d=a.listener,p=a.ha||a.src;a.fa&&no(a),a=d.call(p,u)}return a}function ro(a){return a=a[eo],a instanceof as?a:null}var so="__closure_events_fn_"+(Math.random()*1e9>>>0);function Yc(a){return typeof a=="function"?a:(a[so]||(a[so]=function(u){return a.handleEvent(u)}),a[so])}function be(){T.call(this),this.i=new as(this),this.M=this,this.G=null}m(be,T),be.prototype[Kt]=!0,be.prototype.removeEventListener=function(a,u,d,p){Jc(this,a,u,d,p)};function Ce(a,u){var d,p=a.G;if(p)for(d=[];p;p=p.G)d.push(p);if(a=a.M,p=u.type||u,typeof u=="string")u=new E(u,a);else if(u instanceof E)u.target=u.target||a;else{var A=u;u=new E(p,a),Hc(u,A)}A=!0;let R,D;if(d)for(D=d.length-1;D>=0;D--)R=u.g=d[D],A=cs(R,p,!0,u)&&A;if(R=u.g=a,A=cs(R,p,!0,u)&&A,A=cs(R,p,!1,u)&&A,d)for(D=0;D<d.length;D++)R=u.g=d[D],A=cs(R,p,!1,u)&&A}be.prototype.N=function(){if(be.Z.N.call(this),this.i){var a=this.i;for(const u in a.g){const d=a.g[u];for(let p=0;p<d.length;p++)is(d[p]);delete a.g[u],a.h--}}this.G=null},be.prototype.J=function(a,u,d,p){return this.i.add(String(a),u,!1,d,p)},be.prototype.K=function(a,u,d,p){return this.i.add(String(a),u,!0,d,p)};function cs(a,u,d,p){if(u=a.i.g[String(u)],!u)return!0;u=u.concat();let A=!0;for(let R=0;R<u.length;++R){const D=u[R];if(D&&!D.da&&D.capture==d){const Z=D.listener,ge=D.ha||D.src;D.fa&&Yi(a.i,D),A=Z.call(ge,p)!==!1&&A}}return A&&!p.defaultPrevented}function q_(a,u){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=h(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(u)>2147483647?-1:o.setTimeout(a,u||0)}function Xc(a){a.g=q_(()=>{a.g=null,a.i&&(a.i=!1,Xc(a))},a.l);const u=a.h;a.h=null,a.m.apply(null,u)}class G_ extends T{constructor(u,d){super(),this.m=u,this.l=d,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:Xc(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function rr(a){T.call(this),this.h=a,this.g={}}m(rr,T);var eu=[];function tu(a){os(a.g,function(u,d){this.g.hasOwnProperty(d)&&no(u)},a),a.g={}}rr.prototype.N=function(){rr.Z.N.call(this),tu(this)},rr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var io=o.JSON.stringify,W_=o.JSON.parse,H_=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function nu(){}function ru(){}var sr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function oo(){E.call(this,"d")}m(oo,E);function ao(){E.call(this,"c")}m(ao,E);var Jt={},su=null;function us(){return su=su||new be}Jt.Ia="serverreachability";function iu(a){E.call(this,Jt.Ia,a)}m(iu,E);function ir(a){const u=us();Ce(u,new iu(u))}Jt.STAT_EVENT="statevent";function ou(a,u){E.call(this,Jt.STAT_EVENT,a),this.stat=u}m(ou,E);function Ne(a){const u=us();Ce(u,new ou(u,a))}Jt.Ja="timingevent";function au(a,u){E.call(this,Jt.Ja,a),this.size=u}m(au,E);function or(a,u){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},u)}function ar(){this.g=!0}ar.prototype.ua=function(){this.g=!1};function K_(a,u,d,p,A,R){a.info(function(){if(a.g)if(R){var D="",Z=R.split("&");for(let ne=0;ne<Z.length;ne++){var ge=Z[ne].split("=");if(ge.length>1){const Ee=ge[0];ge=ge[1];const et=Ee.split("_");D=et.length>=2&&et[1]=="type"?D+(Ee+"="+ge+"&"):D+(Ee+"=redacted&")}}}else D=null;else D=R;return"XMLHTTP REQ ("+p+") [attempt "+A+"]: "+u+`
`+d+`
`+D})}function J_(a,u,d,p,A,R,D){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+A+"]: "+u+`
`+d+`
`+R+" "+D})}function En(a,u,d,p){a.info(function(){return"XMLHTTP TEXT ("+u+"): "+Y_(a,d)+(p?" "+p:"")})}function Q_(a,u){a.info(function(){return"TIMEOUT: "+u})}ar.prototype.info=function(){};function Y_(a,u){if(!a.g)return u;if(!u)return null;try{const R=JSON.parse(u);if(R){for(a=0;a<R.length;a++)if(Array.isArray(R[a])){var d=R[a];if(!(d.length<2)){var p=d[1];if(Array.isArray(p)&&!(p.length<1)){var A=p[0];if(A!="noop"&&A!="stop"&&A!="close")for(let D=1;D<p.length;D++)p[D]=""}}}}return io(R)}catch{return u}}var ls={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},cu={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},uu;function co(){}m(co,nu),co.prototype.g=function(){return new XMLHttpRequest},uu=new co;function cr(a){return encodeURIComponent(String(a))}function X_(a){var u=1;a=a.split(":");const d=[];for(;u>0&&a.length;)d.push(a.shift()),u--;return a.length&&d.push(a.join(":")),d}function Tt(a,u,d,p){this.j=a,this.i=u,this.l=d,this.S=p||1,this.V=new rr(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new lu}function lu(){this.i=null,this.g="",this.h=!1}var hu={},uo={};function lo(a,u,d){a.M=1,a.A=ds(Xe(u)),a.u=d,a.R=!0,du(a,null)}function du(a,u){a.F=Date.now(),hs(a),a.B=Xe(a.A);var d=a.B,p=a.S;Array.isArray(p)||(p=[String(p)]),bu(d.i,"t",p),a.C=0,d=a.j.L,a.h=new lu,a.g=Bu(a.j,d?u:null,!a.u),a.P>0&&(a.O=new G_(h(a.Y,a,a.g),a.P)),u=a.V,d=a.g,p=a.ba;var A="readystatechange";Array.isArray(A)||(A&&(eu[0]=A.toString()),A=eu);for(let R=0;R<A.length;R++){const D=Kc(d,A[R],p||u.handleEvent,!1,u.h||u);if(!D)break;u.g[D.key]=D}u=a.J?Gc(a.J):{},a.u?(a.v||(a.v="POST"),u["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,u)):(a.v="GET",a.g.ea(a.B,a.v,null,u)),ir(),K_(a.i,a.v,a.B,a.l,a.S,a.u)}Tt.prototype.ba=function(a){a=a.target;const u=this.O;u&&bt(a)==3?u.j():this.Y(a)},Tt.prototype.Y=function(a){try{if(a==this.g)e:{const Z=bt(this.g),ge=this.g.ya(),ne=this.g.ca();if(!(Z<3)&&(Z!=3||this.g&&(this.h.h||this.g.la()||Ou(this.g)))){this.K||Z!=4||ge==7||(ge==8||ne<=0?ir(3):ir(2)),ho(this);var u=this.g.ca();this.X=u;var d=ey(this);if(this.o=u==200,J_(this.i,this.v,this.B,this.l,this.S,Z,u),this.o){if(this.U&&!this.L){t:{if(this.g){var p,A=this.g;if((p=A.g?A.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var R=p;break t}}R=null}if(a=R)En(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,fo(this,a);else{this.o=!1,this.m=3,Ne(12),Qt(this),ur(this);break e}}if(this.R){a=!0;let Ee;for(;!this.K&&this.C<d.length;)if(Ee=ty(this,d),Ee==uo){Z==4&&(this.m=4,Ne(14),a=!1),En(this.i,this.l,null,"[Incomplete Response]");break}else if(Ee==hu){this.m=4,Ne(15),En(this.i,this.l,d,"[Invalid Chunk]"),a=!1;break}else En(this.i,this.l,Ee,null),fo(this,Ee);if(fu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Z!=4||d.length!=0||this.h.h||(this.m=1,Ne(16),a=!1),this.o=this.o&&a,!a)En(this.i,this.l,d,"[Invalid Chunked Response]"),Qt(this),ur(this);else if(d.length>0&&!this.W){this.W=!0;var D=this.j;D.g==this&&D.aa&&!D.P&&(D.j.info("Great, no buffering proxy detected. Bytes received: "+d.length),wo(D),D.P=!0,Ne(11))}}else En(this.i,this.l,d,null),fo(this,d);Z==4&&Qt(this),this.o&&!this.K&&(Z==4?Fu(this.j,this):(this.o=!1,hs(this)))}else my(this.g),u==400&&d.indexOf("Unknown SID")>0?(this.m=3,Ne(12)):(this.m=0,Ne(13)),Qt(this),ur(this)}}}catch{}};function ey(a){if(!fu(a))return a.g.la();const u=Ou(a.g);if(u==="")return"";let d="";const p=u.length,A=bt(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return Qt(a),ur(a),"";a.h.i=new o.TextDecoder}for(let R=0;R<p;R++)a.h.h=!0,d+=a.h.i.decode(u[R],{stream:!(A&&R==p-1)});return u.length=0,a.h.g+=d,a.C=0,a.h.g}function fu(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function ty(a,u){var d=a.C,p=u.indexOf(`
`,d);return p==-1?uo:(d=Number(u.substring(d,p)),isNaN(d)?hu:(p+=1,p+d>u.length?uo:(u=u.slice(p,p+d),a.C=p+d,u)))}Tt.prototype.cancel=function(){this.K=!0,Qt(this)};function hs(a){a.T=Date.now()+a.H,pu(a,a.H)}function pu(a,u){if(a.D!=null)throw Error("WatchDog timer not null");a.D=or(h(a.aa,a),u)}function ho(a){a.D&&(o.clearTimeout(a.D),a.D=null)}Tt.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(Q_(this.i,this.B),this.M!=2&&(ir(),Ne(17)),Qt(this),this.m=2,ur(this)):pu(this,this.T-a)};function ur(a){a.j.I==0||a.K||Fu(a.j,a)}function Qt(a){ho(a);var u=a.O;u&&typeof u.dispose=="function"&&u.dispose(),a.O=null,tu(a.V),a.g&&(u=a.g,a.g=null,u.abort(),u.dispose())}function fo(a,u){try{var d=a.j;if(d.I!=0&&(d.g==a||po(d.h,a))){if(!a.L&&po(d.h,a)&&d.I==3){try{var p=d.Ba.g.parse(u)}catch{p=null}if(Array.isArray(p)&&p.length==3){var A=p;if(A[0]==0){e:if(!d.v){if(d.g)if(d.g.F+3e3<a.F)_s(d),ms(d);else break e;Eo(d),Ne(18)}}else d.xa=A[1],0<d.xa-d.K&&A[2]<37500&&d.F&&d.A==0&&!d.C&&(d.C=or(h(d.Va,d),6e3));_u(d.h)<=1&&d.ta&&(d.ta=void 0)}else Xt(d,11)}else if((a.L||d.g==a)&&_s(d),!y(u))for(A=d.Ba.g.parse(u),u=0;u<A.length;u++){let ne=A[u];const Ee=ne[0];if(!(Ee<=d.K))if(d.K=Ee,ne=ne[1],d.I==2)if(ne[0]=="c"){d.M=ne[1],d.ba=ne[2];const et=ne[3];et!=null&&(d.ka=et,d.j.info("VER="+d.ka));const en=ne[4];en!=null&&(d.za=en,d.j.info("SVER="+d.za));const St=ne[5];St!=null&&typeof St=="number"&&St>0&&(p=1.5*St,d.O=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;const Rt=a.g;if(Rt){const vs=Rt.g?Rt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vs){var R=p.h;R.g||vs.indexOf("spdy")==-1&&vs.indexOf("quic")==-1&&vs.indexOf("h2")==-1||(R.j=R.l,R.g=new Set,R.h&&(mo(R,R.h),R.h=null))}if(p.G){const To=Rt.g?Rt.g.getResponseHeader("X-HTTP-Session-Id"):null;To&&(p.wa=To,ae(p.J,p.G,To))}}d.I=3,d.l&&d.l.ra(),d.aa&&(d.T=Date.now()-a.F,d.j.info("Handshake RTT: "+d.T+"ms")),p=d;var D=a;if(p.na=ju(p,p.L?p.ba:null,p.W),D.L){yu(p.h,D);var Z=D,ge=p.O;ge&&(Z.H=ge),Z.D&&(ho(Z),hs(Z)),p.g=D}else zu(p);d.i.length>0&&gs(d)}else ne[0]!="stop"&&ne[0]!="close"||Xt(d,7);else d.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?Xt(d,7):vo(d):ne[0]!="noop"&&d.l&&d.l.qa(ne),d.A=0)}}ir(4)}catch{}}var ny=class{constructor(a,u){this.g=a,this.map=u}};function mu(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function gu(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function _u(a){return a.h?1:a.g?a.g.size:0}function po(a,u){return a.h?a.h==u:a.g?a.g.has(u):!1}function mo(a,u){a.g?a.g.add(u):a.h=u}function yu(a,u){a.h&&a.h==u?a.h=null:a.g&&a.g.has(u)&&a.g.delete(u)}mu.prototype.cancel=function(){if(this.i=vu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function vu(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let u=a.i;for(const d of a.g.values())u=u.concat(d.G);return u}return b(a.i)}var Eu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ry(a,u){if(a){a=a.split("&");for(let d=0;d<a.length;d++){const p=a[d].indexOf("=");let A,R=null;p>=0?(A=a[d].substring(0,p),R=a[d].substring(p+1)):A=a[d],u(A,R?decodeURIComponent(R.replace(/\+/g," ")):"")}}}function It(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let u;a instanceof It?(this.l=a.l,lr(this,a.j),this.o=a.o,this.g=a.g,hr(this,a.u),this.h=a.h,go(this,Su(a.i)),this.m=a.m):a&&(u=String(a).match(Eu))?(this.l=!1,lr(this,u[1]||"",!0),this.o=dr(u[2]||""),this.g=dr(u[3]||"",!0),hr(this,u[4]),this.h=dr(u[5]||"",!0),go(this,u[6]||"",!0),this.m=dr(u[7]||"")):(this.l=!1,this.i=new pr(null,this.l))}It.prototype.toString=function(){const a=[];var u=this.j;u&&a.push(fr(u,wu,!0),":");var d=this.g;return(d||u=="file")&&(a.push("//"),(u=this.o)&&a.push(fr(u,wu,!0),"@"),a.push(cr(d).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.u,d!=null&&a.push(":",String(d))),(d=this.h)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(fr(d,d.charAt(0)=="/"?oy:iy,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",fr(d,cy)),a.join("")},It.prototype.resolve=function(a){const u=Xe(this);let d=!!a.j;d?lr(u,a.j):d=!!a.o,d?u.o=a.o:d=!!a.g,d?u.g=a.g:d=a.u!=null;var p=a.h;if(d)hr(u,a.u);else if(d=!!a.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var A=u.h.lastIndexOf("/");A!=-1&&(p=u.h.slice(0,A+1)+p)}if(A=p,A==".."||A==".")p="";else if(A.indexOf("./")!=-1||A.indexOf("/.")!=-1){p=A.lastIndexOf("/",0)==0,A=A.split("/");const R=[];for(let D=0;D<A.length;){const Z=A[D++];Z=="."?p&&D==A.length&&R.push(""):Z==".."?((R.length>1||R.length==1&&R[0]!="")&&R.pop(),p&&D==A.length&&R.push("")):(R.push(Z),p=!0)}p=R.join("/")}else p=A}return d?u.h=p:d=a.i.toString()!=="",d?go(u,Su(a.i)):d=!!a.m,d&&(u.m=a.m),u};function Xe(a){return new It(a)}function lr(a,u,d){a.j=d?dr(u,!0):u,a.j&&(a.j=a.j.replace(/:$/,""))}function hr(a,u){if(u){if(u=Number(u),isNaN(u)||u<0)throw Error("Bad port number "+u);a.u=u}else a.u=null}function go(a,u,d){u instanceof pr?(a.i=u,uy(a.i,a.l)):(d||(u=fr(u,ay)),a.i=new pr(u,a.l))}function ae(a,u,d){a.i.set(u,d)}function ds(a){return ae(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function dr(a,u){return a?u?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function fr(a,u,d){return typeof a=="string"?(a=encodeURI(a).replace(u,sy),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function sy(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var wu=/[#\/\?@]/g,iy=/[#\?:]/g,oy=/[#\?]/g,ay=/[#\?@]/g,cy=/#/g;function pr(a,u){this.h=this.g=null,this.i=a||null,this.j=!!u}function Yt(a){a.g||(a.g=new Map,a.h=0,a.i&&ry(a.i,function(u,d){a.add(decodeURIComponent(u.replace(/\+/g," ")),d)}))}t=pr.prototype,t.add=function(a,u){Yt(this),this.i=null,a=wn(this,a);let d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(u),this.h+=1,this};function Tu(a,u){Yt(a),u=wn(a,u),a.g.has(u)&&(a.i=null,a.h-=a.g.get(u).length,a.g.delete(u))}function Iu(a,u){return Yt(a),u=wn(a,u),a.g.has(u)}t.forEach=function(a,u){Yt(this),this.g.forEach(function(d,p){d.forEach(function(A){a.call(u,A,p,this)},this)},this)};function Au(a,u){Yt(a);let d=[];if(typeof u=="string")Iu(a,u)&&(d=d.concat(a.g.get(wn(a,u))));else for(a=Array.from(a.g.values()),u=0;u<a.length;u++)d=d.concat(a[u]);return d}t.set=function(a,u){return Yt(this),this.i=null,a=wn(this,a),Iu(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[u]),this.h+=1,this},t.get=function(a,u){return a?(a=Au(this,a),a.length>0?String(a[0]):u):u};function bu(a,u,d){Tu(a,u),d.length>0&&(a.i=null,a.g.set(wn(a,u),b(d)),a.h+=d.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],u=Array.from(this.g.keys());for(let p=0;p<u.length;p++){var d=u[p];const A=cr(d);d=Au(this,d);for(let R=0;R<d.length;R++){let D=A;d[R]!==""&&(D+="="+cr(d[R])),a.push(D)}}return this.i=a.join("&")};function Su(a){const u=new pr;return u.i=a.i,a.g&&(u.g=new Map(a.g),u.h=a.h),u}function wn(a,u){return u=String(u),a.j&&(u=u.toLowerCase()),u}function uy(a,u){u&&!a.j&&(Yt(a),a.i=null,a.g.forEach(function(d,p){const A=p.toLowerCase();p!=A&&(Tu(this,p),bu(this,A,d))},a)),a.j=u}function ly(a,u){const d=new ar;if(o.Image){const p=new Image;p.onload=f(At,d,"TestLoadImage: loaded",!0,u,p),p.onerror=f(At,d,"TestLoadImage: error",!1,u,p),p.onabort=f(At,d,"TestLoadImage: abort",!1,u,p),p.ontimeout=f(At,d,"TestLoadImage: timeout",!1,u,p),o.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else u(!1)}function hy(a,u){const d=new ar,p=new AbortController,A=setTimeout(()=>{p.abort(),At(d,"TestPingServer: timeout",!1,u)},1e4);fetch(a,{signal:p.signal}).then(R=>{clearTimeout(A),R.ok?At(d,"TestPingServer: ok",!0,u):At(d,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(A),At(d,"TestPingServer: error",!1,u)})}function At(a,u,d,p,A){try{A&&(A.onload=null,A.onerror=null,A.onabort=null,A.ontimeout=null),p(d)}catch{}}function dy(){this.g=new H_}function _o(a){this.i=a.Sb||null,this.h=a.ab||!1}m(_o,nu),_o.prototype.g=function(){return new fs(this.i,this.h)};function fs(a,u){be.call(this),this.H=a,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(fs,be),t=fs.prototype,t.open=function(a,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=u,this.readyState=1,gr(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const u={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(u.body=a),(this.H||o).fetch(new Request(this.D,u)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,mr(this)),this.readyState=0},t.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,gr(this)),this.g&&(this.readyState=3,gr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ru(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ru(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}t.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var u=a.value?a.value:new Uint8Array(0);(u=this.B.decode(u,{stream:!a.done}))&&(this.response=this.responseText+=u)}a.done?mr(this):gr(this),this.readyState==3&&Ru(this)}},t.Oa=function(a){this.g&&(this.response=this.responseText=a,mr(this))},t.Na=function(a){this.g&&(this.response=a,mr(this))},t.ga=function(){this.g&&mr(this)};function mr(a){a.readyState=4,a.l=null,a.j=null,a.B=null,gr(a)}t.setRequestHeader=function(a,u){this.A.append(a,u)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],u=this.h.entries();for(var d=u.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=u.next();return a.join(`\r
`)};function gr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(fs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Pu(a){let u="";return os(a,function(d,p){u+=p,u+=":",u+=d,u+=`\r
`}),u}function yo(a,u,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Pu(d),typeof a=="string"?d!=null&&cr(d):ae(a,u,d))}function he(a){be.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(he,be);var fy=/^https?$/i,py=["POST","PUT"];t=he.prototype,t.Fa=function(a){this.H=a},t.ea=function(a,u,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);u=u?u.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():uu.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(u,String(a),!0),this.B=!1}catch(R){ku(this,R);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var A in p)d.set(A,p[A]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(const R of p.keys())d.set(R,p.get(R));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(R=>R.toLowerCase()=="content-type"),A=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(py,u,void 0)>=0)||p||A||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[R,D]of d)this.g.setRequestHeader(R,D);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(R){ku(this,R)}};function ku(a,u){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=u,a.o=5,Cu(a),ps(a)}function Cu(a){a.A||(a.A=!0,Ce(a,"complete"),Ce(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Ce(this,"complete"),Ce(this,"abort"),ps(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ps(this,!0)),he.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Nu(this):this.Xa())},t.Xa=function(){Nu(this)};function Nu(a){if(a.h&&typeof i<"u"){if(a.v&&bt(a)==4)setTimeout(a.Ca.bind(a),0);else if(Ce(a,"readystatechange"),bt(a)==4){a.h=!1;try{const R=a.ca();e:switch(R){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var d;if(!(d=u)){var p;if(p=R===0){let D=String(a.D).match(Eu)[1]||null;!D&&o.self&&o.self.location&&(D=o.self.location.protocol.slice(0,-1)),p=!fy.test(D?D.toLowerCase():"")}d=p}if(d)Ce(a,"complete"),Ce(a,"success");else{a.o=6;try{var A=bt(a)>2?a.g.statusText:""}catch{A=""}a.l=A+" ["+a.ca()+"]",Cu(a)}}finally{ps(a)}}}}function ps(a,u){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const d=a.g;a.g=null,u||Ce(a,"ready");try{d.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function bt(a){return a.g?a.g.readyState:0}t.ca=function(){try{return bt(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(a){if(this.g){var u=this.g.responseText;return a&&u.indexOf(a)==0&&(u=u.substring(a.length)),W_(u)}};function Ou(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function my(a){const u={};a=(a.g&&bt(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(y(a[p]))continue;var d=X_(a[p]);const A=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();const R=u[A]||[];u[A]=R,R.push(d)}U_(u,function(p){return p.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function _r(a,u,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||u}function Du(a){this.za=0,this.i=[],this.j=new ar,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=_r("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=_r("baseRetryDelayMs",5e3,a),this.Za=_r("retryDelaySeedMs",1e4,a),this.Ta=_r("forwardChannelMaxRetries",2,a),this.va=_r("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new mu(a&&a.concurrentRequestLimit),this.Ba=new dy,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Du.prototype,t.ka=8,t.I=1,t.connect=function(a,u,d,p){Ne(0),this.W=a,this.H=u||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.J=ju(this,null,this.W),gs(this)};function vo(a){if(Vu(a),a.I==3){var u=a.V++,d=Xe(a.J);if(ae(d,"SID",a.M),ae(d,"RID",u),ae(d,"TYPE","terminate"),yr(a,d),u=new Tt(a,a.j,u),u.M=2,u.A=ds(Xe(d)),d=!1,o.navigator&&o.navigator.sendBeacon)try{d=o.navigator.sendBeacon(u.A.toString(),"")}catch{}!d&&o.Image&&(new Image().src=u.A,d=!0),d||(u.g=Bu(u.j,null),u.g.ea(u.A)),u.F=Date.now(),hs(u)}Uu(a)}function ms(a){a.g&&(wo(a),a.g.cancel(),a.g=null)}function Vu(a){ms(a),a.v&&(o.clearTimeout(a.v),a.v=null),_s(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function gs(a){if(!gu(a.h)&&!a.m){a.m=!0;var u=a.Ea;ce||g(),ve||(ce(),ve=!0),w.add(u,a),a.D=0}}function gy(a,u){return _u(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=u.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=or(h(a.Ea,a,u),$u(a,a.D)),a.D++,!0)}t.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const A=new Tt(this,this.j,a);let R=this.o;if(this.U&&(R?(R=Gc(R),Hc(R,this.U)):R=this.U),this.u!==null||this.R||(A.J=R,R=null),this.S)e:{for(var u=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(u+=p,u>4096){u=d;break e}if(u===4096||d===this.i.length-1){u=d+1;break e}}u=1e3}else u=1e3;u=xu(this,A,u),d=Xe(this.J),ae(d,"RID",a),ae(d,"CVER",22),this.G&&ae(d,"X-HTTP-Session-Id",this.G),yr(this,d),R&&(this.R?u="headers="+cr(Pu(R))+"&"+u:this.u&&yo(d,this.u,R)),mo(this.h,A),this.Ra&&ae(d,"TYPE","init"),this.S?(ae(d,"$req",u),ae(d,"SID","null"),A.U=!0,lo(A,d,null)):lo(A,d,u),this.I=2}}else this.I==3&&(a?Mu(this,a):this.i.length==0||gu(this.h)||Mu(this))};function Mu(a,u){var d;u?d=u.l:d=a.V++;const p=Xe(a.J);ae(p,"SID",a.M),ae(p,"RID",d),ae(p,"AID",a.K),yr(a,p),a.u&&a.o&&yo(p,a.u,a.o),d=new Tt(a,a.j,d,a.D+1),a.u===null&&(d.J=a.o),u&&(a.i=u.G.concat(a.i)),u=xu(a,d,1e3),d.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),mo(a.h,d),lo(d,p,u)}function yr(a,u){a.H&&os(a.H,function(d,p){ae(u,p,d)}),a.l&&os({},function(d,p){ae(u,p,d)})}function xu(a,u,d){d=Math.min(a.i.length,d);const p=a.l?h(a.l.Ka,a.l,a):null;e:{var A=a.i;let Z=-1;for(;;){const ge=["count="+d];Z==-1?d>0?(Z=A[0].g,ge.push("ofs="+Z)):Z=0:ge.push("ofs="+Z);let ne=!0;for(let Ee=0;Ee<d;Ee++){var R=A[Ee].g;const et=A[Ee].map;if(R-=Z,R<0)Z=Math.max(0,A[Ee].g-100),ne=!1;else try{R="req"+R+"_"||"";try{var D=et instanceof Map?et:Object.entries(et);for(const[en,St]of D){let Rt=St;c(St)&&(Rt=io(St)),ge.push(R+en+"="+encodeURIComponent(Rt))}}catch(en){throw ge.push(R+"type="+encodeURIComponent("_badmap")),en}}catch{p&&p(et)}}if(ne){D=ge.join("&");break e}}D=void 0}return a=a.i.splice(0,d),u.G=a,D}function zu(a){if(!a.g&&!a.v){a.Y=1;var u=a.Da;ce||g(),ve||(ce(),ve=!0),w.add(u,a),a.A=0}}function Eo(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=or(h(a.Da,a),$u(a,a.A)),a.A++,!0)}t.Da=function(){if(this.v=null,Lu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=or(h(this.Wa,this),a)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ne(10),ms(this),Lu(this))};function wo(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function Lu(a){a.g=new Tt(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var u=Xe(a.na);ae(u,"RID","rpc"),ae(u,"SID",a.M),ae(u,"AID",a.K),ae(u,"CI",a.F?"0":"1"),!a.F&&a.ia&&ae(u,"TO",a.ia),ae(u,"TYPE","xmlhttp"),yr(a,u),a.u&&a.o&&yo(u,a.u,a.o),a.O&&(a.g.H=a.O);var d=a.g;a=a.ba,d.M=1,d.A=ds(Xe(u)),d.u=null,d.R=!0,du(d,a)}t.Va=function(){this.C!=null&&(this.C=null,ms(this),Eo(this),Ne(19))};function _s(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function Fu(a,u){var d=null;if(a.g==u){_s(a),wo(a),a.g=null;var p=2}else if(po(a.h,u))d=u.G,yu(a.h,u),p=1;else return;if(a.I!=0){if(u.o)if(p==1){d=u.u?u.u.length:0,u=Date.now()-u.F;var A=a.D;p=us(),Ce(p,new au(p,d)),gs(a)}else zu(a);else if(A=u.m,A==3||A==0&&u.X>0||!(p==1&&gy(a,u)||p==2&&Eo(a)))switch(d&&d.length>0&&(u=a.h,u.i=u.i.concat(d)),A){case 1:Xt(a,5);break;case 4:Xt(a,10);break;case 3:Xt(a,6);break;default:Xt(a,2)}}}function $u(a,u){let d=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(d*=2),d*u}function Xt(a,u){if(a.j.info("Error code "+u),u==2){var d=h(a.bb,a),p=a.Ua;const A=!p;p=new It(p||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||lr(p,"https"),ds(p),A?ly(p.toString(),d):hy(p.toString(),d)}else Ne(2);a.I=0,a.l&&a.l.pa(u),Uu(a),Vu(a)}t.bb=function(a){a?(this.j.info("Successfully pinged google.com"),Ne(2)):(this.j.info("Failed to ping google.com"),Ne(1))};function Uu(a){if(a.I=0,a.ja=[],a.l){const u=vu(a.h);(u.length!=0||a.i.length!=0)&&(N(a.ja,u),N(a.ja,a.i),a.h.i.length=0,b(a.i),a.i.length=0),a.l.oa()}}function ju(a,u,d){var p=d instanceof It?Xe(d):new It(d);if(p.g!="")u&&(p.g=u+"."+p.g),hr(p,p.u);else{var A=o.location;p=A.protocol,u=u?u+"."+A.hostname:A.hostname,A=+A.port;const R=new It(null);p&&lr(R,p),u&&(R.g=u),A&&hr(R,A),d&&(R.h=d),p=R}return d=a.G,u=a.wa,d&&u&&ae(p,d,u),ae(p,"VER",a.ka),yr(a,p),p}function Bu(a,u,d){if(u&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return u=a.Aa&&!a.ma?new he(new _o({ab:d})):new he(a.ma),u.Fa(a.L),u}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zu(){}t=Zu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ys(){}ys.prototype.g=function(a,u){return new xe(a,u)};function xe(a,u){be.call(this),this.g=new Du(u),this.l=a,this.h=u&&u.messageUrlParams||null,a=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(a?a["X-WebChannel-Content-Type"]=u.messageContentType:a={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.sa&&(a?a["X-WebChannel-Client-Profile"]=u.sa:a={"X-WebChannel-Client-Profile":u.sa}),this.g.U=a,(a=u&&u.Qb)&&!y(a)&&(this.g.u=a),this.A=u&&u.supportsCrossDomainXhr||!1,this.v=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!y(u)&&(this.g.G=u,a=this.h,a!==null&&u in a&&(a=this.h,u in a&&delete a[u])),this.j=new Tn(this)}m(xe,be),xe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xe.prototype.close=function(){vo(this.g)},xe.prototype.o=function(a){var u=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.v&&(d={},d.__data__=io(a),a=d);u.i.push(new ny(u.Ya++,a)),u.I==3&&gs(u)},xe.prototype.N=function(){this.g.l=null,delete this.j,vo(this.g),delete this.g,xe.Z.N.call(this)};function qu(a){oo.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var u=a.__sm__;if(u){e:{for(const d in u){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,u=u!==null&&a in u?u[a]:void 0),this.data=u}else this.data=a}m(qu,oo);function Gu(){ao.call(this),this.status=1}m(Gu,ao);function Tn(a){this.g=a}m(Tn,Zu),Tn.prototype.ra=function(){Ce(this.g,"a")},Tn.prototype.qa=function(a){Ce(this.g,new qu(a))},Tn.prototype.pa=function(a){Ce(this.g,new Gu)},Tn.prototype.oa=function(){Ce(this.g,"b")},ys.prototype.createWebChannel=ys.prototype.g,xe.prototype.send=xe.prototype.o,xe.prototype.open=xe.prototype.m,xe.prototype.close=xe.prototype.close,hg=function(){return new ys},lg=function(){return us()},ug=Jt,Ko={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ls.NO_ERROR=0,ls.TIMEOUT=8,ls.HTTP_ERROR=6,Ms=ls,cu.COMPLETE="complete",cg=cu,ru.EventType=sr,sr.OPEN="a",sr.CLOSE="b",sr.ERROR="c",sr.MESSAGE="d",be.prototype.listen=be.prototype.J,wr=ru,he.prototype.listenOnce=he.prototype.K,he.prototype.getLastError=he.prototype.Ha,he.prototype.getLastErrorCode=he.prototype.ya,he.prototype.getStatus=he.prototype.ca,he.prototype.getResponseJson=he.prototype.La,he.prototype.getResponseText=he.prototype.la,he.prototype.send=he.prototype.ea,he.prototype.setWithCredentials=he.prototype.Fa,ag=he}).apply(typeof bs<"u"?bs:typeof self<"u"?self:typeof window<"u"?window:{});class Re{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Re.UNAUTHENTICATED=new Re(null),Re.GOOGLE_CREDENTIALS=new Re("google-credentials-uid"),Re.FIRST_PARTY=new Re("first-party-uid"),Re.MOCK_USER=new Re("mock-user");let Jn="12.9.0";function JS(t){Jn=t}const hn=new Qa("@firebase/firestore");function In(){return hn.logLevel}function x(t,...e){if(hn.logLevel<=H.DEBUG){const n=e.map(lc);hn.debug(`Firestore (${Jn}): ${t}`,...n)}}function vt(t,...e){if(hn.logLevel<=H.ERROR){const n=e.map(lc);hn.error(`Firestore (${Jn}): ${t}`,...n)}}function dn(t,...e){if(hn.logLevel<=H.WARN){const n=e.map(lc);hn.warn(`Firestore (${Jn}): ${t}`,...n)}}function lc(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function L(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,dg(t,r,n)}function dg(t,e,n){let r=`FIRESTORE (${Jn}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw vt(r),new Error(r)}function ee(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||dg(e,s,r)}function $(t,e){return t}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class V extends wt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class mt{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class fg{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Re.UNAUTHENTICATED)))}shutdown(){}}class YS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class XS{constructor(e){this.t=e,this.currentUser=Re.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ee(this.o===void 0,42304);let r=this.i;const s=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let i=new mt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new mt,e.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const l=i;e.enqueueRetryable((async()=>{await l.promise,await s(this.currentUser)}))},c=l=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((l=>c(l))),setTimeout((()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new mt)}}),0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string",31837,{l:r}),new fg(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string",2055,{h:e}),new Re(e)}}class eR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=Re.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class tR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new eR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Re.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class $l{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class nR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ze(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ee(this.o===void 0,3512);const r=i=>{i.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable((()=>r(i)))};const s=i=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((i=>s(i))),setTimeout((()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new $l(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ee(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new $l(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function rR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}class hc{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=rR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function K(t,e){return t<e?-1:t>e?1:0}function Jo(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Co(s)===Co(i)?K(s,i):Co(s)?1:-1}return K(t.length,e.length)}const sR=55296,iR=57343;function Co(t){const e=t.charCodeAt(0);return e>=sR&&e<=iR}function $n(t,e,n){return t.length===e.length&&t.every(((r,s)=>n(r,e[s])))}const Ul="__name__";class tt{constructor(e,n,r){n===void 0?n=0:n>e.length&&L(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&L(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return tt.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof tt?e.forEach((r=>{n.push(r)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=tt.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return K(e.length,n.length)}static compareSegments(e,n){const r=tt.isNumericId(e),s=tt.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?tt.extractNumericId(e).compare(tt.extractNumericId(n)):Jo(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ft.fromString(e.substring(4,e.length-2))}}class re extends tt{construct(e,n,r){return new re(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new V(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter((s=>s.length>0)))}return new re(n)}static emptyPath(){return new re([])}}const oR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ie extends tt{construct(e,n,r){return new Ie(e,n,r)}static isValidIdentifier(e){return oR.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ie.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Ul}static keyField(){return new Ie([Ul])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new V(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new V(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new V(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(r+=c,s++):(i(),s++)}if(i(),o)throw new V(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ie(n)}static emptyPath(){return new Ie([])}}class z{constructor(e){this.path=e}static fromPath(e){return new z(re.fromString(e))}static fromName(e){return new z(re.fromString(e).popFirst(5))}static empty(){return new z(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&re.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return re.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new z(new re(e.slice()))}}function pg(t,e,n){if(!n)throw new V(P.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aR(t,e,n,r){if(e===!0&&r===!0)throw new V(P.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function jl(t){if(!z.isDocumentKey(t))throw new V(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Bl(t){if(z.isDocumentKey(t))throw new V(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function mg(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Li(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":L(12329,{type:typeof t})}function Ut(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new V(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Li(t);throw new V(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function me(t,e){const n={typeString:t};return e&&(n.value=e),n}function es(t,e){if(!mg(t))throw new V(P.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new V(P.INVALID_ARGUMENT,n);return!0}const Zl=-62135596800,ql=1e6;class te{static now(){return te.fromMillis(Date.now())}static fromDate(e){return te.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*ql);return new te(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new V(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new V(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<Zl)throw new V(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new V(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ql}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:te._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(es(e,te._jsonSchema))return new te(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Zl;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}te._jsonSchemaVersion="firestore/timestamp/1.0",te._jsonSchema={type:me("string",te._jsonSchemaVersion),seconds:me("number"),nanoseconds:me("number")};class U{static fromTimestamp(e){return new U(e)}static min(){return new U(new te(0,0))}static max(){return new U(new te(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const xr=-1;function cR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=U.fromTimestamp(r===1e9?new te(n+1,0):new te(n,r));return new jt(s,z.empty(),e)}function uR(t){return new jt(t.readTime,t.key,xr)}class jt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new jt(U.min(),z.empty(),xr)}static max(){return new jt(U.max(),z.empty(),xr)}}function lR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=z.comparator(t.documentKey,e.documentKey),n!==0?n:K(t.largestBatchId,e.largestBatchId))}const hR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Qn(t){if(t.code!==P.FAILED_PRECONDITION||t.message!==hR)throw t;x("LocalStore","Unexpectedly lost primary lease")}class k{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&L(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new k(((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof k?n:k.resolve(n)}catch(n){return k.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):k.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):k.reject(n)}static resolve(e){return new k(((n,r)=>{n(e)}))}static reject(e){return new k(((n,r)=>{r(e)}))}static waitFor(e){return new k(((n,r)=>{let s=0,i=0,o=!1;e.forEach((c=>{++s,c.next((()=>{++i,o&&i===s&&n()}),(l=>r(l)))})),o=!0,i===s&&n()}))}static or(e){let n=k.resolve(!1);for(const r of e)n=n.next((s=>s?k.resolve(s):r()));return n}static forEach(e,n){const r=[];return e.forEach(((s,i)=>{r.push(n.call(this,s,i))})),this.waitFor(r)}static mapArray(e,n){return new k(((r,s)=>{const i=e.length,o=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;n(e[h]).next((f=>{o[h]=f,++c,c===i&&r(o)}),(f=>s(f)))}}))}static doWhile(e,n){return new k(((r,s)=>{const i=()=>{e()===!0?n().next((()=>{i()}),s):r()};i()}))}}function fR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Yn(t){return t.name==="IndexedDbTransactionError"}class Fi{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Fi.ce=-1;const dc=-1;function $i(t){return t==null}function ai(t){return t===0&&1/t==-1/0}function pR(t){return typeof t=="number"&&Number.isInteger(t)&&!ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const gg="";function mR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Gl(e)),e=gR(t.get(n),e);return Gl(e)}function gR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case gg:n+="";break;default:n+=i}}return n}function Gl(t){return t+gg+""}function Wl(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function mn(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function _R(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function _g(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class ue{constructor(e,n){this.comparator=e,this.root=n||Te.EMPTY}insert(e,n){return new ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Te.BLACK,null,null))}remove(e){return new ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Te.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,r)=>(e(n,r),!1)))}toString(){const e=[];return this.inorderTraversal(((n,r)=>(e.push(`${n}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ss(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ss(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ss(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ss(this.root,e,this.comparator,!0)}}class Ss{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Te{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Te.RED,this.left=s??Te.EMPTY,this.right=i??Te.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Te(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Te.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Te.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Te.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Te.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw L(43730,{key:this.key,value:this.value});if(this.right.isRed())throw L(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw L(27949);return e+(this.isRed()?0:1)}}Te.EMPTY=null,Te.RED=!0,Te.BLACK=!1;Te.EMPTY=new class{constructor(){this.size=0}get key(){throw L(57766)}get value(){throw L(16141)}get color(){throw L(16727)}get left(){throw L(29726)}get right(){throw L(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Te(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ye{constructor(e){this.comparator=e,this.data=new ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,r)=>(e(n),!1)))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Hl(this.data.getIterator())}getIteratorFrom(e){return new Hl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((r=>{n=n.add(r)})),n}isEqual(e){if(!(e instanceof ye)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new ye(this.comparator);return n.data=e,n}}class Hl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class We{constructor(e){this.fields=e,e.sort(Ie.comparator)}static empty(){return new We([])}unionWith(e){let n=new ye(Ie.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new We(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return $n(this.fields,e.fields,((n,r)=>n.isEqual(r)))}}class yg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ae{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new yg("Invalid base64 string: "+i):i}})(e);return new Ae(n)}static fromUint8Array(e){const n=(function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i})(e);return new Ae(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ae.EMPTY_BYTE_STRING=new Ae("");const yR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bt(t){if(ee(!!t,39018),typeof t=="string"){let e=0;const n=yR.exec(t);if(ee(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:de(t.seconds),nanos:de(t.nanos)}}function de(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Zt(t){return typeof t=="string"?Ae.fromBase64String(t):Ae.fromUint8Array(t)}const vg="server_timestamp",Eg="__type__",wg="__previous_value__",Tg="__local_write_time__";function fc(t){return(t?.mapValue?.fields||{})[Eg]?.stringValue===vg}function Ui(t){const e=t.mapValue.fields[wg];return fc(e)?Ui(e):e}function zr(t){const e=Bt(t.mapValue.fields[Tg].timestampValue);return new te(e.seconds,e.nanos)}class vR{constructor(e,n,r,s,i,o,c,l,h,f,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=f,this.apiKey=m}}const ci="(default)";class Lr{constructor(e,n){this.projectId=e,this.database=n||ci}static empty(){return new Lr("","")}get isDefaultDatabase(){return this.database===ci}isEqual(e){return e instanceof Lr&&e.projectId===this.projectId&&e.database===this.database}}function ER(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new V(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Lr(t.options.projectId,e)}const Ig="__type__",wR="__max__",Rs={mapValue:{}},Ag="__vector__",ui="value";function qt(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fc(t)?4:IR(t)?9007199254740991:TR(t)?10:11:L(28295,{value:t})}function ct(t,e){if(t===e)return!0;const n=qt(t);if(n!==qt(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zr(t).isEqual(zr(e));case 3:return(function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Bt(s.timestampValue),c=Bt(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(s,i){return Zt(s.bytesValue).isEqual(Zt(i.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(s,i){return de(s.geoPointValue.latitude)===de(i.geoPointValue.latitude)&&de(s.geoPointValue.longitude)===de(i.geoPointValue.longitude)})(t,e);case 2:return(function(s,i){if("integerValue"in s&&"integerValue"in i)return de(s.integerValue)===de(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=de(s.doubleValue),c=de(i.doubleValue);return o===c?ai(o)===ai(c):isNaN(o)&&isNaN(c)}return!1})(t,e);case 9:return $n(t.arrayValue.values||[],e.arrayValue.values||[],ct);case 10:case 11:return(function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(Wl(o)!==Wl(c))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!ct(o[l],c[l])))return!1;return!0})(t,e);default:return L(52216,{left:t})}}function Fr(t,e){return(t.values||[]).find((n=>ct(n,e)))!==void 0}function Un(t,e){if(t===e)return 0;const n=qt(t),r=qt(e);if(n!==r)return K(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return K(t.booleanValue,e.booleanValue);case 2:return(function(i,o){const c=de(i.integerValue||i.doubleValue),l=de(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(t,e);case 3:return Kl(t.timestampValue,e.timestampValue);case 4:return Kl(zr(t),zr(e));case 5:return Jo(t.stringValue,e.stringValue);case 6:return(function(i,o){const c=Zt(i),l=Zt(o);return c.compareTo(l)})(t.bytesValue,e.bytesValue);case 7:return(function(i,o){const c=i.split("/"),l=o.split("/");for(let h=0;h<c.length&&h<l.length;h++){const f=K(c[h],l[h]);if(f!==0)return f}return K(c.length,l.length)})(t.referenceValue,e.referenceValue);case 8:return(function(i,o){const c=K(de(i.latitude),de(o.latitude));return c!==0?c:K(de(i.longitude),de(o.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return Jl(t.arrayValue,e.arrayValue);case 10:return(function(i,o){const c=i.fields||{},l=o.fields||{},h=c[ui]?.arrayValue,f=l[ui]?.arrayValue,m=K(h?.values?.length||0,f?.values?.length||0);return m!==0?m:Jl(h,f)})(t.mapValue,e.mapValue);case 11:return(function(i,o){if(i===Rs.mapValue&&o===Rs.mapValue)return 0;if(i===Rs.mapValue)return 1;if(o===Rs.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=o.fields||{},f=Object.keys(h);l.sort(),f.sort();for(let m=0;m<l.length&&m<f.length;++m){const _=Jo(l[m],f[m]);if(_!==0)return _;const b=Un(c[l[m]],h[f[m]]);if(b!==0)return b}return K(l.length,f.length)})(t.mapValue,e.mapValue);default:throw L(23264,{he:n})}}function Kl(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return K(t,e);const n=Bt(t),r=Bt(e),s=K(n.seconds,r.seconds);return s!==0?s:K(n.nanos,r.nanos)}function Jl(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Un(n[s],r[s]);if(i)return i}return K(n.length,r.length)}function jn(t){return Qo(t)}function Qo(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const r=Bt(n);return`time(${r.seconds},${r.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Zt(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return z.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Qo(i);return r+"]"})(t.arrayValue):"mapValue"in t?(function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Qo(n.fields[o])}`;return s+"}"})(t.mapValue):L(61005,{value:t})}function xs(t){switch(qt(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Ui(t);return e?16+xs(e):16;case 5:return 2*t.stringValue.length;case 6:return Zt(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,i)=>s+xs(i)),0)})(t.arrayValue);case 10:case 11:return(function(r){let s=0;return mn(r.fields,((i,o)=>{s+=i.length+xs(o)})),s})(t.mapValue);default:throw L(13486,{value:t})}}function Ql(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Yo(t){return!!t&&"integerValue"in t}function pc(t){return!!t&&"arrayValue"in t}function Yl(t){return!!t&&"nullValue"in t}function Xl(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function zs(t){return!!t&&"mapValue"in t}function TR(t){return(t?.mapValue?.fields||{})[Ig]?.stringValue===Ag}function Sr(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return mn(t.mapValue.fields,((n,r)=>e.mapValue.fields[n]=Sr(r))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Sr(t.arrayValue.values[n]);return e}return{...t}}function IR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===wR}class ze{constructor(e){this.value=e}static empty(){return new ze({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!zs(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Sr(n)}setAll(e){let n=Ie.emptyPath(),r={},s=[];e.forEach(((o,c)=>{if(!n.isImmediateParentOf(c)){const l=this.getFieldsMap(n);this.applyChanges(l,r,s),r={},s=[],n=c.popLast()}o?r[c.lastSegment()]=Sr(o):s.push(c.lastSegment())}));const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());zs(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ct(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];zs(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){mn(n,((s,i)=>e[s]=i));for(const s of r)delete e[s]}clone(){return new ze(Sr(this.value))}}function bg(t){const e=[];return mn(t.fields,((n,r)=>{const s=new Ie([n]);if(zs(r)){const i=bg(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)})),new We(e)}class Pe{constructor(e,n,r,s,i,o,c){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Pe(e,0,U.min(),U.min(),U.min(),ze.empty(),0)}static newFoundDocument(e,n,r,s){return new Pe(e,1,n,U.min(),r,s,0)}static newNoDocument(e,n){return new Pe(e,2,n,U.min(),U.min(),ze.empty(),0)}static newUnknownDocument(e,n){return new Pe(e,3,n,U.min(),U.min(),ze.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(U.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=U.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Pe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class li{constructor(e,n){this.position=e,this.inclusive=n}}function eh(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=z.comparator(z.fromName(o.referenceValue),n.key):r=Un(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function th(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ct(t.position[n],e.position[n]))return!1;return!0}class $r{constructor(e,n="asc"){this.field=e,this.dir=n}}function AR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class Sg{}class pe extends Sg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new SR(e,n,r):n==="array-contains"?new kR(e,r):n==="in"?new CR(e,r):n==="not-in"?new NR(e,r):n==="array-contains-any"?new OR(e,r):new pe(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new RR(e,r):new PR(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Un(n,this.value)):n!==null&&qt(this.value)===qt(n)&&this.matchesComparison(Un(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ye extends Sg{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ye(e,n)}matches(e){return Rg(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Rg(t){return t.op==="and"}function Pg(t){return bR(t)&&Rg(t)}function bR(t){for(const e of t.filters)if(e instanceof Ye)return!1;return!0}function Xo(t){if(t instanceof pe)return t.field.canonicalString()+t.op.toString()+jn(t.value);if(Pg(t))return t.filters.map((e=>Xo(e))).join(",");{const e=t.filters.map((n=>Xo(n))).join(",");return`${t.op}(${e})`}}function kg(t,e){return t instanceof pe?(function(r,s){return s instanceof pe&&r.op===s.op&&r.field.isEqual(s.field)&&ct(r.value,s.value)})(t,e):t instanceof Ye?(function(r,s){return s instanceof Ye&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((i,o,c)=>i&&kg(o,s.filters[c])),!0):!1})(t,e):void L(19439)}function Cg(t){return t instanceof pe?(function(n){return`${n.field.canonicalString()} ${n.op} ${jn(n.value)}`})(t):t instanceof Ye?(function(n){return n.op.toString()+" {"+n.getFilters().map(Cg).join(" ,")+"}"})(t):"Filter"}class SR extends pe{constructor(e,n,r){super(e,n,r),this.key=z.fromName(r.referenceValue)}matches(e){const n=z.comparator(e.key,this.key);return this.matchesComparison(n)}}class RR extends pe{constructor(e,n){super(e,"in",n),this.keys=Ng("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class PR extends pe{constructor(e,n){super(e,"not-in",n),this.keys=Ng("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function Ng(t,e){return(e.arrayValue?.values||[]).map((n=>z.fromName(n.referenceValue)))}class kR extends pe{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pc(n)&&Fr(n.arrayValue,this.value)}}class CR extends pe{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Fr(this.value.arrayValue,n)}}class NR extends pe{constructor(e,n){super(e,"not-in",n)}matches(e){if(Fr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Fr(this.value.arrayValue,n)}}class OR extends pe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pc(n)||!n.arrayValue.values)&&n.arrayValue.values.some((r=>Fr(this.value.arrayValue,r)))}}class DR{constructor(e,n=null,r=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function nh(t,e=null,n=[],r=[],s=null,i=null,o=null){return new DR(t,e,n,r,s,i,o)}function mc(t){const e=$(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((r=>Xo(r))).join(","),n+="|ob:",n+=e.orderBy.map((r=>(function(i){return i.field.canonicalString()+i.dir})(r))).join(","),$i(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((r=>jn(r))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((r=>jn(r))).join(",")),e.Te=n}return e.Te}function gc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!AR(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!kg(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!th(t.startAt,e.startAt)&&th(t.endAt,e.endAt)}function ea(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class Xn{constructor(e,n=null,r=[],s=[],i=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function VR(t,e,n,r,s,i,o,c){return new Xn(t,e,n,r,s,i,o,c)}function Og(t){return new Xn(t)}function rh(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function MR(t){return z.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Dg(t){return t.collectionGroup!==null}function Rr(t){const e=$(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new ye(Ie.comparator);return o.filters.forEach((l=>{l.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new $r(i,r))})),n.has(Ie.keyField().canonicalString())||e.Ie.push(new $r(Ie.keyField(),r))}return e.Ie}function st(t){const e=$(t);return e.Ee||(e.Ee=Vg(e,Rr(t))),e.Ee}function xR(t){const e=$(t);return e.Re||(e.Re=Vg(e,t.explicitOrderBy)),e.Re}function Vg(t,e){if(t.limitType==="F")return nh(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((s=>{const i=s.dir==="desc"?"asc":"desc";return new $r(s.field,i)}));const n=t.endAt?new li(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new li(t.startAt.position,t.startAt.inclusive):null;return nh(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ta(t,e){const n=t.filters.concat([e]);return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function zR(t,e){const n=t.explicitOrderBy.concat([e]);return new Xn(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function na(t,e,n){return new Xn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ji(t,e){return gc(st(t),st(e))&&t.limitType===e.limitType}function Mg(t){return`${mc(st(t))}|lt:${t.limitType}`}function An(t){return`Query(target=${(function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map((s=>Cg(s))).join(", ")}]`),$i(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map((s=>jn(s))).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map((s=>jn(s))).join(",")),`Target(${r})`})(st(t))}; limitType=${t.limitType})`}function Bi(t,e){return e.isFoundDocument()&&(function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):z.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)})(t,e)&&(function(r,s){for(const i of Rr(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0})(t,e)&&(function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0})(t,e)&&(function(r,s){return!(r.startAt&&!(function(o,c,l){const h=eh(o,c,l);return o.inclusive?h<=0:h<0})(r.startAt,Rr(r),s)||r.endAt&&!(function(o,c,l){const h=eh(o,c,l);return o.inclusive?h>=0:h>0})(r.endAt,Rr(r),s))})(t,e)}function LR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xg(t){return(e,n)=>{let r=!1;for(const s of Rr(t)){const i=FR(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function FR(t,e,n){const r=t.field.isKeyField()?z.comparator(e.key,n.key):(function(i,o,c){const l=o.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Un(l,h):L(42886)})(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return L(19790,{direction:t.dir})}}class gn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){mn(this.inner,((n,r)=>{for(const[s,i]of r)e(s,i)}))}isEmpty(){return _g(this.inner)}size(){return this.innerSize}}const $R=new ue(z.comparator);function Et(){return $R}const zg=new ue(z.comparator);function Tr(...t){let e=zg;for(const n of t)e=e.insert(n.key,n);return e}function Lg(t){let e=zg;return t.forEach(((n,r)=>e=e.insert(n,r.overlayedDocument))),e}function sn(){return Pr()}function Fg(){return Pr()}function Pr(){return new gn((t=>t.toString()),((t,e)=>t.isEqual(e)))}const UR=new ue(z.comparator),jR=new ye(z.comparator);function J(...t){let e=jR;for(const n of t)e=e.add(n);return e}const BR=new ye(K);function ZR(){return BR}function _c(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ai(e)?"-0":e}}function $g(t){return{integerValue:""+t}}function qR(t,e){return pR(e)?$g(e):_c(t,e)}class Zi{constructor(){this._=void 0}}function GR(t,e,n){return t instanceof Ur?(function(s,i){const o={fields:{[Eg]:{stringValue:vg},[Tg]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&fc(i)&&(i=Ui(i)),i&&(o.fields[wg]=i),{mapValue:o}})(n,e):t instanceof jr?jg(t,e):t instanceof Br?Bg(t,e):(function(s,i){const o=Ug(s,i),c=sh(o)+sh(s.Ae);return Yo(o)&&Yo(s.Ae)?$g(c):_c(s.serializer,c)})(t,e)}function WR(t,e,n){return t instanceof jr?jg(t,e):t instanceof Br?Bg(t,e):n}function Ug(t,e){return t instanceof hi?(function(r){return Yo(r)||(function(i){return!!i&&"doubleValue"in i})(r)})(e)?e:{integerValue:0}:null}class Ur extends Zi{}class jr extends Zi{constructor(e){super(),this.elements=e}}function jg(t,e){const n=Zg(e);for(const r of t.elements)n.some((s=>ct(s,r)))||n.push(r);return{arrayValue:{values:n}}}class Br extends Zi{constructor(e){super(),this.elements=e}}function Bg(t,e){let n=Zg(e);for(const r of t.elements)n=n.filter((s=>!ct(s,r)));return{arrayValue:{values:n}}}class hi extends Zi{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function sh(t){return de(t.integerValue||t.doubleValue)}function Zg(t){return pc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class HR{constructor(e,n){this.field=e,this.transform=n}}function KR(t,e){return t.field.isEqual(e.field)&&(function(r,s){return r instanceof jr&&s instanceof jr||r instanceof Br&&s instanceof Br?$n(r.elements,s.elements,ct):r instanceof hi&&s instanceof hi?ct(r.Ae,s.Ae):r instanceof Ur&&s instanceof Ur})(t.transform,e.transform)}class JR{constructor(e,n){this.version=e,this.transformResults=n}}class Ke{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ke}static exists(e){return new Ke(void 0,e)}static updateTime(e){return new Ke(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ls(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class qi{}function qg(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yc(t.key,Ke.none()):new ts(t.key,t.data,Ke.none());{const n=t.data,r=ze.empty();let s=new ye(Ie.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new _n(t.key,r,new We(s.toArray()),Ke.none())}}function QR(t,e,n){t instanceof ts?(function(s,i,o){const c=s.value.clone(),l=oh(s.fieldTransforms,i,o.transformResults);c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(t,e,n):t instanceof _n?(function(s,i,o){if(!Ls(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=oh(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(Gg(s)),l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()})(t,e,n):(function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,n)}function kr(t,e,n,r){return t instanceof ts?(function(i,o,c,l){if(!Ls(i.precondition,o))return c;const h=i.value.clone(),f=ah(i.fieldTransforms,l,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(t,e,n,r):t instanceof _n?(function(i,o,c,l){if(!Ls(i.precondition,o))return c;const h=ah(i.fieldTransforms,l,o),f=o.data;return f.setAll(Gg(i)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map((m=>m.field)))})(t,e,n,r):(function(i,o,c){return Ls(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(t,e,n)}function YR(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=Ug(r.transform,s||null);i!=null&&(n===null&&(n=ze.empty()),n.set(r.field,i))}return n||null}function ih(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&$n(r,s,((i,o)=>KR(i,o)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ts extends qi{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class _n extends qi{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Gg(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}})),e}function oh(t,e,n){const r=new Map;ee(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);r.set(i.field,WR(o,c,n[s]))}return r}function ah(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,GR(i,o,e))}return r}class yc extends qi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class XR extends qi{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class eP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&QR(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=kr(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=kr(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Fg();return this.mutations.forEach((s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(s.key)?null:c;const l=qg(o,c);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(U.min())})),r}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),J())}isEqual(e){return this.batchId===e.batchId&&$n(this.mutations,e.mutations,((n,r)=>ih(n,r)))&&$n(this.baseMutations,e.baseMutations,((n,r)=>ih(n,r)))}}class vc{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){ee(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=(function(){return UR})();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new vc(e,n,r,s)}}class tP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class nP{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}class rP{constructor(e,n){this.count=e,this.unchangedNames=n}}var fe,Y;function sP(t){switch(t){case P.OK:return L(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return L(15467,{code:t})}}function Wg(t){if(t===void 0)return vt("GRPC error has no .code"),P.UNKNOWN;switch(t){case fe.OK:return P.OK;case fe.CANCELLED:return P.CANCELLED;case fe.UNKNOWN:return P.UNKNOWN;case fe.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case fe.INTERNAL:return P.INTERNAL;case fe.UNAVAILABLE:return P.UNAVAILABLE;case fe.UNAUTHENTICATED:return P.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case fe.NOT_FOUND:return P.NOT_FOUND;case fe.ALREADY_EXISTS:return P.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return P.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case fe.ABORTED:return P.ABORTED;case fe.OUT_OF_RANGE:return P.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return P.UNIMPLEMENTED;case fe.DATA_LOSS:return P.DATA_LOSS;default:return L(39323,{code:t})}}(Y=fe||(fe={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";function iP(){return new TextEncoder}const oP=new Ft([4294967295,4294967295],0);function ch(t){const e=iP().encode(t),n=new og;return n.update(e),new Uint8Array(n.digest())}function uh(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ft([n,r],0),new Ft([s,i],0)]}class Ec{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ir(`Invalid padding: ${n}`);if(r<0)throw new Ir(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ir(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ir(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Ft.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Ft.fromNumber(r)));return s.compare(oP)===1&&(s=new Ft([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ch(e),[r,s]=uh(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Ec(i,s,n);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;const n=ch(e),[r,s]=uh(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ir extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Gi{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,ns.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Gi(U.min(),s,new ue(K),Et(),J())}}class ns{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new ns(r,n,J(),J(),J())}}class Fs{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class Hg{constructor(e,n){this.targetId=e,this.Ce=n}}class Kg{constructor(e,n,r=Ae.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class lh{constructor(){this.ve=0,this.Fe=hh(),this.Me=Ae.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=J(),n=J(),r=J();return this.Fe.forEach(((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:L(38017,{changeType:i})}})),new ns(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=hh()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,ee(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class aP{constructor(e){this.Ge=e,this.ze=new Map,this.je=Et(),this.He=Ps(),this.Je=Ps(),this.Ze=new ue(K)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:L(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((r,s)=>{this.rt(s)&&n(s)}))}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(ea(i))if(r===0){const o=new z(i.path);this.et(n,o,Pe.newNoDocument(o,U.min()))}else ee(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const c=this.ut(e),l=c?this.ct(c,e,o):1;if(l!==0){this.it(n);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,h)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,c;try{o=Zt(r).toUint8Array()}catch(l){if(l instanceof yg)return dn("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Ec(o,s,i)}catch(l){return dn(l instanceof Ir?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach((i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),s++)})),s}Tt(e){const n=new Map;this.ze.forEach(((i,o)=>{const c=this.ot(o);if(c){if(i.current&&ea(c.target)){const l=new z(c.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,Pe.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}}));let r=J();this.Je.forEach(((i,o)=>{let c=!0;o.forEachWhile((l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(i))})),this.je.forEach(((i,o)=>o.setReadTime(e)));const s=new Gi(e,n,this.Ze,this.je,r);return this.je=Et(),this.He=Ps(),this.Je=Ps(),this.Ze=new ue(K),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new lh,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new ye(K),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new ye(K),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||x("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new lh),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Ps(){return new ue(z.comparator)}function hh(){return new ue(z.comparator)}const cP={asc:"ASCENDING",desc:"DESCENDING"},uP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},lP={and:"AND",or:"OR"};class hP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ra(t,e){return t.useProto3Json||$i(e)?e:{value:e}}function di(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Jg(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function dP(t,e){return di(t,e.toTimestamp())}function it(t){return ee(!!t,49232),U.fromTimestamp((function(n){const r=Bt(n);return new te(r.seconds,r.nanos)})(t))}function wc(t,e){return sa(t,e).canonicalString()}function sa(t,e){const n=(function(s){return new re(["projects",s.projectId,"databases",s.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Qg(t){const e=re.fromString(t);return ee(r_(e),10190,{key:e.toString()}),e}function ia(t,e){return wc(t.databaseId,e.path)}function No(t,e){const n=Qg(e);if(n.get(1)!==t.databaseId.projectId)throw new V(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new V(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new z(Xg(n))}function Yg(t,e){return wc(t.databaseId,e)}function fP(t){const e=Qg(t);return e.length===4?re.emptyPath():Xg(e)}function oa(t){return new re(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Xg(t){return ee(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function dh(t,e,n){return{name:ia(t,e),fields:n.value.mapValue.fields}}function pP(t,e){let n;if("targetChange"in e){e.targetChange;const r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:L(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=(function(h,f){return h.useProto3Json?(ee(f===void 0||typeof f=="string",58123),Ae.fromBase64String(f||"")):(ee(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),Ae.fromUint8Array(f||new Uint8Array))})(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){const f=h.code===void 0?P.UNKNOWN:Wg(h.code);return new V(f,h.message||"")})(o);n=new Kg(r,s,i,c||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=No(t,r.document.name),i=it(r.document.updateTime),o=r.document.createTime?it(r.document.createTime):U.min(),c=new ze({mapValue:{fields:r.document.fields}}),l=Pe.newFoundDocument(s,i,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];n=new Fs(h,f,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=No(t,r.document),i=r.readTime?it(r.readTime):U.min(),o=Pe.newNoDocument(s,i),c=r.removedTargetIds||[];n=new Fs([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=No(t,r.document),i=r.removedTargetIds||[];n=new Fs([],i,s,null)}else{if(!("filter"in e))return L(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new rP(s,i),c=r.targetId;n=new Hg(c,o)}}return n}function mP(t,e){let n;if(e instanceof ts)n={update:dh(t,e.key,e.value)};else if(e instanceof yc)n={delete:ia(t,e.key)};else if(e instanceof _n)n={update:dh(t,e.key,e.data),updateMask:AP(e.fieldMask)};else{if(!(e instanceof XR))return L(16599,{dt:e.type});n={verify:ia(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((r=>(function(i,o){const c=o.transform;if(c instanceof Ur)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof jr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Br)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof hi)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw L(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(n.currentDocument=(function(s,i){return i.updateTime!==void 0?{updateTime:dP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:L(27497)})(t,e.precondition)),n}function gP(t,e){return t&&t.length>0?(ee(e!==void 0,14353),t.map((n=>(function(s,i){let o=s.updateTime?it(s.updateTime):it(i);return o.isEqual(U.min())&&(o=it(i)),new JR(o,s.transformResults||[])})(n,e)))):[]}function _P(t,e){return{documents:[Yg(t,e.path)]}}function e_(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Yg(t,s);const i=(function(h){if(h.length!==0)return n_(Ye.create(h,"and"))})(e.filters);i&&(n.structuredQuery.where=i);const o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:Dt(_.field),direction:wP(_.dir)}})(f)))})(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=ra(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:n,parent:s}}function yP(t,e,n,r){const{ft:s,parent:i}=e_(t,e),o={},c=[];let l=0;return n.forEach((h=>{const f="aggregate_"+l++;o[f]=h.alias,h.aggregateType==="count"?c.push({alias:f,count:{}}):h.aggregateType==="avg"?c.push({alias:f,avg:{field:Dt(h.fieldPath)}}):h.aggregateType==="sum"&&c.push({alias:f,sum:{field:Dt(h.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:c,structuredQuery:s.structuredQuery},parent:s.parent},gt:o,parent:i}}function vP(t){let e=fP(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){ee(r===1,65062);const f=n.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];n.where&&(i=(function(m){const _=t_(m);return _ instanceof Ye&&Pg(_)?_.getFilters():[_]})(n.where));let o=[];n.orderBy&&(o=(function(m){return m.map((_=>(function(N){return new $r(bn(N.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(_)))})(n.orderBy));let c=null;n.limit&&(c=(function(m){let _;return _=typeof m=="object"?m.value:m,$i(_)?null:_})(n.limit));let l=null;n.startAt&&(l=(function(m){const _=!!m.before,b=m.values||[];return new li(b,_)})(n.startAt));let h=null;return n.endAt&&(h=(function(m){const _=!m.before,b=m.values||[];return new li(b,_)})(n.endAt)),VR(e,s,o,i,c,"F",l,h)}function EP(t,e){const n=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L(28987,{purpose:s})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function t_(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=bn(n.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=bn(n.unaryFilter.field);return pe.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=bn(n.unaryFilter.field);return pe.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bn(n.unaryFilter.field);return pe.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return L(61313);default:return L(60726)}})(t):t.fieldFilter!==void 0?(function(n){return pe.create(bn(n.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return L(58110);default:return L(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Ye.create(n.compositeFilter.filters.map((r=>t_(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return L(1026)}})(n.compositeFilter.op))})(t):L(30097,{filter:t})}function wP(t){return cP[t]}function TP(t){return uP[t]}function IP(t){return lP[t]}function Dt(t){return{fieldPath:t.canonicalString()}}function bn(t){return Ie.fromServerFormat(t.fieldPath)}function n_(t){return t instanceof pe?(function(n){if(n.op==="=="){if(Xl(n.value))return{unaryFilter:{field:Dt(n.field),op:"IS_NAN"}};if(Yl(n.value))return{unaryFilter:{field:Dt(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Xl(n.value))return{unaryFilter:{field:Dt(n.field),op:"IS_NOT_NAN"}};if(Yl(n.value))return{unaryFilter:{field:Dt(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Dt(n.field),op:TP(n.op),value:n.value}}})(t):t instanceof Ye?(function(n){const r=n.getFilters().map((s=>n_(s)));return r.length===1?r[0]:{compositeFilter:{op:IP(n.op),filters:r}}})(t):L(54877,{filter:t})}function AP(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function r_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function s_(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}class Vt{constructor(e,n,r,s,i=U.min(),o=U.min(),c=Ae.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new Vt(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vt(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class bP{constructor(e){this.yt=e}}function SP(t){const e=vP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?na(e,e.limit,"L"):e}class RP{constructor(){this.Sn=new PP}addToCollectionParentIndex(e,n){return this.Sn.add(n),k.resolve()}getCollectionParents(e,n){return k.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return k.resolve()}deleteFieldIndex(e,n){return k.resolve()}deleteAllFieldIndexes(e){return k.resolve()}createTargetIndexes(e,n){return k.resolve()}getDocumentsMatchingTarget(e,n){return k.resolve(null)}getIndexType(e,n){return k.resolve(0)}getFieldIndexes(e,n){return k.resolve([])}getNextCollectionGroupToUpdate(e){return k.resolve(null)}getMinOffset(e,n){return k.resolve(jt.min())}getMinOffsetFromCollectionGroup(e,n){return k.resolve(jt.min())}updateCollectionGroup(e,n,r){return k.resolve()}updateIndexEntries(e,n){return k.resolve()}}class PP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ye(re.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ye(re.comparator)).toArray()}}const fh={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},i_=41943040;class Ve{static withCacheSize(e){return new Ve(e,Ve.DEFAULT_COLLECTION_PERCENTILE,Ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}Ve.DEFAULT_COLLECTION_PERCENTILE=10,Ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ve.DEFAULT=new Ve(i_,Ve.DEFAULT_COLLECTION_PERCENTILE,Ve.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ve.DISABLED=new Ve(-1,0,0);class Bn{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Bn(0)}static ar(){return new Bn(-1)}}const ph="LruGarbageCollector",kP=1048576;function mh([t,e],[n,r]){const s=K(t,n);return s===0?K(e,r):s}class CP{constructor(e){this.Pr=e,this.buffer=new ye(mh),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();mh(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class NP{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){x(ph,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Yn(n)?x(ph,"Ignoring IndexedDB error during garbage collection: ",n):await Qn(n)}await this.Ar(3e5)}))}}class OP{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next((r=>Math.floor(n/100*r)))}nthSequenceNumber(e,n){if(n===0)return k.resolve(Fi.ce);const r=new CP(n);return this.Vr.forEachTarget(e,(s=>r.Er(s.sequenceNumber))).next((()=>this.Vr.mr(e,(s=>r.Er(s))))).next((()=>r.maxValue))}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(x("LruGarbageCollector","Garbage collection skipped; disabled"),k.resolve(fh)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fh):this.gr(e,n)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,c,l,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,n)))).next((m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),In()<=H.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${s} in `+(c-o)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-f}ms`),k.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m}))))}}function DP(t,e){return new OP(t,e)}class VP{constructor(){this.changes=new gn((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Pe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?k.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class MP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class xP{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,n)))).next((s=>(r!==null&&kr(r.mutation,s,We.empty(),te.now()),s)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.getLocalViewOfDocuments(e,r,J()).next((()=>r))))}getLocalViewOfDocuments(e,n,r=J()){const s=sn();return this.populateOverlays(e,s,n).next((()=>this.computeViews(e,n,s,r).next((i=>{let o=Tr();return i.forEach(((c,l)=>{o=o.insert(c,l.overlayedDocument)})),o}))))}getOverlayedDocuments(e,n){const r=sn();return this.populateOverlays(e,r,n).next((()=>this.computeViews(e,n,r,J())))}populateOverlays(e,n,r){const s=[];return r.forEach((i=>{n.has(i)||s.push(i)})),this.documentOverlayCache.getOverlays(e,s).next((i=>{i.forEach(((o,c)=>{n.set(o,c)}))}))}computeViews(e,n,r,s){let i=Et();const o=Pr(),c=(function(){return Pr()})();return n.forEach(((l,h)=>{const f=r.get(h.key);s.has(h.key)&&(f===void 0||f.mutation instanceof _n)?i=i.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),kr(f.mutation,h,f.mutation.getFieldMask(),te.now())):o.set(h.key,We.empty())})),this.recalculateAndSaveOverlays(e,i).next((l=>(l.forEach(((h,f)=>o.set(h,f))),n.forEach(((h,f)=>c.set(h,new MP(f,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,n){const r=Pr();let s=new ue(((o,c)=>o-c)),i=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((o=>{for(const c of o)c.keys().forEach((l=>{const h=n.get(l);if(h===null)return;let f=r.get(l)||We.empty();f=c.applyToLocalView(h,f),r.set(l,f);const m=(s.get(c.batchId)||J()).add(l);s=s.insert(c.batchId,m)}))})).next((()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,f=l.value,m=Fg();f.forEach((_=>{if(!i.has(_)){const b=qg(n.get(_),r.get(_));b!==null&&m.set(_,b),i=i.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return k.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,n,r,s){return MR(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Dg(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next((i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):k.resolve(sn());let c=xr,l=i;return o.next((h=>k.forEach(h,((f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?k.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{l=l.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,i))).next((()=>this.computeViews(e,l,h,J()))).next((f=>({batchId:c,changes:Lg(f)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new z(n)).next((r=>{let s=Tr();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Tr();return this.indexManager.getCollectionParents(e,i).next((c=>k.forEach(c,(l=>{const h=(function(m,_){return new Xn(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,r,s).next((f=>{f.forEach(((m,_)=>{o=o.insert(m,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s)))).next((o=>{i.forEach(((l,h)=>{const f=h.getKey();o.get(f)===null&&(o=o.insert(f,Pe.newInvalidDocument(f)))}));let c=Tr();return o.forEach(((l,h)=>{const f=i.get(l);f!==void 0&&kr(f.mutation,h,We.empty(),te.now()),Bi(n,h)&&(c=c.insert(l,h))})),c}))}}class zP{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return k.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,(function(s){return{id:s.id,version:s.version,createTime:it(s.createTime)}})(n)),k.resolve()}getNamedQuery(e,n){return k.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,(function(s){return{name:s.name,query:SP(s.bundledQuery),readTime:it(s.readTime)}})(n)),k.resolve()}}class LP{constructor(){this.overlays=new ue(z.comparator),this.Lr=new Map}getOverlay(e,n){return k.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sn();return k.forEach(n,(s=>this.getOverlay(e,s).next((i=>{i!==null&&r.set(s,i)})))).next((()=>r))}saveOverlays(e,n,r){return r.forEach(((s,i)=>{this.bt(e,n,i)})),k.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach((i=>this.overlays=this.overlays.remove(i))),this.Lr.delete(r)),k.resolve()}getOverlaysForCollection(e,n,r){const s=sn(),i=n.length+1,o=new z(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return k.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ue(((h,f)=>h-f));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let f=i.get(h.largestBatchId);f===null&&(f=sn(),i=i.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const c=sn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach(((h,f)=>c.set(h,f))),!(c.size()>=s)););return k.resolve(c)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new tP(n,r));let i=this.Lr.get(n);i===void 0&&(i=J(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}class FP{constructor(){this.sessionToken=Ae.EMPTY_BYTE_STRING}getSessionToken(e){return k.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,k.resolve()}}class Tc{constructor(){this.kr=new ye(we.Kr),this.qr=new ye(we.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new we(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach((r=>this.addReference(r,n)))}removeReference(e,n){this.Wr(new we(e,n))}Qr(e,n){e.forEach((r=>this.removeReference(r,n)))}Gr(e){const n=new z(new re([])),r=new we(n,e),s=new we(n,e+1),i=[];return this.qr.forEachInRange([r,s],(o=>{this.Wr(o),i.push(o.key)})),i}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new z(new re([])),r=new we(n,e),s=new we(n,e+1);let i=J();return this.qr.forEachInRange([r,s],(o=>{i=i.add(o.key)})),i}containsKey(e){const n=new we(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class we{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return z.comparator(e.key,n.key)||K(e.Hr,n.Hr)}static Ur(e,n){return K(e.Hr,n.Hr)||z.comparator(e.key,n.key)}}class $P{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new ye(we.Kr)}checkEmpty(e){return k.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new eP(i,n,r,s);this.mutationQueue.push(o);for(const c of s)this.Jr=this.Jr.add(new we(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return k.resolve(o)}lookupMutationBatch(e,n){return k.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return k.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return k.resolve(this.mutationQueue.length===0?dc:this.Yn-1)}getAllMutationBatches(e){return k.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new we(n,0),s=new we(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],(o=>{const c=this.Zr(o.Hr);i.push(c)})),k.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ye(K);return n.forEach((s=>{const i=new we(s,0),o=new we(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],(c=>{r=r.add(c.Hr)}))})),k.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;z.isDocumentKey(i)||(i=i.child(""));const o=new we(new z(i),0);let c=new ye(K);return this.Jr.forEachWhile((l=>{const h=l.key.path;return!!r.isPrefixOf(h)&&(h.length===s&&(c=c.add(l.Hr)),!0)}),o),k.resolve(this.Yr(c))}Yr(e){const n=[];return e.forEach((r=>{const s=this.Zr(r);s!==null&&n.push(s)})),n}removeMutationBatch(e,n){ee(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return k.forEach(n.mutations,(s=>{const i=new we(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Jr=r}))}nr(e){}containsKey(e,n){const r=new we(n,0),s=this.Jr.firstAfterOrEqual(r);return k.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,k.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class UP{constructor(e){this.ti=e,this.docs=(function(){return new ue(z.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return k.resolve(r?r.document.mutableCopy():Pe.newInvalidDocument(n))}getEntries(e,n){let r=Et();return n.forEach((s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Pe.newInvalidDocument(s))})),k.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Et();const o=n.path,c=new z(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:f}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||lR(uR(f),r)<=0||(s.has(f.key)||Bi(n,f))&&(i=i.insert(f.key,f.mutableCopy()))}return k.resolve(i)}getAllFromCollectionGroup(e,n,r,s){L(9500)}ni(e,n){return k.forEach(this.docs,(r=>n(r)))}newChangeBuffer(e){return new jP(this)}getSize(e){return k.resolve(this.size)}}class jP extends VP{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)})),k.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}class BP{constructor(e){this.persistence=e,this.ri=new gn((n=>mc(n)),gc),this.lastRemoteSnapshotVersion=U.min(),this.highestTargetId=0,this.ii=0,this.si=new Tc,this.targetCount=0,this.oi=Bn._r()}forEachTarget(e,n){return this.ri.forEach(((r,s)=>n(s))),k.resolve()}getLastRemoteSnapshotVersion(e){return k.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return k.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),k.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),k.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Bn(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,k.resolve()}updateTargetData(e,n){return this.lr(n),k.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,k.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach(((o,c)=>{c.sequenceNumber<=n&&r.get(c.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)})),k.waitFor(i).next((()=>s))}getTargetCount(e){return k.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return k.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),k.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach((o=>{i.push(s.markPotentiallyOrphaned(e,o))})),k.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),k.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return k.resolve(r)}containsKey(e,n){return k.resolve(this.si.containsKey(n))}}class o_{constructor(e,n){this._i={},this.overlays={},this.ai=new Fi(0),this.ui=!1,this.ui=!0,this.ci=new FP,this.referenceDelegate=e(this),this.li=new BP(this),this.indexManager=new RP,this.remoteDocumentCache=(function(s){return new UP(s)})((r=>this.referenceDelegate.hi(r))),this.serializer=new bP(n),this.Pi=new zP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new LP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new $P(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){x("MemoryPersistence","Starting transaction:",e);const s=new ZP(this.ai.next());return this.referenceDelegate.Ti(),r(s).next((i=>this.referenceDelegate.Ii(s).next((()=>i)))).toPromise().then((i=>(s.raiseOnCommittedEvent(),i)))}Ei(e,n){return k.or(Object.values(this._i).map((r=>()=>r.containsKey(e,n))))}}class ZP extends dR{constructor(e){super(),this.currentSequenceNumber=e}}class Ic{constructor(e){this.persistence=e,this.Ri=new Tc,this.Ai=null}static Vi(e){return new Ic(e)}get di(){if(this.Ai)return this.Ai;throw L(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),k.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),k.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),k.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach((s=>this.di.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next((s=>{s.forEach((i=>this.di.add(i.toString())))})).next((()=>r.removeTargetData(e,n)))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return k.forEach(this.di,(r=>{const s=z.fromPath(r);return this.mi(e,s).next((i=>{i||n.removeEntry(s,U.min())}))})).next((()=>(this.Ai=null,n.apply(e))))}updateLimboDocument(e,n){return this.mi(e,n).next((r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())}))}hi(e){return 0}mi(e,n){return k.or([()=>k.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class fi{constructor(e,n){this.persistence=e,this.fi=new gn((r=>mR(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=DP(this,n)}static Vi(e,n){return new fi(e,n)}Ti(){}Ii(e){return k.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>n.next((s=>r+s))))}pr(e){let n=0;return this.mr(e,(r=>{n++})).next((()=>n))}mr(e,n){return k.forEach(this.fi,((r,s)=>this.wr(e,r,s).next((i=>i?k.resolve():n(s)))))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,(o=>this.wr(e,o,n).next((c=>{c||(r++,i.removeEntry(o,U.min()))})))).next((()=>i.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),k.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),k.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),k.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),k.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=xs(e.data.value)),n}wr(e,n,r){return k.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return k.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Ac{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=J(),s=J();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ac(e,n.fromCache,r,s)}}class qP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class GP{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return VI()?8:fR(ke())>0?6:4})()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next((o=>{i.result=o})).next((()=>{if(!i.result)return this.ps(e,n,s,r).next((o=>{i.result=o}))})).next((()=>{if(i.result)return;const o=new qP;return this.ys(e,n,o).next((c=>{if(i.result=c,this.As)return this.ws(e,n,o,c.size)}))})).next((()=>i.result))}ws(e,n,r,s){return r.documentReadCount<this.Vs?(In()<=H.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",An(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),k.resolve()):(In()<=H.DEBUG&&x("QueryEngine","Query:",An(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(In()<=H.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",An(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,st(n))):k.resolve())}gs(e,n){if(rh(n))return k.resolve(null);let r=st(n);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(n.limit!==null&&s===1&&(n=na(n,null,"F"),r=st(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next((i=>{const o=J(...i);return this.fs.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((l=>{const h=this.bs(n,c);return this.Ss(n,h,o,l.readTime)?this.gs(e,na(n,null,"F")):this.Ds(e,h,n,l)}))))})))))}ps(e,n,r,s){return rh(n)||s.isEqual(U.min())?k.resolve(null):this.fs.getDocuments(e,r).next((i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?k.resolve(null):(In()<=H.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),An(n)),this.Ds(e,o,n,cR(s,xr)).next((c=>c)))}))}bs(e,n){let r=new ye(xg(e));return n.forEach(((s,i)=>{Bi(e,i)&&(r=r.add(i))})),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return In()<=H.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",An(n)),this.fs.getDocumentsMatchingQuery(e,n,jt.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next((i=>(n.forEach((o=>{i=i.insert(o.key,o)})),i)))}}const bc="LocalStore",WP=3e8;class HP{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new ue(K),this.Fs=new gn((i=>mc(i)),gc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new xP(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.vs)))}}function KP(t,e,n,r){return new HP(t,e,n,r)}async function a_(t,e){const n=$(t);return await n.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next((i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r)))).next((i=>{const o=[],c=[];let l=J();for(const h of s){o.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}for(const h of i){c.push(h.batchId);for(const f of h.mutations)l=l.add(f.key)}return n.localDocuments.getDocuments(r,l).next((h=>({Ns:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function JP(t,e){const n=$(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return(function(c,l,h,f){const m=h.batch,_=m.keys();let b=k.resolve();return _.forEach((N=>{b=b.next((()=>f.getEntry(l,N))).next((O=>{const M=h.docVersions.get(N);ee(M!==null,48541),O.version.compareTo(M)<0&&(m.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),f.addEntry(O)))}))})),b.next((()=>c.mutationQueue.removeMutationBatch(l,m)))})(n,r,e,i).next((()=>i.apply(r))).next((()=>n.mutationQueue.performConsistencyCheck(r))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=J();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l})(e)))).next((()=>n.localDocuments.getDocuments(r,s)))}))}function c_(t){const e=$(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.li.getLastRemoteSnapshotVersion(n)))}function QP(t,e){const n=$(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const c=[];e.targetChanges.forEach(((f,m)=>{const _=s.get(m);if(!_)return;c.push(n.li.removeMatchingKeys(i,f.removedDocuments,m).next((()=>n.li.addMatchingKeys(i,f.addedDocuments,m))));let b=_.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?b=b.withResumeToken(Ae.EMPTY_BYTE_STRING,U.min()).withLastLimboFreeSnapshotVersion(U.min()):f.resumeToken.approximateByteSize()>0&&(b=b.withResumeToken(f.resumeToken,r)),s=s.insert(m,b),(function(O,M,W){return O.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=WP?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0})(_,b,f)&&c.push(n.li.updateTargetData(i,b))}));let l=Et(),h=J();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,f))})),c.push(YP(i,o,e.documentUpdates).next((f=>{l=f.Bs,h=f.Ls}))),!r.isEqual(U.min())){const f=n.li.getLastRemoteSnapshotVersion(i).next((m=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r)));c.push(f)}return k.waitFor(c).next((()=>o.apply(i))).next((()=>n.localDocuments.getLocalViewOfDocuments(i,l,h))).next((()=>l))})).then((i=>(n.vs=s,i)))}function YP(t,e,n){let r=J(),s=J();return n.forEach((i=>r=r.add(i))),e.getEntries(t,r).next((i=>{let o=Et();return n.forEach(((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(c)),l.isNoDocument()&&l.version.isEqual(U.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):x(bc,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)})),{Bs:o,Ls:s}}))}function XP(t,e){const n=$(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=dc),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function e0(t,e){const n=$(t);return n.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return n.li.getTargetData(r,e).next((i=>i?(s=i,k.resolve(s)):n.li.allocateTargetId(r).next((o=>(s=new Vt(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r}))}async function aa(t,e,n){const r=$(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,(o=>r.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Yn(o))throw o;x(bc,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function gh(t,e,n){const r=$(t);let s=U.min(),i=J();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(l,h,f){const m=$(l),_=m.Fs.get(f);return _!==void 0?k.resolve(m.vs.get(_)):m.li.getTargetData(h,f)})(r,o,st(e)).next((c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,c.targetId).next((l=>{i=l}))})).next((()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:U.min(),n?i:J()))).next((c=>(t0(r,LR(e),c),{documents:c,ks:i})))))}function t0(t,e,n){let r=t.Ms.get(e)||U.min();n.forEach(((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)})),t.Ms.set(e,r)}class _h{constructor(){this.activeTargetIds=ZR()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class n0{constructor(){this.vo=new _h,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new _h,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class r0{Mo(e){}shutdown(){}}const yh="ConnectivityMonitor";class vh{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){x(yh,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){x(yh,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let ks=null;function ca(){return ks===null?ks=(function(){return 268435456+Math.round(2147483648*Math.random())})():ks++,"0x"+ks.toString(16)}const Oo="RestConnection",s0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class i0{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===ci?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=ca(),c=this.Qo(e,n.toUriEncodedString());x(Oo,`Sending RPC '${e}' ${o}:`,c,r);const l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(l,s,i);const{host:h}=new URL(c),f=Wn(h);return this.zo(e,c,l,r,f).then((m=>(x(Oo,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw dn(Oo,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",r),m}))}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Jn})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((s,i)=>e[i]=s)),r&&r.headers.forEach(((s,i)=>e[i]=s))}Qo(e,n){const r=s0[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}class o0{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}const Se="WebChannelConnection",vr=(t,e,n)=>{t.listen(e,(r=>{try{n(r)}catch(s){setTimeout((()=>{throw s}),0)}}))};class Cn extends i0{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Cn.c_){const e=lg();vr(e,ug.STAT_EVENT,(n=>{n.stat===Ko.PROXY?x(Se,"STAT_EVENT: detected buffering proxy"):n.stat===Ko.NOPROXY&&x(Se,"STAT_EVENT: detected no buffering proxy")})),Cn.c_=!0}}zo(e,n,r,s,i){const o=ca();return new Promise(((c,l)=>{const h=new ag;h.setWithCredentials(!0),h.listenOnce(cg.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ms.NO_ERROR:const m=h.getResponseJson();x(Se,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case Ms.TIMEOUT:x(Se,`RPC '${e}' ${o} timed out`),l(new V(P.DEADLINE_EXCEEDED,"Request time out"));break;case Ms.HTTP_ERROR:const _=h.getStatus();if(x(Se,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let b=h.getResponseJson();Array.isArray(b)&&(b=b[0]);const N=b?.error;if(N&&N.status&&N.message){const O=(function(W){const Q=W.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(Q)>=0?Q:P.UNKNOWN})(N.status);l(new V(O,N.message))}else l(new V(P.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new V(P.UNAVAILABLE,"Connection failed."));break;default:L(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{x(Se,`RPC '${e}' ${o} completed.`)}}));const f=JSON.stringify(s);x(Se,`RPC '${e}' ${o} sending request:`,s),h.send(n,"POST",f,r,15)}))}T_(e,n,r){const s=ca(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Go(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=i.join("");x(Se,`Creating RPC '${e}' stream ${s}: ${h}`,c);const f=o.createWebChannel(h,c);this.I_(f);let m=!1,_=!1;const b=new o0({Ho:N=>{_?x(Se,`Not sending because RPC '${e}' stream ${s} is closed:`,N):(m||(x(Se,`Opening RPC '${e}' stream ${s} transport.`),f.open(),m=!0),x(Se,`RPC '${e}' stream ${s} sending:`,N),f.send(N))},Jo:()=>f.close()});return vr(f,wr.EventType.OPEN,(()=>{_||(x(Se,`RPC '${e}' stream ${s} transport opened.`),b.i_())})),vr(f,wr.EventType.CLOSE,(()=>{_||(_=!0,x(Se,`RPC '${e}' stream ${s} transport closed`),b.o_(),this.E_(f))})),vr(f,wr.EventType.ERROR,(N=>{_||(_=!0,dn(Se,`RPC '${e}' stream ${s} transport errored. Name:`,N.name,"Message:",N.message),b.o_(new V(P.UNAVAILABLE,"The operation could not be completed")))})),vr(f,wr.EventType.MESSAGE,(N=>{if(!_){const O=N.data[0];ee(!!O,16349);const M=O,W=M?.error||M[0]?.error;if(W){x(Se,`RPC '${e}' stream ${s} received error:`,W);const Q=W.status;let G=(function(ve){const w=fe[ve];if(w!==void 0)return Wg(w)})(Q),X=W.message;Q==="NOT_FOUND"&&X.includes("database")&&X.includes("does not exist")&&X.includes(this.databaseId.database)&&dn(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),G===void 0&&(G=P.INTERNAL,X="Unknown error status: "+Q+" with message "+W.message),_=!0,b.o_(new V(G,X)),f.close()}else x(Se,`RPC '${e}' stream ${s} received:`,O),b.__(O)}})),Cn.u_(),setTimeout((()=>{b.s_()}),0),b}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((n=>n===e))}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return hg()}}function a0(t){return new Cn(t)}function Do(){return typeof document<"u"?document:null}function Wi(t){return new hP(t,!0)}Cn.c_=!1;class u_{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&x("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}const Eh="PersistentStream";class l_{constructor(e,n,r,s,i,o,c,l){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new u_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===P.RESOURCE_EXHAUSTED?(vt(n.toString()),vt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.D_===n&&this.G_(r,s)}),(r=>{e((()=>{const s=new V(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)}))}))}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.Yo((()=>{r((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((s=>{r((()=>this.z_(s)))})),this.stream.onMessage((s=>{r((()=>++this.F_==1?this.H_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return x(Eh,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget((()=>this.D_===e?n():(x(Eh,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class c0 extends l_{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=pP(this.serializer,e),r=(function(i){if(!("targetChange"in i))return U.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?U.min():o.readTime?it(o.readTime):U.min()})(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=oa(this.serializer),n.addTarget=(function(i,o){let c;const l=o.target;if(c=ea(l)?{documents:_P(i,l)}:{query:e_(i,l).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=Jg(i,o.resumeToken);const h=ra(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(U.min())>0){c.readTime=di(i,o.snapshotVersion.toTimestamp());const h=ra(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);const r=EP(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=oa(this.serializer),n.removeTarget=e,this.K_(n)}}class u0 extends l_{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return ee(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ee(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=gP(e.writeResults,e.commitTime),r=it(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=oa(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((r=>mP(this.serializer,r)))};this.K_(n)}}class l0{}class h0 extends l0{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new V(P.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.Wo(e,sa(n,r),s,i,o))).catch((i=>{throw i.name==="FirebaseError"?(i.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new V(P.UNKNOWN,i.toString())}))}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.jo(e,sa(n,r),s,o,c,i))).catch((o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new V(P.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function d0(t,e,n,r){return new h0(t,e,n,r)}class f0{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(vt(n),this.aa=!1):x("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const fn="RemoteStore";class p0{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo((o=>{r.enqueueAndForget((async()=>{yn(this)&&(x(fn,"Restarting streams for network reachability change."),await(async function(l){const h=$(l);h.Ea.add(4),await rs(h),h.Va.set("Unknown"),h.Ea.delete(4),await Hi(h)})(this))}))})),this.Va=new f0(r,s)}}async function Hi(t){if(yn(t))for(const e of t.Ra)await e(!0)}async function rs(t){for(const e of t.Ra)await e(!1)}function h_(t,e){const n=$(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),kc(n)?Pc(n):er(n).O_()&&Rc(n,e))}function Sc(t,e){const n=$(t),r=er(n);n.Ia.delete(e),r.O_()&&d_(n,e),n.Ia.size===0&&(r.O_()?r.L_():yn(n)&&n.Va.set("Unknown"))}function Rc(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(U.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}er(t).Z_(e)}function d_(t,e){t.da.$e(e),er(t).X_(e)}function Pc(t){t.da=new aP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),er(t).start(),t.Va.ua()}function kc(t){return yn(t)&&!er(t).x_()&&t.Ia.size>0}function yn(t){return $(t).Ea.size===0}function f_(t){t.da=void 0}async function m0(t){t.Va.set("Online")}async function g0(t){t.Ia.forEach(((e,n)=>{Rc(t,e)}))}async function _0(t,e){f_(t),kc(t)?(t.Va.ha(e),Pc(t)):t.Va.set("Unknown")}async function y0(t,e,n){if(t.Va.set("Online"),e instanceof Kg&&e.state===2&&e.cause)try{await(async function(s,i){const o=i.cause;for(const c of i.targetIds)s.Ia.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.Ia.delete(c),s.da.removeTarget(c))})(t,e)}catch(r){x(fn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await pi(t,r)}else if(e instanceof Fs?t.da.Xe(e):e instanceof Hg?t.da.st(e):t.da.tt(e),!n.isEqual(U.min()))try{const r=await c_(t.localStore);n.compareTo(r)>=0&&await(function(i,o){const c=i.da.Tt(o);return c.targetChanges.forEach(((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const f=i.Ia.get(h);f&&i.Ia.set(h,f.withResumeToken(l.resumeToken,o))}})),c.targetMismatches.forEach(((l,h)=>{const f=i.Ia.get(l);if(!f)return;i.Ia.set(l,f.withResumeToken(Ae.EMPTY_BYTE_STRING,f.snapshotVersion)),d_(i,l);const m=new Vt(f.target,l,h,f.sequenceNumber);Rc(i,m)})),i.remoteSyncer.applyRemoteEvent(c)})(t,n)}catch(r){x(fn,"Failed to raise snapshot:",r),await pi(t,r)}}async function pi(t,e,n){if(!Yn(e))throw e;t.Ea.add(1),await rs(t),t.Va.set("Offline"),n||(n=()=>c_(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{x(fn,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Hi(t)}))}function p_(t,e){return e().catch((n=>pi(t,n,e)))}async function Ki(t){const e=$(t),n=Gt(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:dc;for(;v0(e);)try{const s=await XP(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,E0(e,s)}catch(s){await pi(e,s)}m_(e)&&g_(e)}function v0(t){return yn(t)&&t.Ta.length<10}function E0(t,e){t.Ta.push(e);const n=Gt(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function m_(t){return yn(t)&&!Gt(t).x_()&&t.Ta.length>0}function g_(t){Gt(t).start()}async function w0(t){Gt(t).ra()}async function T0(t){const e=Gt(t);for(const n of t.Ta)e.ea(n.mutations)}async function I0(t,e,n){const r=t.Ta.shift(),s=vc.from(r,e,n);await p_(t,(()=>t.remoteSyncer.applySuccessfulWrite(s))),await Ki(t)}async function A0(t,e){e&&Gt(t).Y_&&await(async function(r,s){if((function(o){return sP(o)&&o!==P.ABORTED})(s.code)){const i=r.Ta.shift();Gt(r).B_(),await p_(r,(()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s))),await Ki(r)}})(t,e),m_(t)&&g_(t)}async function wh(t,e){const n=$(t);n.asyncQueue.verifyOperationInProgress(),x(fn,"RemoteStore received new credentials");const r=yn(n);n.Ea.add(3),await rs(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Hi(n)}async function b0(t,e){const n=$(t);e?(n.Ea.delete(2),await Hi(n)):e||(n.Ea.add(2),await rs(n),n.Va.set("Unknown"))}function er(t){return t.ma||(t.ma=(function(n,r,s){const i=$(n);return i.sa(),new c0(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Zo:m0.bind(null,t),Yo:g0.bind(null,t),t_:_0.bind(null,t),J_:y0.bind(null,t)}),t.Ra.push((async e=>{e?(t.ma.B_(),kc(t)?Pc(t):t.Va.set("Unknown")):(await t.ma.stop(),f_(t))}))),t.ma}function Gt(t){return t.fa||(t.fa=(function(n,r,s){const i=$(n);return i.sa(),new u0(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)})(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:w0.bind(null,t),t_:A0.bind(null,t),ta:T0.bind(null,t),na:I0.bind(null,t)}),t.Ra.push((async e=>{e?(t.fa.B_(),await Ki(t)):(await t.fa.stop(),t.Ta.length>0&&(x(fn,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class Cc{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new mt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,c=new Cc(e,n,o,s,i);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new V(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Nc(t,e){if(vt("AsyncQueue",`${e}: ${t}`),Yn(t))return new V(P.UNAVAILABLE,`${e}: ${t}`);throw t}class Nn{static emptySet(e){return new Nn(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||z.comparator(n.key,r.key):(n,r)=>z.comparator(n.key,r.key),this.keyedMap=Tr(),this.sortedSet=new ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,r)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Nn)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Nn;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}class Th{constructor(){this.ga=new ue(z.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):L(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,r)=>{e.push(r)})),e}}class Zn{constructor(e,n,r,s,i,o,c,l,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach((c=>{o.push({type:0,doc:c})})),new Zn(e,n,Nn.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ji(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}class S0{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class R0{constructor(){this.queries=Ih(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=$(n),i=s.queries;s.queries=Ih(),i.forEach(((o,c)=>{for(const l of c.ba)l.onError(r)}))})(this,new V(P.ABORTED,"Firestore shutting down"))}}function Ih(){return new gn((t=>Mg(t)),ji)}async function P0(t,e){const n=$(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new S0,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const c=Nc(o,`Initialization of query '${An(e.query)}' failed`);return void e.onError(c)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Oc(n)}async function k0(t,e){const n=$(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function C0(t,e){const n=$(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const c of o.ba)c.Fa(s)&&(r=!0);o.wa=s}}r&&Oc(n)}function N0(t,e,n){const r=$(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function Oc(t){t.Ca.forEach((e=>{e.next()}))}var ua,Ah;(Ah=ua||(ua={})).Ma="default",Ah.Cache="cache";class O0{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Zn(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Zn.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ua.Cache}}class __{constructor(e){this.key=e}}class y_{constructor(e){this.key=e}}class D0{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=J(),this.mutatedKeys=J(),this.eu=xg(e),this.tu=new Nn(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new Th,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,c=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((f,m)=>{const _=s.get(f),b=Bi(this.query,m)?m:null,N=!!_&&this.mutatedKeys.has(_.key),O=!!b&&(b.hasLocalMutations||this.mutatedKeys.has(b.key)&&b.hasCommittedMutations);let M=!1;_&&b?_.data.isEqual(b.data)?N!==O&&(r.track({type:3,doc:b}),M=!0):this.su(_,b)||(r.track({type:2,doc:b}),M=!0,(l&&this.eu(b,l)>0||h&&this.eu(b,h)<0)&&(c=!0)):!_&&b?(r.track({type:0,doc:b}),M=!0):_&&!b&&(r.track({type:1,doc:_}),M=!0,(l||h)&&(c=!0)),M&&(b?(o=o.add(b),i=O?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Ss:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort(((f,m)=>(function(b,N){const O=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L(20277,{Vt:M})}};return O(b)-O(N)})(f.type,m.type)||this.eu(f.doc,m.doc))),this.ou(r),s=s??!1;const c=n&&!s?this._u():[],l=this.Ya.size===0&&this.current&&!s?1:0,h=l!==this.Xa;return this.Xa=l,o.length!==0||h?{snapshot:new Zn(this.query,e.tu,i,o,e.mutatedKeys,l===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Th,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Za=this.Za.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Za=this.Za.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=J(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))}));const n=[];return e.forEach((r=>{this.Ya.has(r)||n.push(new y_(r))})),this.Ya.forEach((r=>{e.has(r)||n.push(new __(r))})),n}cu(e){this.Za=e.ks,this.Ya=J();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Zn.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const Dc="SyncEngine";class V0{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class M0{constructor(e){this.key=e,this.hu=!1}}class x0{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new gn((c=>Mg(c)),ji),this.Iu=new Map,this.Eu=new Set,this.Ru=new ue(z.comparator),this.Au=new Map,this.Vu=new Tc,this.du={},this.mu=new Map,this.fu=Bn.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function z0(t,e,n=!0){const r=A_(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await v_(r,e,n,!0),s}async function L0(t,e){const n=A_(t);await v_(n,e,!0,!1)}async function v_(t,e,n,r){const s=await e0(t.localStore,st(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return r&&(c=await F0(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&h_(t.remoteStore,s),c}async function F0(t,e,n,r,s){t.pu=(m,_,b)=>(async function(O,M,W,Q){let G=M.view.ru(W);G.Ss&&(G=await gh(O.localStore,M.query,!1).then((({documents:w})=>M.view.ru(w,G))));const X=Q&&Q.targetChanges.get(M.targetId),ce=Q&&Q.targetMismatches.get(M.targetId)!=null,ve=M.view.applyChanges(G,O.isPrimaryClient,X,ce);return Sh(O,M.targetId,ve.au),ve.snapshot})(t,m,_,b);const i=await gh(t.localStore,e,!0),o=new D0(e,i.ks),c=o.ru(i.documents),l=ns.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),h=o.applyChanges(c,t.isPrimaryClient,l);Sh(t,n,h.au);const f=new V0(e,n,o);return t.Tu.set(e,f),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),h.snapshot}async function $0(t,e,n){const r=$(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter((o=>!ji(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await aa(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Sc(r.remoteStore,s.targetId),la(r,s.targetId)})).catch(Qn)):(la(r,s.targetId),await aa(r.localStore,s.targetId,!0))}async function U0(t,e){const n=$(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Sc(n.remoteStore,r.targetId))}async function j0(t,e,n){const r=K0(t);try{const s=await(function(o,c){const l=$(o),h=te.now(),f=c.reduce(((b,N)=>b.add(N.key)),J());let m,_;return l.persistence.runTransaction("Locally write mutations","readwrite",(b=>{let N=Et(),O=J();return l.xs.getEntries(b,f).next((M=>{N=M,N.forEach(((W,Q)=>{Q.isValidDocument()||(O=O.add(W))}))})).next((()=>l.localDocuments.getOverlayedDocuments(b,N))).next((M=>{m=M;const W=[];for(const Q of c){const G=YR(Q,m.get(Q.key).overlayedDocument);G!=null&&W.push(new _n(Q.key,G,bg(G.value.mapValue),Ke.exists(!0)))}return l.mutationQueue.addMutationBatch(b,h,W,c)})).next((M=>{_=M;const W=M.applyToLocalDocumentSet(m,O);return l.documentOverlayCache.saveOverlays(b,M.batchId,W)}))})).then((()=>({batchId:_.batchId,changes:Lg(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(o,c,l){let h=o.du[o.currentUser.toKey()];h||(h=new ue(K)),h=h.insert(c,l),o.du[o.currentUser.toKey()]=h})(r,s.batchId,n),await ss(r,s.changes),await Ki(r.remoteStore)}catch(s){const i=Nc(s,"Failed to persist write");n.reject(i)}}async function E_(t,e){const n=$(t);try{const r=await QP(n.localStore,e);e.targetChanges.forEach(((s,i)=>{const o=n.Au.get(i);o&&(ee(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?ee(o.hu,14607):s.removedDocuments.size>0&&(ee(o.hu,42227),o.hu=!1))})),await ss(n,r,e)}catch(r){await Qn(r)}}function bh(t,e,n){const r=$(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach(((i,o)=>{const c=o.view.va(e);c.snapshot&&s.push(c.snapshot)})),(function(o,c){const l=$(o);l.onlineState=c;let h=!1;l.queries.forEach(((f,m)=>{for(const _ of m.ba)_.va(c)&&(h=!0)})),h&&Oc(l)})(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function B0(t,e,n){const r=$(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ue(z.comparator);o=o.insert(i,Pe.newNoDocument(i,U.min()));const c=J().add(i),l=new Gi(U.min(),new Map,new ue(K),o,c);await E_(r,l),r.Ru=r.Ru.remove(i),r.Au.delete(e),Vc(r)}else await aa(r.localStore,e,!1).then((()=>la(r,e,n))).catch(Qn)}async function Z0(t,e){const n=$(t),r=e.batch.batchId;try{const s=await JP(n.localStore,e);T_(n,r,null),w_(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ss(n,s)}catch(s){await Qn(s)}}async function q0(t,e,n){const r=$(t);try{const s=await(function(o,c){const l=$(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return l.mutationQueue.lookupMutationBatch(h,c).next((m=>(ee(m!==null,37113),f=m.keys(),l.mutationQueue.removeMutationBatch(h,m)))).next((()=>l.mutationQueue.performConsistencyCheck(h))).next((()=>l.documentOverlayCache.removeOverlaysForBatchId(h,f,c))).next((()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>l.localDocuments.getDocuments(h,f)))}))})(r.localStore,e);T_(r,e,n),w_(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ss(r,s)}catch(s){await Qn(s)}}function w_(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function T_(t,e,n){const r=$(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function la(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach((r=>{t.Vu.containsKey(r)||I_(t,r)}))}function I_(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Sc(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),Vc(t))}function Sh(t,e,n){for(const r of n)r instanceof __?(t.Vu.addReference(r.key,e),G0(t,r)):r instanceof y_?(x(Dc,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||I_(t,r.key)):L(19791,{wu:r})}function G0(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(x(Dc,"New document in limbo: "+n),t.Eu.add(r),Vc(t))}function Vc(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new z(re.fromString(e)),r=t.fu.next();t.Au.set(r,new M0(n)),t.Ru=t.Ru.insert(n,r),h_(t.remoteStore,new Vt(st(Og(n.path)),r,"TargetPurposeLimboResolution",Fi.ce))}}async function ss(t,e,n){const r=$(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,l)=>{o.push(r.pu(l,e,n).then((h=>{if((h||n)&&r.isPrimaryClient){const f=h?!h.fromCache:n?.targetChanges.get(l.targetId)?.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(h){s.push(h);const f=Ac.Es(l.targetId,h);i.push(f)}})))})),await Promise.all(o),r.Pu.J_(s),await(async function(l,h){const f=$(l);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>k.forEach(h,(_=>k.forEach(_.Ts,(b=>f.persistence.referenceDelegate.addReference(m,_.targetId,b))).next((()=>k.forEach(_.Is,(b=>f.persistence.referenceDelegate.removeReference(m,_.targetId,b)))))))))}catch(m){if(!Yn(m))throw m;x(bc,"Failed to update sequence numbers: "+m)}for(const m of h){const _=m.targetId;if(!m.fromCache){const b=f.vs.get(_),N=b.snapshotVersion,O=b.withLastLimboFreeSnapshotVersion(N);f.vs=f.vs.insert(_,O)}}})(r.localStore,i))}async function W0(t,e){const n=$(t);if(!n.currentUser.isEqual(e)){x(Dc,"User change. New user:",e.toKey());const r=await a_(n.localStore,e);n.currentUser=e,(function(i,o){i.mu.forEach((c=>{c.forEach((l=>{l.reject(new V(P.CANCELLED,o))}))})),i.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ss(n,r.Ns)}}function H0(t,e){const n=$(t),r=n.Au.get(e);if(r&&r.hu)return J().add(r.key);{let s=J();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const c=n.Tu.get(o);s=s.unionWith(c.view.nu)}return s}}function A_(t){const e=$(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=E_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=H0.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=B0.bind(null,e),e.Pu.J_=C0.bind(null,e.eventManager),e.Pu.yu=N0.bind(null,e.eventManager),e}function K0(t){const e=$(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z0.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=q0.bind(null,e),e}class mi{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Wi(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return KP(this.persistence,new GP,e.initialUser,this.serializer)}Cu(e){return new o_(Ic.Vi,this.serializer)}Du(e){return new n0}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}mi.provider={build:()=>new mi};class J0 extends mi{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ee(this.persistence.referenceDelegate instanceof fi,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new NP(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Ve.withCacheSize(this.cacheSizeBytes):Ve.DEFAULT;return new o_((r=>fi.Vi(r,n)),this.serializer)}}class ha{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>bh(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=W0.bind(null,this.syncEngine),await b0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new R0})()}createDatastore(e){const n=Wi(e.databaseInfo.databaseId),r=a0(e.databaseInfo);return d0(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return(function(r,s,i,o,c){return new p0(r,s,i,o,c)})(this.localStore,this.datastore,e.asyncQueue,(n=>bh(this.syncEngine,n,0)),(function(){return vh.v()?new vh:new r0})())}createSyncEngine(e,n){return(function(s,i,o,c,l,h,f){const m=new x0(s,i,o,c,l,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const r=$(n);x(fn,"RemoteStore shutting down."),r.Ea.add(5),await rs(r),r.Aa.shutdown(),r.Va.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}ha.provider={build:()=>new ha};class Q0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):vt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const Wt="FirestoreClient";class Y0{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=Re.UNAUTHENTICATED,this.clientId=hc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,(async o=>{x(Wt,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(x(Wt,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new mt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Nc(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Vo(t,e){t.asyncQueue.verifyOperationInProgress(),x(Wt,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener((async s=>{r.isEqual(s)||(await a_(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function Rh(t,e){t.asyncQueue.verifyOperationInProgress();const n=await X0(t);x(Wt,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((r=>wh(e.remoteStore,r))),t.setAppCheckTokenChangeListener(((r,s)=>wh(e.remoteStore,s))),t._onlineComponents=e}async function X0(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){x(Wt,"Using user provided OfflineComponentProvider");try{await Vo(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(s){return s.name==="FirebaseError"?s.code===P.FAILED_PRECONDITION||s.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(n))throw n;dn("Error using user provided cache. Falling back to memory cache: "+n),await Vo(t,new mi)}}else x(Wt,"Using default OfflineComponentProvider"),await Vo(t,new J0(void 0));return t._offlineComponents}async function Mc(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(x(Wt,"Using user provided OnlineComponentProvider"),await Rh(t,t._uninitializedComponentsProvider._online)):(x(Wt,"Using default OnlineComponentProvider"),await Rh(t,new ha))),t._onlineComponents}function ek(t){return Mc(t).then((e=>e.syncEngine))}function tk(t){return Mc(t).then((e=>e.datastore))}async function nk(t){const e=await Mc(t),n=e.eventManager;return n.onListen=z0.bind(null,e.syncEngine),n.onUnlisten=$0.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=L0.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=U0.bind(null,e.syncEngine),n}function rk(t,e,n={}){const r=new mt;return t.asyncQueue.enqueueAndForget((async()=>(function(i,o,c,l,h){const f=new Q0({next:_=>{f.Nu(),o.enqueueAndForget((()=>k0(i,m))),_.fromCache&&l.source==="server"?h.reject(new V(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new O0(c,f,{includeMetadataChanges:!0,Ka:!0});return P0(i,m)})(await nk(t),t.asyncQueue,e,n,r))),r.promise}function sk(t,e,n){const r=new mt;return t.asyncQueue.enqueueAndForget((async()=>{try{const s=await tk(t);r.resolve((async function(o,c,l){const h=$(o),{request:f,gt:m,parent:_}=yP(h.serializer,xR(c),l);h.connection.Ko||delete f.parent;const b=(await h.jo("RunAggregationQuery",h.serializer.databaseId,_,f,1)).filter((O=>!!O.result));ee(b.length===1,64727);const N=b[0].result?.aggregateFields;return Object.keys(N).reduce(((O,M)=>(O[m[M]]=N[M],O)),{})})(s,e,n))}catch(s){r.reject(s)}})),r.promise}function ik(t,e){const n=new mt;return t.asyncQueue.enqueueAndForget((async()=>j0(await ek(t),e,n))),n.promise}function b_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const ok="ComponentProvider",Ph=new Map;function ak(t,e,n,r,s){return new vR(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,b_(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}const S_="firestore.googleapis.com",kh=!0;class Ch{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new V(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=S_,this.ssl=kh}else this.host=e.host,this.ssl=e.ssl??kh;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=i_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<kP)throw new V(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=b_(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new V(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ji{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ch({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new V(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new V(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ch(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new QS;switch(r.type){case"firstParty":return new tR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new V(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const r=Ph.get(n);r&&(x(ok,"Removing Datastore"),Ph.delete(n),r.terminate())})(this),Promise.resolve()}}function R_(t,e,n,r={}){t=Ut(t,Ji);const s=Wn(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;s&&(Em(`https://${c}`),wm("Firestore",!0)),i.host!==S_&&i.host!==c&&dn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:s,emulatorOptions:r};if(!cn(l,o)&&(t._setSettings(l),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=Re.MOCK_USER;else{h=bI(r.mockUserToken,t._app?.options.projectId);const m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new V(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new Re(m)}t._authCredentials=new YS(new fg(h,f))}}class vn{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new vn(this.firestore,e,this._query)}}class _e{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $t(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _e(this.firestore,e,this._key)}toJSON(){return{type:_e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(es(n,_e._jsonSchema))return new _e(e,r||null,new z(re.fromString(n.referencePath)))}}_e._jsonSchemaVersion="firestore/documentReference/1.0",_e._jsonSchema={type:me("string",_e._jsonSchemaVersion),referencePath:me("string")};class $t extends vn{constructor(e,n,r){super(e,n,Og(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _e(this.firestore,null,new z(e))}withConverter(e){return new $t(this.firestore,e,this._path)}}function MC(t,e,...n){if(t=Me(t),pg("collection","path",e),t instanceof Ji){const r=re.fromString(e,...n);return Bl(r),new $t(t,null,r)}{if(!(t instanceof _e||t instanceof $t))throw new V(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(re.fromString(e,...n));return Bl(r),new $t(t.firestore,null,r)}}function ck(t,e,...n){if(t=Me(t),arguments.length===1&&(e=hc.newId()),pg("doc","path",e),t instanceof Ji){const r=re.fromString(e,...n);return jl(r),new _e(t,null,new z(r))}{if(!(t instanceof _e||t instanceof $t))throw new V(P.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(re.fromString(e,...n));return jl(r),new _e(t.firestore,t instanceof $t?t.converter:null,new z(r))}}const Nh="AsyncQueue";class Oh{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new u_(this,"async_queue_retry"),this._c=()=>{const r=Do();r&&x(Nh,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Do();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Do();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new mt;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Yn(e))throw e;x(Nh,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,vt("INTERNAL UNHANDLED ERROR: ",Dh(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Cc.createAndSchedule(this,e,n,r,(i=>this.hc(i)));return this.tc.push(s),s}uc(){this.nc&&L(47125,{Pc:Dh(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,r)=>n.targetTimeMs-r.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Dh(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class tr extends Ji{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Oh,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Oh(e),this._firestoreClient=void 0,await e}}}function uk(t,e){const n=typeof t=="object"?t:bm(),r=typeof t=="string"?t:e||ci,s=Xa(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=II("firestore");i&&R_(s,...i)}return s}function xc(t){if(t._terminated)throw new V(P.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||lk(t),t._firestoreClient}function lk(t){const e=t._freezeSettings(),n=ak(t._databaseId,t._app?.options.appId||"",t._persistenceKey,t._app?.options.apiKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Y0(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(s){const i=s?._online.build();return{_offline:s?._offline.build(i),_online:i}})(t._componentsProvider))}class Fe{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fe(Ae.fromBase64String(e))}catch(n){throw new V(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Fe(Ae.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fe._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(es(e,Fe._jsonSchema))return Fe.fromBase64String(e.bytes)}}Fe._jsonSchemaVersion="firestore/bytes/1.0",Fe._jsonSchema={type:me("string",Fe._jsonSchemaVersion),bytes:me("string")};class P_{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new V(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ie(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zc{constructor(e){this._methodName=e}}class ot{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new V(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new V(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ot._jsonSchemaVersion}}static fromJSON(e){if(es(e,ot._jsonSchema))return new ot(e.latitude,e.longitude)}}ot._jsonSchemaVersion="firestore/geoPoint/1.0",ot._jsonSchema={type:me("string",ot._jsonSchemaVersion),latitude:me("number"),longitude:me("number")};class Je{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Je._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(es(e,Je._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new Je(e.vectorValues);throw new V(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Je._jsonSchemaVersion="firestore/vectorValue/1.0",Je._jsonSchema={type:me("string",Je._jsonSchemaVersion),vectorValues:me("object")};const hk=/^__.*__$/;class dk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new _n(e,this.data,this.fieldMask,n,this.fieldTransforms):new ts(e,this.data,n,this.fieldTransforms)}}function k_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L(40011,{dataSource:t})}}class Lc{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Lc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){const n=this.path?.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){const n=this.path?.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return gi(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(k_(this.dataSource)&&hk.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class fk{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Wi(e)}createContext(e,n,r,s=!1){return new Lc({dataSource:e,methodName:n,targetDoc:r,path:Ie.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fc(t){const e=t._freezeSettings(),n=Wi(t._databaseId);return new fk(t._databaseId,!!e.ignoreUndefinedProperties,n)}function C_(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);D_("Data must be an object, but it was:",o,r);const c=N_(r,o);let l,h;if(i.merge)l=new We(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const _=nr(e,m,n);if(!o.contains(_))throw new V(P.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);_k(f,_)||f.push(_)}l=new We(f),h=o.fieldTransforms.filter((m=>l.covers(m.field)))}else l=null,h=o.fieldTransforms;return new dk(new ze(c),l,h)}class $c extends zc{_toFieldTransform(e){return new HR(e.path,new Ur)}isEqual(e){return e instanceof $c}}function pk(t,e,n,r=!1){return Uc(n,t.createContext(r?4:3,e))}function Uc(t,e){if(O_(t=Me(t)))return D_("Unsupported field value:",e,t),N_(t,e);if(t instanceof zc)return(function(r,s){if(!k_(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(r,s){const i=[];let o=0;for(const c of r){let l=Uc(c,s.childContextForArray(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}})(t,e)}return(function(r,s){if((r=Me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=te.fromDate(r);return{timestampValue:di(s.serializer,i)}}if(r instanceof te){const i=new te(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:di(s.serializer,i)}}if(r instanceof ot)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fe)return{bytesValue:Jg(s.serializer,r._byteString)};if(r instanceof _e){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:wc(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Je)return(function(o,c){const l=o instanceof Je?o.toArray():o;return{mapValue:{fields:{[Ig]:{stringValue:Ag},[ui]:{arrayValue:{values:l.map((f=>{if(typeof f!="number")throw c.createError("VectorValues must only contain numeric values.");return _c(c.serializer,f)}))}}}}}})(r,s);if(s_(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${Li(r)}`)})(t,e)}function N_(t,e){const n={};return _g(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):mn(t,((r,s)=>{const i=Uc(s,e.childContextForField(r));i!=null&&(n[r]=i)})),{mapValue:{fields:n}}}function O_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof te||t instanceof ot||t instanceof Fe||t instanceof _e||t instanceof zc||t instanceof Je||s_(t))}function D_(t,e,n){if(!O_(n)||!mg(n)){const r=Li(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function nr(t,e,n){if((e=Me(e))instanceof P_)return e._internalPath;if(typeof e=="string")return gk(t,e);throw gi("Field path arguments must be of type string or ",t,!1,void 0,n)}const mk=new RegExp("[~\\*/\\[\\]]");function gk(t,e,n){if(e.search(mk)>=0)throw gi(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new P_(...e.split("."))._internalPath}catch{throw gi(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function gi(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new V(P.INVALID_ARGUMENT,c+t+l)}function _k(t,e){return t.some((n=>n.isEqual(e)))}class yk{convertValue(e,n="none"){switch(qt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return de(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Zt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw L(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return mn(e,((s,i)=>{r[s]=this.convertValue(i,n)})),r}convertVectorValue(e){const n=e.fields?.[ui].arrayValue?.values?.map((r=>de(r.doubleValue)));return new Je(n)}convertGeoPoint(e){return new ot(de(e.latitude),de(e.longitude))}convertArray(e,n){return(e.values||[]).map((r=>this.convertValue(r,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ui(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zr(e));default:return null}}convertTimestamp(e){const n=Bt(e);return new te(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=re.fromString(e);ee(r_(r),9688,{name:e});const s=new Lr(r.get(1),r.get(3)),i=new z(r.popFirst(5));return s.isEqual(n)||vt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}class V_ extends yk{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fe(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _e(this.firestore,null,n)}}function xC(){return new $c("serverTimestamp")}const Vh="@firebase/firestore",Mh="4.11.0";class vk{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class Ek{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new ze({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}class M_{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new _e(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){const n=this._document.data.field(nr("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class wk extends M_{data(){return super.data()}}function Tk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new V(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jc{}class x_ extends jc{}function zC(t,e,...n){let r=[];e instanceof jc&&r.push(e),r=r.concat(n),(function(i){const o=i.filter((l=>l instanceof Bc)).length,c=i.filter((l=>l instanceof Qi)).length;if(o>1||o>0&&c>0)throw new V(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)t=s._apply(t);return t}class Qi extends x_{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Qi(e,n,r)}_apply(e){const n=this._parse(e);return z_(e._query,n),new vn(e.firestore,e.converter,ta(e._query,n))}_parse(e){const n=Fc(e.firestore);return(function(i,o,c,l,h,f,m){let _;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new V(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){zh(m,f);const N=[];for(const O of m)N.push(xh(l,i,O));_={arrayValue:{values:N}}}else _=xh(l,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||zh(m,f),_=pk(c,o,m,f==="in"||f==="not-in");return pe.create(h,f,_)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function LC(t,e,n){const r=e,s=nr("where",t);return Qi._create(s,r,n)}class Bc extends jc{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Bc(e,n)}_parse(e){const n=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return n.length===1?n[0]:Ye.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(s,i){let o=s;const c=i.getFlattenedFilters();for(const l of c)z_(o,l),o=ta(o,l)})(e._query,n),new vn(e.firestore,e.converter,ta(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Zc extends x_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Zc(e,n)}_apply(e){const n=(function(s,i,o){if(s.startAt!==null)throw new V(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new V(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $r(i,o)})(e._query,this._field,this._direction);return new vn(e.firestore,e.converter,zR(e._query,n))}}function FC(t,e="asc"){const n=e,r=nr("orderBy",t);return Zc._create(r,n)}function xh(t,e,n){if(typeof(n=Me(n))=="string"){if(n==="")throw new V(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Dg(e)&&n.indexOf("/")!==-1)throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(re.fromString(n));if(!z.isDocumentKey(r))throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ql(t,new z(r))}if(n instanceof _e)return Ql(t,n._key);throw new V(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Li(n)}.`)}function zh(t,e){if(!Array.isArray(t)||t.length===0)throw new V(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function z_(t,e){const n=(function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null})(t.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new V(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new V(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function L_(t,e,n){let r;return r=t?t.toFirestore(e):e,r}function $C(t){return new vk("sum",nr("sum",t))}function UC(t,e){const n=Ut(t.firestore,tr),r=xc(n),s=_R(e,((i,o)=>new nP(o,i.aggregateType,i._internalFieldPath)));return sk(r,t._query,s).then((i=>(function(c,l,h){const f=new V_(c);return new Ek(l,f,h)})(n,t,i)))}class Cs{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class On extends M_{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $s(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(nr("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new V(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=On._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}On._jsonSchemaVersion="firestore/documentSnapshot/1.0",On._jsonSchema={type:me("string",On._jsonSchemaVersion),bundleSource:me("string","DocumentSnapshot"),bundleName:me("string"),bundle:me("string")};class $s extends On{data(e={}){return super.data(e)}}class Dn{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Cs(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((r=>{e.call(n,new $s(this._firestore,this._userDataWriter,r.key,r,new Cs(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new V(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((c=>{const l=new $s(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Cs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((c=>i||c.type!==3)).map((c=>{const l=new $s(s._firestore,s._userDataWriter,c.doc.key,c.doc,new Cs(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:Ik(c.type),doc:l,oldIndex:h,newIndex:f}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new V(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Dn._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach((i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ik(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L(61501,{type:t})}}Dn._jsonSchemaVersion="firestore/querySnapshot/1.0",Dn._jsonSchema={type:me("string",Dn._jsonSchemaVersion),bundleSource:me("string","QuerySnapshot"),bundleName:me("string"),bundle:me("string")};function jC(t){t=Ut(t,vn);const e=Ut(t.firestore,tr),n=xc(e),r=new V_(e);return Tk(t._query),rk(n,t._query).then((s=>new Dn(e,r,t,s)))}function BC(t,e,n){t=Ut(t,_e);const r=Ut(t.firestore,tr),s=L_(t.converter,e),i=Fc(r);return qc(r,[C_(i,"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ke.none())])}function ZC(t){return qc(Ut(t.firestore,tr),[new yc(t._key,Ke.none())])}function qC(t,e){const n=Ut(t.firestore,tr),r=ck(t),s=L_(t.converter,e),i=Fc(t.firestore);return qc(n,[C_(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ke.exists(!1))]).then((()=>r))}function qc(t,e){const n=xc(t);return ik(n,e)}(function(e,n=!0){JS(Hn),Ln(new un("firestore",((r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),c=new tr(new XS(r.getProvider("auth-internal")),new nR(o,r.getProvider("app-check-internal")),ER(o,s),o);return i={useFetchStreams:n,...i},c._setSettings(i),c}),"PUBLIC").setMultipleInstances(!0)),Lt(Vh,Mh,e),Lt(Vh,Mh,"esm2020")})();function Ak(t,e=Be.MODE){const n=Am(t),r=HS(n),s=uk(n,Be.FIRESTORE_DATABASE_ID);return(e==="development"||e==="test")&&bk(r,s),{app:n,firestore:s,auth:r}}function bk(t,e){Zm(t,Be.FIREBASE_AUTH_DOMAIN,{disableWarnings:!0});const[n,r]=Be.FIRESTORE_EMULATOR_HOST.split(":");R_(e,n,Number.parseInt(r,10))}function Sk({children:t,config:e=pI}){const{firestore:n}=Ak(e);return _y.jsx(fm.Provider,{value:n,children:t})}Sk.__docgenInfo={description:"",methods:[],displayName:"FirestoreProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""},config:{required:!1,tsType:{name:"FirebaseOptions"},description:"",defaultValue:{value:`{
  apiKey: env.FIREBASE_API_KEY,
  authDomain: env.FIREBASE_AUTH_DOMAIN,
  projectId: env.FIREBASE_PROJECT_ID,
  storageBucket: env.FIREBASE_STORAGE_BUCKET,
  messagingSenderId: env.FIREBASE_MESSAGING_SENDER_ID,
  appId: env.FIREBASE_APP_ID,
  measurementId: env.FIREBASE_MEASUREMENT_ID,
}`,computed:!1}}}};function GC(){const t=Lh.useContext(fm);if(!t)throw new Error("useFirestore must be used within a FirestoreProvider");return t}const Rk={path:()=>"users",converter:{toFirestore:t=>({id:t.id,name:t.name,email:t.email}),fromFirestore:t=>{const e=t.data();return{id:t.id,name:e.name,email:e.email}}}},Pk={path:t=>`users/${t}/payments`,converter:{toFirestore:t=>({category_id:t.categoryId??"",note:t.note,amount:t.amount,date:te.fromDate(t.date),user_id:t.userId,created_date:t.createdDate,updated_date:t.updatedDate}),fromFirestore:t=>{const e=t.data();return{id:t.id,categoryId:e.category_id,note:e.note,amount:e.amount,date:e.date.toDate(),userId:e.user_id,createdDate:e.created_date,updatedDate:e.updated_date}}}},kk={path:()=>"categories",converter:{toFirestore:t=>({id:t.id,name:t.name,created_date:te.fromDate(t.createdDate),updated_date:te.fromDate(t.updatedDate)}),fromFirestore:t=>{const e=t.data();return{id:t.id,name:e.name,createdDate:e.created_date.toDate(),updatedDate:e.updated_date.toDate()}}}},WC={users:Rk,payments:Pk,categories:kk};export{fE as $,eE as A,Uv as B,jv as C,zE as D,le as E,Sk as F,Ct as G,_v as H,kv as I,Hd as J,Rv as K,Iv as L,Wd as M,bv as N,wv as O,yv as P,Nv as Q,Tv as R,vv as S,mv as T,gv as U,Ov as V,Cv as W,Av as X,Ev as Y,Pv as Z,bi as _,NC as a,gE as a$,Sv as a0,rf as a1,qE as a2,aE as a3,_E as a4,DE as a5,TE as a6,sE as a7,zv as a8,Fv as a9,Jd as aA,cE as aB,vE as aC,EE as aD,nf as aE,FE as aF,VE as aG,BE as aH,$E as aI,Ue as aJ,AE as aK,GE as aL,SE as aM,Si as aN,ie as aO,xE as aP,lE as aQ,UE as aR,CE as aS,tf as aT,j as aU,Bv as aV,Lv as aW,xv as aX,hE as aY,_a as aZ,pE as a_,da as aa,RE as ab,rd as ac,NE as ad,kE as ae,jE as af,Mv as ag,Jv as ah,Qv as ai,Wv as aj,Gv as ak,Kv as al,Hv as am,IE as an,oE as ao,qv as ap,ZE as aq,PE as ar,Yv as as,bE as at,LE as au,$v as av,mE as aw,ME as ax,dE as ay,OE as az,DC as b,Mt as b$,Zv as b0,wE as b1,Ok as b2,I as b3,qk as b4,Zk as b5,Dv as b6,Nk as b7,Wk as b8,fw as b9,od as bA,Aw as bB,hC as bC,Ow as bD,nw as bE,rw as bF,Nr as bG,nt as bH,Lo as bI,Tw as bJ,tw as bK,sw as bL,cw as bM,oC as bN,_f as bO,yf as bP,QE as bQ,JE as bR,XE as bS,YE as bT,Af as bU,gf as bV,AC as bW,Rf as bX,fC as bY,Ew as bZ,Cr as b_,Nw as ba,wf as bb,Tf as bc,aw as bd,ow as be,EC as bf,xw as bg,vf as bh,Ef as bi,Jk as bj,Kk as bk,Qk as bl,Hk as bm,Gk as bn,df as bo,ff as bp,Dw as bq,_w as br,id as bs,ad as bt,_C as bu,iC as bv,If as bw,sf as bx,lf as by,sd as bz,WC as c,af as c$,KE as c0,uC as c1,Sf as c2,va as c3,bw as c4,Zs as c5,Or as c6,Fo as c7,yw as c8,hf as c9,Ii as cA,Ai as cB,lC as cC,bf as cD,Cw as cE,Iw as cF,HE as cG,Ri as cH,Fw as cI,vC as cJ,Mw as cK,lw as cL,IC as cM,Pw as cN,kw as cO,pC as cP,Rw as cQ,aC as cR,iw as cS,uw as cT,pf as cU,hw as cV,rC as cW,pw as cX,ww as cY,ya as cZ,of as c_,dC as ca,Xk as cb,mw as cc,tC as cd,yC as ce,eC as cf,Sw as cg,dw as ch,gC as ci,ew as cj,mC as ck,qn as cl,wi as cm,Ti as cn,wC as co,Yk as cp,bC as cq,nC as cr,TC as cs,cC as ct,Vw as cu,vw as cv,ud as cw,hd as cx,cd as cy,ld as cz,ck as d,ba as d$,cf as d0,uf as d1,gw as d2,mf as d3,sC as d4,lt as d5,Qe as d6,Hs as d7,$w as d8,zk as d9,Vk as dA,Dk as dB,Vv as dC,kC as dD,RC as dE,Ia as dF,$a as dG,Ua as dH,ja as dI,Np as dJ,Rp as dK,Op as dL,xa as dM,za as dN,Ba as dO,Va as dP,Ma as dQ,Ra as dR,Pa as dS,tm as dT,Ja as dU,Vi as dV,Wr as dW,Kp as dX,Mp as dY,La as dZ,Aa as d_,Fk as da,zw as db,xk as dc,Lk as dd,Fy as de,$y as df,Mo as dg,ht as dh,Kd as di,nE as dj,iE as dk,Lw as dl,Hu as dm,Ku as dn,Mk as dp,pv as dq,WE as dr,Uk as ds,Bk as dt,$k as du,jk as dv,jy as dw,By as dx,Uy as dy,SC as dz,Ub as e,vT as e$,Dr as e0,PC as e1,Gp as e2,Zp as e3,lm as e4,Ks as e5,Oa as e6,Da as e7,fp as e8,hp as e9,em as eA,Ip as eB,om as eC,qp as eD,Lp as eE,B as eF,ka as eG,Pi as eH,dt as eI,Ap as eJ,Ni as eK,Pp as eL,Cp as eM,Ca as eN,Vp as eO,Ta as eP,Jp as eQ,ll as eR,zT as eS,ki as eT,ET as eU,wT as eV,OT as eW,Tp as eX,nm as eY,sI as eZ,yT as e_,_p as ea,mp as eb,xp as ec,Fa as ed,Na as ee,am as ef,Bp as eg,Ep as eh,Up as ei,rm as ej,Sa as ek,kp as el,Ha as em,bp as en,Hp as eo,Gn as ep,Ci as eq,Wa as er,Ka as es,Qp as et,um as eu,sm as ev,je as ew,Oi as ex,jp as ey,oe as ez,Bh as f,Qw as f$,tI as f0,lT as f1,hT as f2,iI as f3,FT as f4,Ww as f5,Kw as f6,oI as f7,ZT as f8,TT as f9,JT as fA,jT as fB,GT as fC,gT as fD,WT as fE,aI as fF,eI as fG,uT as fH,KT as fI,Za as fJ,Xp as fK,Sp as fL,Qs as fM,YT as fN,wp as fO,Dp as fP,Js as fQ,jw as fR,Bw as fS,qT as fT,Ys as fU,Yp as fV,hI as fW,rI as fX,im as fY,$p as fZ,hm as f_,eT as fa,cT as fb,Gw as fc,Hw as fd,Di as fe,Wp as ff,QT as fg,PT as fh,kT as fi,tT as fj,RT as fk,ST as fl,bT as fm,aT as fn,cI as fo,$o as fp,CT as fq,DT as fr,zp as fs,mT as ft,_T as fu,lI as fv,IT as fw,$T as fx,pT as fy,cm as fz,HS as g,Xw as g0,Jw as g1,Yw as g2,Zw as g3,qw as g4,HT as g5,UT as g6,Le as g7,AT as g8,uI as g9,jC as gA,zC as gB,FC as gC,UC as gD,$C as gE,Be as gF,CC as gG,XT as ga,dm as gb,MT as gc,nI as gd,Ga as ge,Fp as gf,NT as gg,VT as gh,dT as gi,xT as gj,qa as gk,zn as gl,oT as gm,nT as gn,rT as go,sT as gp,iT as gq,LT as gr,fT as gs,BT as gt,qC as gu,MC as gv,xC as gw,pI as gx,ZC as gy,LC as gz,qs as h,Ak as i,Iy as j,se as k,Gs as l,Ws as m,ul as n,OC as o,Oy as p,yE as q,Sn as r,BC as s,tE as t,GC as u,rE as v,Yd as w,uE as x,Qd as y,Xv as z};
