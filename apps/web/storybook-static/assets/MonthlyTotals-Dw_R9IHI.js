import{r as a,j as e,p as l}from"./iframe-dHABiMeZ.js";import{m as d}from"./react-error-boundary-C3Blex15.js";import{t as h}from"./toCurrency-B1XOnn-n.js";import{u as g}from"./useQuery-Dir4VHnT.js";import{gv as x,c,gB as f,gz as i,gD as y,gE as j,u as T}from"./store-BDQXzfpO.js";import{u as M}from"./useAuthCurrentUser-BTHXZyFx.js";import{u as E}from"./useDateRange-BNCrmCFV.js";import{p as u}from"./text-CUfpPkrv.js";import{r as q}from"./skeleton-CXonK7rb.js";async function w(t,o,[r,n]){if(!o||!r||!n)return null;const s=x(t,c.payments.path(o.uid)).withConverter(c.payments.converter),p=f(s,i("user_id","==",o.uid),i("date",">=",r),i("date","<=",n));return(await y(p,{totalPopulation:j("amount")})).data().totalPopulation}function S(){const{currentUser:t}=M(),o=T(),{date:r,dateRange:n}=E(),s=g({queryKey:["totalExpenditures",t?.uid,r?.toISOString()??"all"],queryFn:()=>w(o,t,n),staleTime:3e3});return{data:s.data??null,loading:s.isLoading,error:s.error,promise:s.promise}}function m(){const{promise:t}=S();return e.jsxs(l,{gap:"1",direction:"column",children:[e.jsx(u,{size:"3",color:"gray",children:"Total spending"}),e.jsx(l,{justify:"end",align:"center",children:e.jsx(d,{fallback:e.jsx(u,{color:"red",children:"An unexpected error has occurred."}),children:e.jsx(a.Suspense,{fallback:e.jsx(q,{width:"120px",height:"28px"}),children:e.jsx(b,{getValue:t})})})})]})}const b=a.memo(function({getValue:o}){const r=a.use(o),n=r===null?"-":h(r);return e.jsx(u,{align:"right",size:"6",weight:"bold",children:n})}),U=a.memo(m);m.__docgenInfo={description:"",methods:[],displayName:"MonthlyTotals"};export{U as M};
